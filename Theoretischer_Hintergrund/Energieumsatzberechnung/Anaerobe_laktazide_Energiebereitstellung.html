<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Anaerobe- laktazide Energiekomponente (WBLC) – Wirkungsgrad auf dem Radergometer im Sitzen und Stehen</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../Theoretischer_Hintergrund/Energieumsatzberechnung/Anaerobe_alaktazide_Energiebereitstellung.html" rel="next">
<link href="../../Theoretischer_Hintergrund/Energieumsatzberechnung/Aerobe_Energiebereitstellung.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-d166b450ba5a8e9f7a0ab969bf6592c1.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-203cb2a5c35e5c5009fb1e53f0887423.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-7c126face602f4b12fa45de52a007bdc.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<meta name="shinylive:serviceworker_dir" content="../..">
<script src="../../site_libs/quarto-contrib/shinylive-0.9.1/shinylive/load-shinylive-sw.js" type="module"></script>
<script src="../../site_libs/quarto-contrib/shinylive-0.9.1/shinylive/run-python-blocks.js" type="module"></script>
<link href="../../site_libs/quarto-contrib/shinylive-0.9.1/shinylive/shinylive.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/shinylive-quarto-css/shinylive-quarto.css" rel="stylesheet">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../Theoretischer_Hintergrund/index_Theoretischer_Hintergrund.html">Theoretischer Hintergrund</a></li><li class="breadcrumb-item"><a href="../../Theoretischer_Hintergrund/Energieumsatzberechnung/index_Energieumsatzberechnung.html">Energieumsatzberechnung</a></li><li class="breadcrumb-item"><a href="../../Theoretischer_Hintergrund/Energieumsatzberechnung/Anaerobe_laktazide_Energiebereitstellung.html">Anaerobe- laktazide Energiekomponente (W<sub>BLC</sub>)</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Suchen" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="../../index.html" class="sidebar-logo-link">
      <img src="../../images/Logo_η_3.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Dunkelmodus umschalten"><i class="bi"></i></a>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Suchen"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../Theoretischer_Hintergrund/index_Theoretischer_Hintergrund.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Theoretischer Hintergrund</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Theoretischer_Hintergrund/Wirkungsgrad_Theorie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Wirkungsgrad</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../Theoretischer_Hintergrund/Energieumsatzberechnung/index_Energieumsatzberechnung.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Energieumsatzberechnung</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Theoretischer_Hintergrund/Energieumsatzberechnung/Aerobe_Energiebereitstellung.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aerobe Energiekomponente (W<sub>Aerob</sub>)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Theoretischer_Hintergrund/Energieumsatzberechnung/Anaerobe_laktazide_Energiebereitstellung.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Anaerobe- laktazide Energiekomponente (W<sub>BLC</sub>)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Theoretischer_Hintergrund/Energieumsatzberechnung/Anaerobe_alaktazide_Energiebereitstellung.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Anaerobe- alaktazide Energiekomponente (W<sub>PCr</sub>)</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Theoretischer_Hintergrund/Mechanische_Arbeit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mechanische Arbeit</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Theoretischer_Hintergrund/Innere_Arbeit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Innere Arbeit</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Theoretischer_Hintergrund/Sitzen_Stehen.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Radfahren im Sitzen und Stehen</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Forschungsfragen_Hypothesen.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Forschungsfragen &amp; Hypothesen</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../Methodik/index_Methodik.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Methodik</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Methodik/Stichprobe.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Stichprobe</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Methodik/Messmethoden.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Messmethoden</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Methodik/Studiendesign.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Studiendesign</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Methodik/Statistische_Analyseverfahren.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistische Anaylseverfahren</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../Ergebnisse/index_Ergebnisse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ergebnisse &amp; Statistik</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Ergebnisse/Drehzahl_Stufentests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Eingangsuntersuchungen</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Ergebnisse/VO2_Daten.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Physiologische Belastungsparameter</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Ergebnisse/EPOC_Daten.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Physiologische Nachbelastungsparameter</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Ergebnisse/Ergometer_Daten.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ergometrische Leistungsparameter</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Ergebnisse/Wirkungsgrad_Statistik.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Wirkungsgrad- und Stoffwechselparameter</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Abkuerzungsverzeichnis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Abkürzungsverzeichnis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Quellen.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quellenverzeichnis</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="3">
    <h2 id="toc-title">Inhalt auf dieser Seite</h2>
   
  <ul>
  <li><a href="#kinetik-der-blutlaktatkonzentration" id="toc-kinetik-der-blutlaktatkonzentration" class="nav-link active" data-scroll-target="#kinetik-der-blutlaktatkonzentration">Kinetik der Blutlaktatkonzentration</a></li>
  <li><a href="#berechnung-der-wblc" id="toc-berechnung-der-wblc" class="nav-link" data-scroll-target="#berechnung-der-wblc">Berechnung der W<sub>BLC</sub></a></li>
  <li><a href="#interaktive-modelle-zur-laktatkinetik-bei-körperlicher-belastung" id="toc-interaktive-modelle-zur-laktatkinetik-bei-körperlicher-belastung" class="nav-link" data-scroll-target="#interaktive-modelle-zur-laktatkinetik-bei-körperlicher-belastung">Interaktive Modelle zur Laktatkinetik bei körperlicher Belastung</a></li>
  <li><a href="#laktat-leistungs-beziehung" id="toc-laktat-leistungs-beziehung" class="nav-link" data-scroll-target="#laktat-leistungs-beziehung">Laktat-Leistungs-Beziehung</a>
  <ul class="collapse">
  <li><a href="#blutlaktat-modellfunktion-exponentieller-abfall-nach-dem-belastungsende" id="toc-blutlaktat-modellfunktion-exponentieller-abfall-nach-dem-belastungsende" class="nav-link" data-scroll-target="#blutlaktat-modellfunktion-exponentieller-abfall-nach-dem-belastungsende">Blutlaktat-Modellfunktion: Exponentieller Abfall nach dem Belastungsende</a></li>
  </ul></li>
  <li><a href="#blutlaktat-bateman-modellfunktion-während-und-nach-dem-belastungszeitraum" id="toc-blutlaktat-bateman-modellfunktion-während-und-nach-dem-belastungszeitraum" class="nav-link" data-scroll-target="#blutlaktat-bateman-modellfunktion-während-und-nach-dem-belastungszeitraum">Blutlaktat-Bateman-Modellfunktion: Während und nach dem Belastungszeitraum</a></li>
  <li><a href="#blutlaktat-kompartmentmodell-modellfunktion-nach-freund-et-al.-1986" id="toc-blutlaktat-kompartmentmodell-modellfunktion-nach-freund-et-al.-1986" class="nav-link" data-scroll-target="#blutlaktat-kompartmentmodell-modellfunktion-nach-freund-et-al.-1986">Blutlaktat-Kompartmentmodell-Modellfunktion (nach Freund et al.&nbsp;1986)</a></li>
  <li><a href="#quellenverzeichnis" id="toc-quellenverzeichnis" class="nav-link" data-scroll-target="#quellenverzeichnis">Quellenverzeichnis</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../Theoretischer_Hintergrund/index_Theoretischer_Hintergrund.html">Theoretischer Hintergrund</a></li><li class="breadcrumb-item"><a href="../../Theoretischer_Hintergrund/Energieumsatzberechnung/index_Energieumsatzberechnung.html">Energieumsatzberechnung</a></li><li class="breadcrumb-item"><a href="../../Theoretischer_Hintergrund/Energieumsatzberechnung/Anaerobe_laktazide_Energiebereitstellung.html">Anaerobe- laktazide Energiekomponente (W<sub>BLC</sub>)</a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Anaerobe- laktazide Energiekomponente (W<sub>BLC</sub>)</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="cell">
<style type="text/css">
p {
  text-align: justify
}
caption, .figure-caption {
  text-align: left;
}
figure.quarto-float-tbl figcaption {
  text-align: left !important;
}
figure figcaption {
  text-align: justify;
}
</style>
</div>
<section id="kinetik-der-blutlaktatkonzentration" class="level2">
<h2 class="anchored" data-anchor-id="kinetik-der-blutlaktatkonzentration">Kinetik der Blutlaktatkonzentration</h2>
<p>Bei intensiven körperlichen Belastungen übersteigt der Energiebedarf die oxidative Kapazität der Mitochondrien, wodurch vermehrt ATP durch anaerobe Glykolyse bereitgestellt wird. Dieser Stoffwechselweg resultiert in einer verstärkten Bildung von Laktat in der beanspruchten Muskulatur. Das Laktat diffundiert aus dieser Muskulatur in die Zwischenzellräume und gelangt über die Venen zum rechten Herzen. Dort wird das Blut aus der Muskulatur mit dem Blut aus anderen Körperregionen vermischt und durch die Lunge zum linken Herzen gepumpt und in die Aorta ausgeworfen. Anschließend werden sämtliche Arterien, einschließlich jener, die die Regionen um die Blutentnahmestellen am Ohrläppchen versorgen, von Blut mit gleicher Laktatkonzentration durchströmt. Das gebildete Laktat wird nach einer Rückumwandlung von Laktat in Pyruvat vornehmlich im belasteten Muskel selbst, in geringerem Maße im Herzmuskel, in den Nieren und im Gehirn eliminiert. Primär in der Leber wird Laktat über die Glukoneogenese via Pyruvat wieder zu Glukose und Glykogen (Glukoneogenese) aufgebaut. Die Laktateliminationsrate hängt von der Höhe des aeroben Umsatzes und der Laktatkonzentration ab, wobei sie mit steigendem aerobem Stoffwechsel und höherer Laktatkonzentration zunimmt <span class="citation" data-cites="VanHall2010 Heck2022">(<a href="#ref-Heck2022" role="doc-biblioref">Heck et al., 2022, S. 38, 193, 407</a>; <a href="#ref-VanHall2010" role="doc-biblioref">Van Hall, 2010</a>)</span>.<br> Während einer intensiven Belastung steigt das Muskellaktat steil an und fällt nach Belastungsende annähernd exponentiell ab. Die Blutlaktatkonzentration hingegen erreicht erst nach Belastungsende ihr Maximum (BLC<sub>max</sub>) <span class="citation" data-cites="Diamant1968 Mader1981 Heck2022 Margaria1933 Beneke2007">(<a href="#ref-Beneke2007" role="doc-biblioref">Beneke et al., 2007</a>; <a href="#ref-Diamant1968" role="doc-biblioref">Diamant et al., 1968</a>; <a href="#ref-Heck2022" role="doc-biblioref">Heck et al., 2022, S. 193</a>; <a href="#ref-Mader1981" role="doc-biblioref">Mader et al., 1981</a>; <a href="#ref-Margaria1933" role="doc-biblioref">Margaria et al., 1933</a>)</span>. BLC<sub>max</sub> wird in Abhängigkeit von der Belastungsdauer und Intensität sowie der maximalen Laktatkonzentration erst nach bis zu 10-12 Minuten Erholungszeit erreicht, in Einzelfällen sogar erst nach 15-20 Minuten (siehe <a href="#fig-Laktat3" class="quarto-xref">Abbildung&nbsp;3</a>). Die Ursache hierfür ist der Konzentrationsgradient zwischen der Muskel- und Blutlaktatkonzentration. In <a href="#fig-Laktat" class="quarto-xref">Abbildung&nbsp;1</a> und <a href="#fig-Laktat2" class="quarto-xref">Abbildung&nbsp;2</a> ist der Konzentrationsgradient zwischen Muskel- und Blutlaktatkonzentration gut zu erkennen. Diese charakteristische Laktatkinetik, insbesondere die Differenz zwischen dem Blutlaktatwert vor Belastungsbeginn (BLC<sub>Pre</sub>) und BLC<sub>max</sub>, bildet die Grundlage für die quantitative Bestimmung des anaerob-laktaziden Energieanteils einer Belastung.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[[1,1], [1]]">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-Laktat" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Laktat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/Laktat.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Abbildung&nbsp;1: Simulierte Verlaufskurve von Muskellaktat und Blutlaktat bei einer 2 minütigen Maximalbalastung [@Mader1981]"><img src="images/Laktat.png" height="400" class="figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Laktat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;1: Simulierte Verlaufskurve von Muskellaktat und Blutlaktat bei einer 2 minütigen Maximalbalastung <span class="citation" data-cites="Mader1981">(<a href="#ref-Mader1981" role="doc-biblioref">Mader et al., 1981</a>)</span>
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-Laktat2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Laktat2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/Nachbelastungslaktat_Diamant2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Abbildung&nbsp;2: Verlaufskurve von Muskellaktat und Blutlaktat nach einer dreiminütigen Ausbelastung auf dem Fahrradergometer [@Diamant1968]"><img src="images/Nachbelastungslaktat_Diamant2.png" height="400" class="figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Laktat2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;2: Verlaufskurve von Muskellaktat und Blutlaktat nach einer dreiminütigen Ausbelastung auf dem Fahrradergometer <span class="citation" data-cites="Diamant1968">(<a href="#ref-Diamant1968" role="doc-biblioref">Diamant et al., 1968</a>)</span>
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-Laktat3" class="quarto-float quarto-figure quarto-figure-left anchored" data-fig-align="left">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Laktat3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/Nachbelastungslaktat_Heck.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Abbildung&nbsp;3: Nachbelastungslaktatwerte aus Ohrkapillarblut nach 300m und 600m Läufen mit unterschiedlicher Intensität [@Heck2022, 193]"><img src="images/Nachbelastungslaktat_Heck.png" class="quarto-figure quarto-figure-left figure-img" height="500"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Laktat3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;3: Nachbelastungslaktatwerte aus Ohrkapillarblut nach 300m und 600m Läufen mit unterschiedlicher Intensität <span class="citation" data-cites="Heck2022">(<a href="#ref-Heck2022" role="doc-biblioref">Heck et al., 2022, S. 193</a>)</span>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="berechnung-der-wblc" class="level2">
<h2 class="anchored" data-anchor-id="berechnung-der-wblc">Berechnung der W<sub>BLC</sub></h2>
<p>Die Berechnung des anaerob-laktaziden Energieanteils (W<sub>BLC</sub>) erfolgt aus dem Blutlaktatwert direkt vor Beginn der Belastung (BLC<sub>Pre</sub>) und dem maximalen Laktatwert nach der Belastung (BLC<sub>max</sub>). Die Differenz von BLC<sub>max</sub> und BLC<sub>Pre</sub> ergibt den Nettoblutlaktatwert (BLC<sub>Netto</sub>), der die größte Schwankung zwischen BLC<sub>Pre</sub> und BLC<sub>max</sub> darstellt. Durch Multiplikation von BLC<sub>Netto</sub> mit einem Sauerstoff-Laktat-Äquivalent von 3.0 [ml O<sub>2</sub>·kg<sup>-1</sup>·mmol<sup>-1</sup>] <span class="citation" data-cites="DiPrampero1981">(<a href="#ref-DiPrampero1981" role="doc-biblioref">Di Prampero, 1981</a>)</span> und dem kÄ für Kohlenhydrate (kÄ<sub>KH</sub>) bei einem RQ von 1.0 von 21.131 kJ pro Liter O<sub>2</sub> kann der anaerob-laktazide Energieanteil der Belastung in Joule ermittelt werden <span class="citation" data-cites="Stegemann1991">(<a href="#ref-Stegemann1991" role="doc-biblioref">Stegemann, 1991, S. 59</a>)</span>:</p>
<p><span class="math display">\[
W_{BLC} = BLC_{Netto} \, [\text{mmol} \cdot \text{l}^{-1}] \cdot 3.0 \, [\text{ml O}_2 \cdot \text{kg}^{-1} \cdot \text{mmol}^{-1}] \cdot \text{Körpermasse} \, [\text{kg}] \cdot kÄ_{\text{KH}} \, [\text{kJ} \cdot \text{l}^{-1} \,\text{O}_2]
\]</span> Die mittlere anaerob-laktazide Leistung (<span class="math inline">\(\overline{P}_{BLC}\)</span>) kann dann durch Division des W<sub>BLC</sub>-Wertes in kJ durch die Belastungsdauer t in Sekunden berechnet werden:</p>
<p><span id="eq-PBLC"><span class="math display">\[
\overline{P}_{BLC}\;[W] = \frac{W_{BLC}}{t} \cdot 1000
\tag{1}\]</span></span></p>
</section>
<section id="interaktive-modelle-zur-laktatkinetik-bei-körperlicher-belastung" class="level2">
<h2 class="anchored" data-anchor-id="interaktive-modelle-zur-laktatkinetik-bei-körperlicher-belastung">Interaktive Modelle zur Laktatkinetik bei körperlicher Belastung</h2>
<p>Die nachfolgenden interaktiven Shiny-Apps dienen der Veranschaulichung verschiedener Laktatreaktionen des Körpers unter Belastung. Sie illustrieren sowohl die Beziehung zwischen Belastungsintensität und Blutlaktatkonzentration als auch den charakteristischen Verlauf der Laktatwerte während und nach definierten Belastungen. Die Apps ermöglichen durch Anpassung der Belastungsparameter ein besseres Verständnis der physiologischen Zusammenhänge. Die jeweiligen Modellparameter werden im Anschluss an jede Shiny-App ausführlich erläutert.</p>
</section>
<section id="laktat-leistungs-beziehung" class="level2">
<h2 class="anchored" data-anchor-id="laktat-leistungs-beziehung">Laktat-Leistungs-Beziehung</h2>
<p>In der folgenden Anwendung wird die charakteristische Laktat-Leistungs-Beziehung während ansteigender Belastung visualisiert. Der Verlauf zeigt zunächst einen leichten Anstieg der Blutlaktatkonzentration bei zunehmender Belastungsintensität, welche hier durch die externe Leistung beim Radfahren in Watt ausgedrückt wird. Ab einem bestimmten Belastungspunkt steigt die Laktatkonzentration überproportional an. Dies resultiert in einem exponentiellen Anstieg der Laktat-Leistungs-Kurve. Diese Beziehung verdeutlicht das Verhältnis zwischen der Änderung der Laktatkonzentration (ΔLaktat) und der Änderung der Belastungsintensität (ΔLeistung).</p>
<pre class="shinylive-r" data-engine="r"><code>#| '!! shinylive warning !!': |
#|   shinylive does not work in self-contained HTML documents.
#|   Please set `embed-resources: false` in your metadata.
#| standalone: true
#| viewerHeight: 900
library(shiny)
library(plotly)

# UI bleibt unverändert
ui &lt;- fluidPage(
  titlePanel("Laktat-Leistungs-Modell"),
  sidebarLayout(
    sidebarPanel(
      numericInput("num_rows", "Anzahl der Datenpunkte", 4, min = 1, max = 20),
      uiOutput("input_fields"),
      width = 2  
    ),
    mainPanel(
      width = 9,
      plotlyOutput("plot"),
      uiOutput("instructions")
    )
  )
)

# Server mit angepasstem Plot-Bereich
server &lt;- function(input, output, session) {
  initial_values &lt;- list(
    list(Leistung = 100, DeltaBLC = 0.3),
    list(Leistung = 200, DeltaBLC = 1.0),
    list(Leistung = 300, DeltaBLC = 2.8),
    list(Leistung = 400, DeltaBLC = 8.0)
  )
  
  output$input_fields &lt;- renderUI({
    num_rows &lt;- input$num_rows
    
    lapply(1:num_rows, function(i) {
      initial_value &lt;- if (i &lt;= length(initial_values)) initial_values[[i]] else list(Leistung = 0, DeltaBLC = 0)
      tagList(
        numericInput(paste0("leistung_", i), paste("ΔLeistung", i), value = initial_value$Leistung, step = 10),
        numericInput(paste0("deltaBLC_", i), paste("ΔBLC", i), value = initial_value$DeltaBLC, step = 0.1)
      )
    })
  })
  
  input_data &lt;- reactive({
    num_rows &lt;- input$num_rows
    if (is.null(num_rows)) return(NULL)
    
    data &lt;- data.frame(Leistung = numeric(num_rows), ΔBLC = numeric(num_rows))
    
    for (i in 1:num_rows) {
      leistung_val &lt;- input[[paste0("leistung_", i)]]
      deltaBLC_val &lt;- input[[paste0("deltaBLC_", i)]]
      
      if (is.null(leistung_val) || is.null(deltaBLC_val)) {
        data$Leistung[i] &lt;- if (i &lt;= length(initial_values)) initial_values[[i]]$Leistung else 0
        data$ΔBLC[i] &lt;- if (i &lt;= length(initial_values)) initial_values[[i]]$DeltaBLC else 0
      } else {
        data$Leistung[i] &lt;- leistung_val
        data$ΔBLC[i] &lt;- deltaBLC_val
      }
    }
    
    data
  })
  
  observe({
    for (i in 1:length(initial_values)) {
      updateNumericInput(session, paste0("leistung_", i), value = initial_values[[i]]$Leistung)
      updateNumericInput(session, paste0("deltaBLC_", i), value = initial_values[[i]]$DeltaBLC)
    }
  })
  
  output$plot &lt;- renderPlotly({
    df_proband &lt;- input_data()
    
    if (is.null(df_proband)) return(NULL)
    
    model &lt;- nls(ΔBLC ~ a * exp(b * Leistung), data = df_proband, start = list(a = 1, b = 0.01))
    coef_exponential_model &lt;- coef(model)
    
    # Erweiterte x-Sequenz von 0 bis max * 1.25
    x_max &lt;- max(df_proband$Leistung) * 1.25
    x_seq &lt;- seq(0, x_max, length.out = 100)
    y_pred &lt;- predict(model, newdata = data.frame(Leistung = x_seq))
    
    plot_ly() %&gt;%
      add_trace(data = df_proband, x = ~Leistung, y = ~ΔBLC, type = 'scatter', mode = 'markers',
                name = "ΔBLC",
                marker = list(color = "#2683C6", size = 7.0)) %&gt;%
      add_trace(x = x_seq, y = y_pred, type = 'scatter', mode = 'lines', 
                name = 'Laktat-Modellfunktion', 
                line = list(color = '#62A39F', width = 3)) %&gt;%
      add_annotations(text = sprintf("ΔBLC (ΔLeistung) = %.5f \u00B7 e&lt;sup&gt;%.5f \u00B7 ΔLeistung&lt;/sup&gt;", 
                                     coef_exponential_model['a'], coef_exponential_model['b']),
                      x = x_max * 0.02,
                      y = max(y_pred) * 0.90,
                      showarrow = FALSE,
                      xanchor = 'left', 
                      yanchor = 'top',
                      font = list(family = "Arial, sans-serif", size = 12, color = "black")) %&gt;%
      layout(
        title = "Laktat-Leistungs-Modell",
        margin = list(t = 40),
        xaxis = list(
          title = "ΔLeistung [Watt]",
          range = c(0, x_max)  # x-Achse von 0 bis max * 1.25
        ),
        yaxis = list(
          title = "ΔBLC [mmol \u00B7 l&lt;sup&gt;-1&lt;/sup&gt;]",
          range = c(0, max(y_pred) * 1.1)
        ),
        legend = list(
          x = 0.01,
          y = 0.99,
          xanchor = "left",
          yanchor = "top",
          bgcolor = "rgba(255, 255, 255, 0.8)",
          bordercolor = "rgba(0,0,0,0)",
          borderwidth = 0
        )
      )
  })
  
  output$instructions &lt;- renderUI({
    HTML(
      "&lt;div style='margin-top: 20px; padding: 10px; background-color: #f0f0f0; border: 1px solid #ddd; border-radius: 5px; width: fit-content;'&gt;
        &lt;h4 style='color: #333;'&gt;&lt;strong&gt;Anleitung - Modellanpassung:&lt;/strong&gt;&lt;/h4&gt;
        &lt;ol style='color: #555; list-style-position: outside; padding-left: 20px;'&gt;
          &lt;li&gt;Anzahl der Datenpunkte bestimmen.&lt;/li&gt;
          &lt;li&gt;Für jeden Datenpunkt die Leistung (in Watt) und den entsprechenden ΔBLC-Wert eingeben.&lt;/li&gt;
          &lt;li&gt;Das exponentielle Modell wird automatisch an die eingegebenen Daten angepasst.&lt;/li&gt;
        &lt;/ol&gt;
      &lt;/div&gt;"
    )
  })
}

shinyApp(ui = ui, server = server)</code></pre>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Modellanpassung - Details:
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>1. Optimierung (nls - Fit):</strong></p>
<ul>
<li>Verwendete Funktion: nls (Non-Linear Least Squares)</li>
<li>Parameter: a, b</li>
<li>Modell: ΔBLC ~ a · exp(b · Leistung)</li>
<li>Prozess:
<ol type="a">
<li>Datenaufbereitung:
<ul>
<li>Erstellung eines reaktiven Dataframes basierend auf den Benutzereingaben</li>
</ul></li>
<li>Modellierung:
<ul>
<li>Anwendung des nicht-linearen Regressionsmodells auf die eingegebenen Daten</li>
<li>Startwerte:
<ul>
<li>a: <em>1.0</em></li>
<li>b: <em>0.01</em></li>
</ul></li>
</ul></li>
<li>Durchführung der nicht-linearen Regression:
<ul>
<li>Verwendung der Standard-nls-Funktion in R</li>
<li>Keine expliziten Grenzen für die Parameter gesetzt</li>
</ul></li>
<li>Ergebnisverarbeitung:
<ul>
<li>Extraktion der Koeffizienten a und b aus dem angepassten Modell</li>
</ul></li>
<li>Visualisierung:
<ul>
<li>Erstellung einer Sequenz von Leistungswerten für glatte Kurvendarstellung</li>
<li>Berechnung der vorhergesagten ΔBLC-Werte basierend auf dem Modell</li>
<li>Darstellung der eingegebenen Datenpunkte und der Modellkurve</li>
<li>Anzeige der Modellgleichung mit den angepassten Koeffizienten</li>
</ul></li>
</ol></li>
<li>Optimierung: Minimierung der Summe der quadrierten Abweichungen (nls)</li>
</ul>
</div>
</div>
</div>
<section id="blutlaktat-modellfunktion-exponentieller-abfall-nach-dem-belastungsende" class="level3">
<h3 class="anchored" data-anchor-id="blutlaktat-modellfunktion-exponentieller-abfall-nach-dem-belastungsende">Blutlaktat-Modellfunktion: Exponentieller Abfall nach dem Belastungsende</h3>
<p>Die nachfolgende Shiny-App visualisiert den Verlauf der Blutlaktatkonzentration nach Belastungsende. Der Verlauf zeigt ausgehend vom gewählten Startzeitpunkt und unter der vereinfachten Annahme eines sofortigen Laktatabbaus ohne weiteren Anstieg einen exponentiellen Abfall über die Zeit. Die Laktatkonzentration sinkt zunächst schnell und nähert sich dann asymptotisch dem Ruheniveau an. Diese Beziehung verdeutlicht das Verhältnis zwischen der Änderung der Laktatkonzentration (ΔLaktat) und der verstrichenen Zeit nach Belastungsende (ΔZeit).</p>
<pre class="shinylive-r" data-engine="r"><code>#| '!! shinylive warning !!': |
#|   shinylive does not work in self-contained HTML documents.
#|   Please set `embed-resources: false` in your metadata.
#| standalone: true
#| viewerHeight: 900
library(shiny)
library(shinylive)
library(plotly)
library(minpack.lm)

# Define data
t_s &lt;- c(23, 127, 261, 422.5, 549.8, 664.5, 795.8, 1254.9)
BLC_t &lt;- c(10.04, 7.49, 5.18, 3.9, 2.67, 2.18, 1.64, 0.98)

# New model function: A * exp(-k * (t - delay)) + BLC0
laktat_model_function &lt;- function(t, A, k, BLC0, delay) {
  A * exp(-k * (t - delay)) + BLC0
}

# UI
ui &lt;- fluidPage(
  titlePanel("BLC-Modellfunktion"),
  fluidRow(
    column(3,
           style = "height: 90vh; overflow-y: auto;",
           
           tags$h4(tags$strong("Modellparameter:")),
           sliderInput("A", "A [mmol/l]", min = 0.0, max = 15.0, value = 8.0, step = 0.1),
           sliderInput("k", "k [s^-1]", min = 0.0001, max = 0.02, value = 0.005, step = 0.0001),
           sliderInput("BLC0", "BLC0 [mmol/l]", min = 0.0, max = 5.0, value = 1.0, step = 0.01),
           sliderInput("delay", "Delay [s]", min = 0, max = 3600, value = 0, step = 0.1),
           actionButton("set_delay", "Delay auf BLC_1"),
           br(), br(),
           actionButton("optimize", "Fit: nlsLM"), 
           br(), br(),
           fileInput("file_upload", "CSV-Datei hochladen", accept = ".csv")
    ),
    mainPanel(
      width = 9,
      plotlyOutput("plot"),
      uiOutput("instructions")
    )
  )
)

# Server logic
server &lt;- function(input, output, session) {
  # Reactive value for uploaded data
  uploaded_data &lt;- reactiveVal(NULL)
  
  # Observer for CSV upload
  observeEvent(input$file_upload, {
    req(input$file_upload)
    df &lt;- read.csv(input$file_upload$datapath)
    
    if ("t_s" %in% names(df) &amp;&amp; "BLC_t" %in% names(df)) {
      uploaded_data(df)
    } else {
      showModal(modalDialog(
        title = "Ungültige CSV",
        "Die CSV-Datei muss 't_s' und 'BLC_t' als Spaltennamen enthalten.",
        easyClose = TRUE,
        footer = NULL
      ))
    }
  })
  
  # Observer for setting delay to first time point
  observeEvent(input$set_delay, {
    data &lt;- if (is.null(uploaded_data())) {
      data.frame(t_s = t_s, BLC_t = BLC_t)
    } else {
      uploaded_data()
    }
    updateSliderInput(session, "delay", value = min(data$t_s))
  })
  
  observeEvent(input$optimize, {
    data &lt;- if (is.null(uploaded_data())) {
      data.frame(t_s = t_s, BLC_t = BLC_t)
    } else {
      uploaded_data()
    }
    
    delay &lt;- input$delay
    
    # Filter data points after the delay
    data_filtered &lt;- data[data$t_s &gt; delay, ]
    
    if (nrow(data_filtered) &lt; 3) {
      showNotification("Nicht genügend Datenpunkte nach dem Delay für den Fitting-Prozess.", type = "error")
      return()
    }
    
    best_fit &lt;- NULL
    best_rss &lt;- Inf
    
    withProgress(message = 'Fitting in progress', value = 0, {
      for (i in 1:100) {
        # Randomized starting values
        A_start &lt;- runif(1, 0, 15)
        k_start &lt;- runif(1, 0.0001, 0.02)
        BLC0_start &lt;- runif(1, 0, 5)
        
        start_values &lt;- list(A = A_start, k = k_start, BLC0 = BLC0_start)
        
        model_equation &lt;- BLC_t ~ A * exp(-k * (t_s - delay)) + BLC0
        
        fit &lt;- try(nlsLM(model_equation,
                         data = data_filtered,
                         start = start_values,
                         lower = c(A = 0, k = 0.0001, BLC0 = 0),
                         upper = c(A = 15, k = 0.02, BLC0 = 5),
                         control = nls.control(maxiter = 1024)), silent = TRUE)
        
        if (!inherits(fit, "try-error")) {
          rss &lt;- sum(residuals(fit)^2)
          if (rss &lt; best_rss) {
            best_rss &lt;- rss
            best_fit &lt;- fit
          }
        }
        
        incProgress(1/100, detail = paste("Iteration", i))
      }
    })
    
    if (!is.null(best_fit)) {
      params &lt;- as.list(coef(best_fit))
      updateSliderInput(session, "A", value = params$A)
      updateSliderInput(session, "k", value = params$k)
      updateSliderInput(session, "BLC0", value = params$BLC0)
      
      showNotification("Fitting completed successfully!", type = "message")
    } else {
      showModal(modalDialog(
        title = "nlsLM fehlgeschlagen",
        "Die nicht-lineare Regression mit dem Levenberg-Marquardt-Algorithmus konnte nicht erfolgreich durchgeführt werden.",
        easyClose = TRUE,
        footer = NULL
      ))
    }
  })
  
  output$plot &lt;- renderPlotly({
    A &lt;- input$A
    k &lt;- input$k
    BLC0 &lt;- input$BLC0
    delay &lt;- input$delay
    
    data &lt;- if (is.null(uploaded_data())) {
      data.frame(t_s = t_s, BLC_t = BLC_t)
    } else {
      uploaded_data()
    }
    
    max_x &lt;- max(data$t_s) * 1.66
    min_x &lt;- max(delay - 360, 0)
    
    t_s_modell &lt;- seq(min_x, max_x, length.out = 1000)
    BLC_t_modell &lt;- laktat_model_function(t_s_modell, A, k, BLC0, delay)
    
    max_y &lt;- max(max(BLC_t_modell) * 1.1, max(data$BLC_t) * 1.1)
    
    # Create equation text
    eq_text &lt;- sprintf("BLC(t) = %.2f * e&lt;sup&gt;-%.4f*(t-%.2f)&lt;/sup&gt; + %.3f", A, k, delay, BLC0)
    
    # Calculate R²
    data_filtered &lt;- data[data$t_s &gt; delay, ]
    BLC_t_modell_at_data &lt;- laktat_model_function(data_filtered$t_s, A, k, BLC0, delay)
    ss_res &lt;- sum((data_filtered$BLC_t - BLC_t_modell_at_data)^2)
    ss_tot &lt;- sum((data_filtered$BLC_t - mean(data_filtered$BLC_t))^2)
    r_squared &lt;- 1 - (ss_res / ss_tot)
    
    # Plotly plot
    p &lt;- plot_ly() %&gt;%
      add_trace(x = t_s_modell[t_s_modell &gt;= delay], y = BLC_t_modell[t_s_modell &gt;= delay], 
                type = 'scatter', mode = 'lines', 
                name = 'Modellfunktion', line = list(color = '#EF6F6A')) %&gt;%
      add_trace(x = t_s_modell[t_s_modell &lt; delay], y = BLC_t_modell[t_s_modell &lt; delay], 
                type = 'scatter', mode = 'lines', 
                name = 'Modellfunktion (vor Delay)', line = list(color = '#EF6F6A', dash = 'dash')) %&gt;%
      add_trace(x = data$t_s, y = data$BLC_t, type = 'scatter', mode = 'markers', 
                name = 'Gemessene BLC-Werte', marker = list(color = '#42BA97', size = 10, symbol = 'x')) %&gt;%
      add_segments(x = delay, xend = delay, y = 0, yend = max_y, 
                   line = list(color = 'darkgrey', width = 1, dash = 'dash'), 
                   showlegend = FALSE, opacity = 0.75) %&gt;%
      layout(title = "Exponentielles Laktat-Abbaumodell",
             margin = list(t = 40),
             xaxis = list(title = "Zeit [s]", range = c(min_x, max_x)),
             yaxis = list(title = "BLC [mmol·l⁻¹]", range = c(0, max_y)),
             legend = list(
               x = 0.07,
               y = 0.99,
               xanchor = "left",
               yanchor = "top",
               bgcolor = "rgba(255, 255, 255, 0.4)",
               bordercolor = "rgba(0,0,0,0)",
               borderwidth = 0
             ),
             paper_bgcolor = 'rgba(0,0,0,0)',
             plot_bgcolor = 'rgba(0,0,0,0)',
             annotations = list(
               list(
                 x = max_x * 0.4, 
                 y = max_y * 0.95,
                 text = eq_text,
                 showarrow = FALSE,
                 xanchor = 'left',
                 yanchor = 'bottom',
                 font = list(
                   size = 12,
                   color = "black"
                 )
               ),
               list(
                 x = max_x * 0.4,
                 y = max_y * 0.90,
                 text = sprintf("R²: %.4f", r_squared),
                 showarrow = FALSE,
                 xanchor = 'left',
                 yanchor = 'bottom',
                 font = list(
                   size = 12,
                   color = "black"
                 )
               )
             ))
    
    p
  })
  output$instructions &lt;- renderUI({
    HTML(
      "&lt;div style='margin-top: 20px; padding: 10px; background-color: #f0f0f0; border: 1px solid #ddd; border-radius: 5px; width: fit-content;'&gt;
        &lt;h4 style='color: #333;'&gt;&lt;strong&gt;Anleitung - Modellanpassung:&lt;/strong&gt;&lt;/h4&gt;
        &lt;ol style='color: #555; list-style-position: outside; padding-left: 20px;'&gt;
          &lt;li&gt;Beispiel-Laktatdaten verwenden oder eigene Laktat-Daten als CSV-Datei einfügen.&lt;/li&gt;
          &lt;li&gt;Zeitverzögerung manuell setzen oder mit 'Delay auf BLC_1' die Zeitverzögerung auf den Zeitpunkt des ersten BLC-Wertes setzen.&lt;/li&gt;
          &lt;li&gt;Modellanpassung 'Fit: nlsLM' durchführen.&lt;/li&gt;
          &lt;li&gt;Alternativ: Manuelle Modellanpassung der Modellparameter mit den Schiebereglern.&lt;/li&gt;
        &lt;/ol&gt;
        &lt;div style='margin-top: 20px;'&gt;&lt;/div&gt;
        &lt;pre style='background-color: #f8f8f8; padding: 10px; border: 1px solid #ddd; border-radius: 5px; width: fit-content;'&gt;
Laktat-Daten können als CSV-Datei im folgenden Format hochgeladen werden:
t_s,BLC_t
0.0,5.84
90.0,3.60
180.0,1.09
…
        &lt;/pre&gt;
      &lt;/div&gt;"
    )
  })
}

# App ausführen
shinyApp(ui = ui, server = server)</code></pre>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Modellanpassung - Details:
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>nlsLM - Fit:</strong></p>
<ul>
<li>Verwendete Funktion: nlsLM</li>
<li>Parameter: a, k1, k2, BLC0</li>
<li>Modell: BLC_t ~ BLC0 + (a · k1 / (k2 - k1)) · (exp(-k1 · t_min) - exp(-k2 · t_min))</li>
<li>Grenzen:
<ul>
<li>a: <em>0.0 bis 30.0 mmol/l</em></li>
<li>k1: <em>0.1 bis 3.5 min^-1</em></li>
<li>k2: <em>0.020 bis 0.200 min^-1</em></li>
<li>BLC0: <em>0.90 · BLC_t[1] bis 1.10 · BLC_t[1], begrenzt auf 0 bis 5 mmol/l</em></li>
</ul></li>
<li>Prozess:
<ol type="a">
<li>Bestimmung der BLC0-Grenzen:
<ul>
<li>Untere Grenze: <em>max(0, 0.90 · erster BLC-Wert)</em></li>
<li>Obere Grenze: <em>min(5, 1.10 · erster BLC-Wert)</em></li>
</ul></li>
<li>Iterative Optimierung (100 Durchläufe):
<ul>
<li>Zufällige Startwertebestimmung für jeden Durchlauf: · a: Zufallswert zwischen 0 und 30 · k1: Zufallswert zwischen 0.1 und 3.5 · k2: Zufallswert zwischen 0.020 und 0.200 · BLC0: Zufallswert zwischen der unteren und oberen BLC0-Grenze</li>
<li>Durchführung der nicht-linearen Regression: · Verwendung des Levenberg-Marquardt-Algorithmus · Maximale Iterationen: <em>1024</em></li>
<li>Berechnung der Residuenquadratsumme (RSS) für jede Anpassung</li>
<li>Speicherung der besten Anpassung (niedrigste RSS)</li>
</ul></li>
</ol></li>
<li>Optimierung: Minimierung der Residuenquadratsumme (RSS)</li>
</ul>
</div>
</div>
</div>
</section>
</section>
<section id="blutlaktat-bateman-modellfunktion-während-und-nach-dem-belastungszeitraum" class="level2">
<h2 class="anchored" data-anchor-id="blutlaktat-bateman-modellfunktion-während-und-nach-dem-belastungszeitraum">Blutlaktat-Bateman-Modellfunktion: Während und nach dem Belastungszeitraum</h2>
<p>In der folgenden Shiny-Anwendung wird die Laktatkinetik während und nach einer intensiven Belastung mithilfe der Bateman-Funktion modelliert. Diese mathematische Funktion beschreibt sowohl den Einstrom (Invasion) des Laktats aus der Muskulatur ins Blut als auch die gleichzeitige Elimination aus dem Blut. Der Konzentrationsverlauf zeigt nach Belastungsende zunächst einen Anstieg bis zu einem Maximum, gefolgt von einem exponentiellen Abfall. Die Parameter k1 und k2 beschreiben dabei die Geschwindigkeitskonstanten für Invasion bzw. Elimination, während der Parameter a die theoretische Gesamtmenge des zu eliminierenden Laktats darstellt <span class="citation" data-cites="Heck2022">(<a href="#ref-Heck2022" role="doc-biblioref">Heck et al., 2022, S. 194</a>)</span>.</p>
<pre class="shinylive-r" data-engine="r"><code>#| '!! shinylive warning !!': |
#|   shinylive does not work in self-contained HTML documents.
#|   Please set `embed-resources: false` in your metadata.
#| standalone: true
#| viewerHeight: 900
library(shiny)
library(plotly)
library(minpack.lm)

# Definiere Daten
t_min &lt;- c(0.4, 3.3, 6.5, 8.4, 10.2, 12.5, 14.9, 16.7, 19.3)
BLC_t &lt;- c(0.82, 4.53, 6.97, 7.52, 7.73, 7.28, 6.37, 5.41, 4.71)

# Normalisiere t_min, wenn der kleinste Wert größer als 0.0 ist
if (min(t_min) &gt; 0.0) {
  t_min &lt;- t_min - min(t_min)
}

# Bateman-Funktion für Laktatwerte (in Minuten) mit BLC0
bateman_function &lt;- function(t, a, k1, k2, BLC0) {
  BLC0 + (a * k1 / (k2 - k1)) * (exp(-k1 * t) - exp(-k2 * t))
}

# Invasions- und Eliminationsfunktionen
invasion_function &lt;- function(t, a, k1, BLC0) {
  BLC0 + a * (1 - exp(-k1 * t))
}

elimination_function &lt;- function(t, a, k2, BLC0) {
  BLC0 + a * exp(-k2 * t)
}

# UI
ui &lt;- fluidPage(
  titlePanel("Bateman-Modellfunktion"),
  fluidRow(
    column(3,
           style = "height: 90vh; overflow-y: auto;",
           
           tags$h4(tags$strong("Modellparameter:")),
           sliderInput("a", "a [mmol/l]", min = 0.0, max = 30.0, value = 15.0, step = 0.01),
           sliderInput("k1", "k1 [min^-1]", min = 0.1, max = 3.5, value = 0.5, step = 0.001),
           sliderInput("k2", "k2 [min^-1]", min = 0.020, max = 0.200, value = 0.10, step = 0.001),
           sliderInput("BLC0", "BLC0 [mmol/l]", min = 0.0, max = 5.0, value = 1.0, step = 0.01),
           actionButton("optimize", "Fit: nlsLM"), 
           br(), br(),
           fileInput("file_upload", "CSV-Datei hochladen", accept = ".csv")
    ),
    mainPanel(
      width = 9,
      plotlyOutput("plot"),
      uiOutput("instructions")
    )
  )
)

# Server-Logik
server &lt;- function(input, output, session) {
  
  # Reaktiver Wert für hochgeladene Daten
  uploaded_data &lt;- reactiveVal(NULL)
  
  # Beobachter für CSV-Upload
  observeEvent(input$file_upload, {
    req(input$file_upload)
    df &lt;- read.csv(input$file_upload$datapath)
    
    if ("t_min" %in% names(df) &amp;&amp; "BLC_t" %in% names(df)) {
      if (df$t_min[1] != 0.0) {
        df$t_min &lt;- df$t_min - df$t_min[1]
      }
      
      uploaded_data(df)
    } else {
      showModal(modalDialog(
        title = "Ungültige CSV",
        "Die CSV-Datei muss 't_min' und 'BLC_t' als Spaltennamen enthalten.",
        easyClose = TRUE,
        footer = NULL
      ))
    }
  })
  
  observeEvent(input$optimize, {
    data &lt;- if (is.null(uploaded_data())) {
      data.frame(t_min = t_min, BLC_t = BLC_t)
    } else {
      uploaded_data()
    }
    
    # Setze BLC0 Grenzen basierend auf dem ersten BLC_t Wert
    BLC0_lower &lt;- max(0, data$BLC_t[1] * 0.9)
    BLC0_upper &lt;- min(5, data$BLC_t[1] * 1.1)
    
    best_fit &lt;- NULL
    best_rss &lt;- Inf
    
    withProgress(message = 'Fitting in progress', value = 0, {
      for (i in 1:100) {
        # Randomisierte Startwerte
        a_start &lt;- runif(1, 0, 30)
        k1_start &lt;- runif(1, 0.1, 3.5)
        k2_start &lt;- runif(1, 0.020, 0.200)
        BLC0_start &lt;- runif(1, BLC0_lower, BLC0_upper)
        
        start_values &lt;- list(a = a_start, k1 = k1_start, k2 = k2_start, BLC0 = BLC0_start)
        
        model_equation &lt;- BLC_t ~ BLC0 + (a * k1 / (k2 - k1)) * (exp(-k1 * t_min) - exp(-k2 * t_min))
        
        fit &lt;- try(nlsLM(model_equation,
                         data = data,
                         start = start_values,
                         lower = c(a = 0.0, k1 = 0.1, k2 = 0.020, BLC0 = BLC0_lower),
                         upper = c(a = 30.0, k1 = 3.5, k2 = 0.200, BLC0 = BLC0_upper),
                         control = nls.control(maxiter = 1024)), silent = TRUE)
        
        if (!inherits(fit, "try-error")) {
          rss &lt;- sum(residuals(fit)^2)
          if (rss &lt; best_rss) {
            best_rss &lt;- rss
            best_fit &lt;- fit
          }
        }
        
        incProgress(1/100, detail = paste("Iteration", i))
      }
    })
    
    if (!is.null(best_fit)) {
      params &lt;- as.list(coef(best_fit))
      updateSliderInput(session, "a", value = params$a)
      updateSliderInput(session, "k1", value = params$k1)
      updateSliderInput(session, "k2", value = params$k2)
      updateSliderInput(session, "BLC0", value = params$BLC0)
      
      showNotification("Fitting completed successfully!", type = "message")
    } else {
      showModal(modalDialog(
        title = "nlsLM fehlgeschlagen",
        "Die nicht-lineare Regression mit dem Levenberg-Marquardt-Algorithmus konnte nicht erfolgreich durchgeführt werden.",
        easyClose = TRUE,
        footer = NULL
      ))
    }
  })
  
  output$plot &lt;- renderPlotly({
    a &lt;- input$a
    k1 &lt;- input$k1
    k2 &lt;- input$k2
    BLC0 &lt;- input$BLC0
    
    data &lt;- if (is.null(uploaded_data())) {
      data.frame(t_min = t_min, BLC_t = BLC_t)
    } else {
      uploaded_data()
    }
    
    max_x &lt;- max(data$t_min) * 1.66
    
    t_min_modell &lt;- seq(0, max_x, length.out = 1000)
    BLC_t_modell &lt;- bateman_function(t_min_modell, a, k1, k2, BLC0)
    invasion_modell &lt;- invasion_function(t_min_modell, a, k1, BLC0)
    elimination_modell &lt;- elimination_function(t_min_modell, a, k2, BLC0)
    
    max_y &lt;- max(max(BLC_t_modell) * 1.2, max(data$BLC_t) * 1.2, max(invasion_modell) * 1.2, max(elimination_modell) * 1.2)
    
    # Berechne tmax und Lamax
    tmax &lt;- log(k1/k2) / (k1 - k2)
    Lamax &lt;- bateman_function(tmax, a, k1, k2, BLC0)
    
    # Erstelle Gleichungstext
    eq_text &lt;- sprintf("[La]&lt;sub&gt;b&lt;/sub&gt;(t) = %.2f + (%.2f * %.3f / (%.3f - %.3f)) * (e&lt;sup&gt;-%.3f*t&lt;/sup&gt; - e&lt;sup&gt;-%.3f*t&lt;/sup&gt;)", 
                       BLC0, a, k1, k2, k1, k1, k2)
    
    # Berechne R²
    BLC_t_modell_at_data &lt;- bateman_function(data$t_min, a, k1, k2, BLC0)
    ss_res &lt;- sum((data$BLC_t - BLC_t_modell_at_data)^2)
    ss_tot &lt;- sum((data$BLC_t - mean(data$BLC_t))^2)
    r_squared &lt;- 1 - (ss_res / ss_tot)
    
    # Plotly-Plot
    p &lt;- plot_ly() %&gt;%
      add_trace(x = t_min_modell, y = BLC_t_modell, type = 'scatter', mode = 'lines', 
                name = 'Bateman-Funktion', line = list(color = '#EF5350')) %&gt;%
      add_trace(x = t_min_modell, y = invasion_modell, type = 'scatter', mode = 'lines', 
                name = 'Invasion', line = list(color = "#9C85C0", width = 2, dash = '8 5'),
                opacity = 0.65) %&gt;%
      add_trace(x = t_min_modell, y = elimination_modell, type = 'scatter', mode = 'lines', 
                name = 'Elimination', line = list(color = '#2683C6', width = 2, dash = '8 5'),
                opacity = 0.65) %&gt;%
      add_trace(x = data$t_min, y = data$BLC_t, type = 'scatter', mode = 'markers', 
                name = 'Gemessene BLC-Werte', marker = list(color = "#42BA97", size = 9, symbol = 'x')) %&gt;%
      add_segments(x = tmax, xend = tmax, y = 0, yend = max_y, 
                   line = list(color = 'darkgrey', width = 1, dash = 'dash'), 
                   showlegend = FALSE, opacity = 0.5) %&gt;%
      add_segments(x = 0, xend = max_x, y = Lamax, yend = Lamax, 
                   line = list(color = 'darkgrey', width = 1, dash = 'dash'), 
                   showlegend = FALSE, opacity = 0.5) %&gt;%
      layout(
        title = "Bateman-Funktion für Laktat-Modellierung",
        margin = list(t = 40),
        xaxis = list(title = "Zeit [min]", range = c(0, max_x)),
        yaxis = list(title = "Laktat [mmol/l]", range = c(0, max_y)),
        legend = list(
          x = 0.01,
          y = 0.99,
          xanchor = "left",
          yanchor = "top",
          bgcolor = "rgba(255, 255, 255, 0.2)",
          bordercolor = "rgba(0,0,0,0)",
          borderwidth = 0
        ),
        annotations = list(
          list(
            x = max_x * 0.3, 
            y = max_y * 0.90,
            text = eq_text,
            showarrow = FALSE,
            xanchor = 'left',
            yanchor = 'bottom',
            font = list(
              size = 12,
              color = "black"
            )
          ),
          list(
            x = max_x * 0.3,
            y = max_y * 0.85,
            text = sprintf("R²: %.4f", r_squared),
            showarrow = FALSE,
            xanchor = 'left',
            yanchor = 'bottom',
            font = list(
              size = 12,
              color = "black"
            )
          ),
          list(
            x = max_x * 0.3,
            y = max_y * 0.80,
            text = sprintf("BLC&lt;sub&gt;max&lt;/sub&gt;: %.2f mmol/l", Lamax),
            showarrow = FALSE,
            xanchor = 'left',
            yanchor = 'bottom',
            font = list(
              size = 12,
              color = "black"
            )
          ),
          list(
            x = max_x * 0.3,
            y = max_y * 0.75,
            text = sprintf("TBLC&lt;sub&gt;max&lt;/sub&gt;: %.2f min",tmax),
            showarrow = FALSE,
            xanchor = 'left',
            yanchor = 'bottom',
            font = list(
              size = 12,
              color = "black"
            )
          )
        )
      )
    
    p
  })
  output$instructions &lt;- renderUI({
    HTML(
      "&lt;div style='margin-top: 20px; padding: 10px; background-color: #f0f0f0; border: 1px solid #ddd; border-radius: 5px; width: fit-content;'&gt;
        &lt;h4 style='color: #333;'&gt;&lt;strong&gt;Anleitung - Modellanpassung:&lt;/strong&gt;&lt;/h4&gt;
        &lt;ol style='color: #555; list-style-position: outside; padding-left: 20px;'&gt;
          &lt;li&gt;Beispiel-Laktatdaten verwenden oder eigene Laktat-Daten als CSV-Datei einfügen.&lt;/li&gt;
          &lt;li&gt;Modellanpassung 'Fit: nlsLM' durchführen.&lt;/li&gt;
          &lt;li&gt;Alternativ: Manuelle Modellanpassung der Modellparameter mit den Schiebereglern.&lt;/li&gt;
        &lt;/ol&gt;
        &lt;div style='margin-top: 20px;'&gt;&lt;/div&gt;
        &lt;pre style='background-color: #f8f8f8; padding: 10px; border: 1px solid #ddd; border-radius: 5px; width: fit-content;'&gt;
Laktat-Daten können als CSV-Datei im folgenden Format hochgeladen werden:
t_min,BLC_t
0.0,2.84
1.5,3.60
3.0,5.09
…
        &lt;/pre&gt;
      &lt;/div&gt;"
    )
  })
}

# App ausführen
shinyApp(ui = ui, server = server)</code></pre>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Modellanpassung - Details:
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>nlsLM - Fit:</strong></p>
<ul>
<li>Verwendete Funktion: nlsLM</li>
<li>Parameter: a, k1, k2, BLC0</li>
<li>Modell: BLC_t ~ BLC0 + (a · k1 / (k2 - k1)) · (exp(-k1 · t_min) - exp(-k2 · t_min))</li>
<li>Grenzen:
<ul>
<li>a: <em>0.0 bis 30.0 mmol/l</em></li>
<li>k1: <em>0.1 bis 3.5 min^-1</em></li>
<li>k2: <em>0.020 bis 0.200 min^-1</em></li>
<li>BLC0: <em>0.90 · BLC_t[1] bis 1.10 · BLC_t[1], begrenzt auf 0 bis 5 mmol/l</em></li>
</ul></li>
<li>Prozess:
<ol type="a">
<li>Bestimmung der BLC0-Grenzen:
<ul>
<li>Untere Grenze: <em>max(0, 0.90 · erster BLC-Wert)</em></li>
<li>Obere Grenze: <em>min(5, 1.10 · erster BLC-Wert)</em></li>
</ul></li>
<li>Iterative Optimierung (100 Durchläufe):
<ul>
<li>Zufällige Startwertebestimmung für jeden Durchlauf: · a: Zufallswert zwischen 0 und 30 · k1: Zufallswert zwischen 0.1 und 3.5 · k2: Zufallswert zwischen 0.020 und 0.200 · BLC0: Zufallswert zwischen der unteren und oberen BLC0-Grenze</li>
<li>Durchführung der nicht-linearen Regression: · Verwendung des Levenberg-Marquardt-Algorithmus · Maximale Iterationen: <em>1024</em></li>
<li>Berechnung der Residuenquadratsumme (RSS) für jede Anpassung</li>
<li>Speicherung der besten Anpassung (niedrigste RSS)</li>
</ul></li>
</ol></li>
<li>Optimierung: Minimierung der Residuenquadratsumme (RSS)</li>
</ul>
</div>
</div>
</div>
</section>
<section id="blutlaktat-kompartmentmodell-modellfunktion-nach-freund-et-al.-1986" class="level2">
<h2 class="anchored" data-anchor-id="blutlaktat-kompartmentmodell-modellfunktion-nach-freund-et-al.-1986">Blutlaktat-Kompartmentmodell-Modellfunktion (nach Freund et al.&nbsp;1986)</h2>
<p>Die Shiny-App stellt die Laktatkinetik während und nach einer intensiven Belastung mithilfe des Zwei-Kompartment-Modells nach Freund et al.&nbsp;dar. Dieses mathematische Modell berücksichtigt sowohl die Laktatbildung und -elimination im Muskel- und Nicht-Muskelkompartment als auch den Austausch zwischen diesen Kompartmenten. Der Konzentrationsverlauf wird durch die Summe zweier Exponentialfunktionen beschrieben, deren Amplituden (A<sub>1</sub>, A<sub>2</sub>) und Geschwindigkeitskonstanten (γ<sub>1</sub>, γ<sub>2</sub>) die Dynamik der Laktatkinetik charakterisieren <span class="citation" data-cites="Freund1986 Heck2022">(<a href="#ref-Freund1986" role="doc-biblioref">Freund et al., 1986</a>; <a href="#ref-Heck2022" role="doc-biblioref">Heck et al., 2022, S. 197</a>)</span>.</p>
<pre class="shinylive-r" data-engine="r"><code>#| '!! shinylive warning !!': |
#|   shinylive does not work in self-contained HTML documents.
#|   Please set `embed-resources: false` in your metadata.
#| standalone: true
#| viewerHeight: 900
library(shiny)
library(plotly)
library(minpack.lm)

# Definiere Daten
t_min &lt;- c(0.4, 3.3, 6.5, 8.4, 10.2, 12.5, 14.9, 16.7, 19.3)
BLC_t &lt;- c(0.82, 4.53, 6.97, 7.52, 7.73, 7.28, 6.37, 5.41, 4.71)

# Normalisiere t_min, wenn der kleinste Wert größer als 0.0 ist
if (min(t_min) &gt; 0.0) {
  t_min &lt;- t_min - min(t_min)
}

# Freund et al. Kompartmentmodell-Funktion
freund_model &lt;- function(t, A1, A2, gamma1, gamma2, La0) {
  La0 + A1 * (1 - exp(-gamma1 * t)) + A2 * (1 - exp(-gamma2 * t))
}

# Berechne tmax und Lamax
calculate_tmax_lamax &lt;- function(A1, A2, gamma1, gamma2, La0) {
  f &lt;- function(t) freund_model(t, A1, A2, gamma1, gamma2, La0)
  tmax &lt;- optimize(f, c(0, 100), maximum = TRUE)$maximum
  Lamax &lt;- f(tmax)
  list(tmax = tmax, Lamax = Lamax)
}

# UI
ui &lt;- fluidPage(
  titlePanel("BLC-Kompartmentmodell-Modellfunktion"),
  fluidRow(
    column(3,
           style = "height: 90vh; overflow-y: auto;",
           
           tags$h4(tags$strong("Modellparameter:")),
           sliderInput("A1", "A1 [mmol/l]", min = 0.0, max = 100.0, value = 20.0, step = 0.1),
           sliderInput("A2", "A2 [mmol/l]", min = -100.0, max = 0.0, value = -20.0, step = 0.1),
           sliderInput("gamma1", "γ1 [min^-1]", min = 0.05, max = 2.0, value = 0.1, step = 0.001),
           sliderInput("gamma2", "γ2 [min^-1]", min = 0.01, max = 0.5, value = 0.05, step = 0.001),
           sliderInput("La0", "La0 [mmol/l]", min = 0.0, max = 5.0, value = 1.0, step = 0.01),
           actionButton("optimize", "Fit: nlsLM"), 
           br(), br(),
           fileInput("file_upload", "CSV-Datei hochladen", accept = ".csv")
    ),
    mainPanel(
      width = 9,
      plotlyOutput("plot"),
      uiOutput("instructions")
    )
  )
)

# Server-Logik
server &lt;- function(input, output, session) {
  
  # Reaktiver Wert für hochgeladene Daten
  uploaded_data &lt;- reactiveVal(NULL)
  
  # Beobachter für CSV-Upload
  observeEvent(input$file_upload, {
    req(input$file_upload)
    df &lt;- read.csv(input$file_upload$datapath)
    
    if ("t_min" %in% names(df) &amp;&amp; "BLC_t" %in% names(df)) {
      if (df$t_min[1] != 0.0) {
        df$t_min &lt;- df$t_min - df$t_min[1]
      }
      
      uploaded_data(df)
    } else {
      showModal(modalDialog(
        title = "Ungültige CSV",
        "Die CSV-Datei muss 't_min' und 'BLC_t' als Spaltennamen enthalten.",
        easyClose = TRUE,
        footer = NULL
      ))
    }
  })
  
  observeEvent(input$optimize, {
    data &lt;- if (is.null(uploaded_data())) {
      data.frame(t_min = t_min, BLC_t = BLC_t)
    } else {
      uploaded_data()
    }
    
    # Setze La0 Grenzen basierend auf dem ersten BLC_t Wert
    La0_lower &lt;- max(0, data$BLC_t[1] * 0.9)
    La0_upper &lt;- min(5, data$BLC_t[1] * 1.1)
    
    best_fit &lt;- NULL
    best_rss &lt;- Inf
    
    withProgress(message = 'Fitting in progress', value = 0, {
      for (i in 1:100) {
        # Randomisierte Startwerte
        A1_start &lt;- runif(1, 0, 100)
        A2_start &lt;- runif(1, -100, 0)
        gamma1_start &lt;- runif(1, 0.05, 2)
        gamma2_start &lt;- runif(1, 0.01, 0.5)
        La0_start &lt;- runif(1, La0_lower, La0_upper)
        
        start_values &lt;- list(A1 = A1_start, A2 = A2_start, gamma1 = gamma1_start, gamma2 = gamma2_start, La0 = La0_start)
        
        model_equation &lt;- BLC_t ~ La0 + A1 * (1 - exp(-gamma1 * t_min)) + A2 * (1 - exp(-gamma2 * t_min))
        
        fit &lt;- try(nlsLM(model_equation,
                         data = data,
                         start = start_values,
                         lower = c(A1 = 0.0, A2 = -100.0, gamma1 = 0.05, gamma2 = 0.01, La0 = La0_lower),
                         upper = c(A1 = 100.0, A2 = 0.0, gamma1 = 2.0, gamma2 = 0.5, La0 = La0_upper),
                         control = nls.control(maxiter = 1024)), silent = TRUE)
        
        if (!inherits(fit, "try-error")) {
          rss &lt;- sum(residuals(fit)^2)
          if (rss &lt; best_rss) {
            best_rss &lt;- rss
            best_fit &lt;- fit
          }
        }
        
        incProgress(1/100, detail = paste("Iteration", i))
      }
    })
    
    if (!is.null(best_fit)) {
      params &lt;- as.list(coef(best_fit))
      updateSliderInput(session, "A1", value = params$A1)
      updateSliderInput(session, "A2", value = params$A2)
      updateSliderInput(session, "gamma1", value = params$gamma1)
      updateSliderInput(session, "gamma2", value = params$gamma2)
      updateSliderInput(session, "La0", value = params$La0)
      
      showNotification("Fitting completed successfully!", type = "message")
    } else {
      showModal(modalDialog(
        title = "nlsLM fehlgeschlagen",
        "Die nicht-lineare Regression mit dem Levenberg-Marquardt-Algorithmus konnte nicht erfolgreich durchgeführt werden.",
        easyClose = TRUE,
        footer = NULL
      ))
    }
  })
  
  output$plot &lt;- renderPlotly({
    A1 &lt;- input$A1
    A2 &lt;- input$A2
    gamma1 &lt;- input$gamma1
    gamma2 &lt;- input$gamma2
    La0 &lt;- input$La0
    
    data &lt;- if (is.null(uploaded_data())) {
      data.frame(t_min = t_min, BLC_t = BLC_t)
    } else {
      uploaded_data()
    }
    
    max_x &lt;- max(data$t_min) * 1.66
    
    t_min_modell &lt;- seq(0, max_x, length.out = 1000)
    BLC_t_modell &lt;- freund_model(t_min_modell, A1, A2, gamma1, gamma2, La0)
    
    max_y &lt;- max(max(BLC_t_modell) * 1.2, max(data$BLC_t) * 1.2)
    
    # Berechne tmax und Lamax
    results &lt;- calculate_tmax_lamax(A1, A2, gamma1, gamma2, La0)
    tmax &lt;- results$tmax
    Lamax &lt;- results$Lamax
    
    # Erstelle Gleichungstext
    eq_text &lt;- sprintf("[La]&lt;sub&gt;b&lt;/sub&gt; (t) = %.2f + %.1f * (1 - e&lt;sup&gt;-%.3f*t&lt;/sup&gt;) + %.1f * (1 - e&lt;sup&gt;-%.3f*t&lt;/sup&gt;)", 
                       La0, A1, gamma1, A2, gamma2)
    
    # Berechne R²
    BLC_t_modell_at_data &lt;- freund_model(data$t_min, A1, A2, gamma1, gamma2, La0)
    ss_res &lt;- sum((data$BLC_t - BLC_t_modell_at_data)^2)
    ss_tot &lt;- sum((data$BLC_t - mean(data$BLC_t))^2)
    r_squared &lt;- 1 - (ss_res / ss_tot)
    
    # Plotly-Plot
    p &lt;- plot_ly() %&gt;%
      add_trace(x = t_min_modell, y = BLC_t_modell, type = 'scatter', mode = 'lines', 
                name = 'Modellgleichung', line = list(color = '#EF5350')) %&gt;%
      add_trace(x = data$t_min, y = data$BLC_t, type = 'scatter', mode = 'markers', 
                name = 'Gemessene BLC-Werte', marker = list(color = "#42BA97", size = 9, symbol = 'x')) %&gt;%
      add_segments(x = tmax, xend = tmax, y = 0, yend = max_y, 
                   line = list(color = 'darkgrey', width = 1, dash = 'dash'), 
                   showlegend = FALSE, opacity = 0.5) %&gt;%
      add_segments(x = 0, xend = max_x, y = Lamax, yend = Lamax, 
                   line = list(color = 'darkgrey', width = 1, dash = 'dash'), 
                   showlegend = FALSE, opacity = 0.5) %&gt;%
      layout(
        title = "Freund et al. Kompartmentmodell für Laktat-Modellierung",
        margin = list(t = 40),
        xaxis = list(title = "Zeit [min]", range = c(0, max_x)),
        yaxis = list(title = "Laktat [mmol/l]", range = c(0, max_y)),
        legend = list(
          x = 0.01,
          y = 0.99,
          xanchor = "left",
          yanchor = "top",
          bgcolor = "rgba(255, 255, 255, 0.8)",
          bordercolor = "rgba(0,0,0,0)",
          borderwidth = 0
        ),
        annotations = list(
          list(
            x = max_x * 0.45, 
            y = max_y * 0.92,
            text = eq_text,
            showarrow = FALSE,
            xanchor = 'left',
            yanchor = 'bottom',
            font = list(
              size = 12,
              color = "black"
            )
          ),
          list(
            x = max_x * 0.45,
            y = max_y * 0.87,
            text = sprintf("R²: %.4f", r_squared),
            showarrow = FALSE,
            xanchor = 'left',
            yanchor = 'bottom',
            font = list(
              size = 12,
              color = "black"
            )
          ),
          list(
            x = max_x * 0.45,
            y = max_y * 0.82,
            text = sprintf("BLC&lt;sub&gt;max&lt;/sub&gt;: %.2f mmol/l", Lamax),
            showarrow = FALSE,
            xanchor = 'left',
            yanchor = 'bottom',
            font = list(
              size = 12,
              color = "black"
            )
          ),
          list(
            x = max_x * 0.45,
            y = max_y * 0.77,
            text = sprintf("TBLC&lt;sub&gt;max&lt;/sub&gt;: %.2f min",tmax),
            showarrow = FALSE,
            xanchor = 'left',
            yanchor = 'bottom',
            font = list(
              size = 12,
              color = "black"
            )
          )
        )
      )
    
    p
  })
  output$instructions &lt;- renderUI({
    HTML(
      "&lt;div style='margin-top: 20px; padding: 10px; background-color: #f0f0f0; border: 1px solid #ddd; border-radius: 5px; width: fit-content;'&gt;
        &lt;h4 style='color: #333;'&gt;&lt;strong&gt;Anleitung - Modellanpassung:&lt;/strong&gt;&lt;/h4&gt;
        &lt;ol style='color: #555; list-style-position: outside; padding-left: 20px;'&gt;
          &lt;li&gt;Beispiel-Laktatdaten verwenden oder eigene Laktat-Daten als CSV-Datei einfügen.&lt;/li&gt;
          &lt;li&gt;Modellanpassung 'Fit: nlsLM' durchführen.&lt;/li&gt;
          &lt;li&gt;Alternativ: Manuelle Modellanpassung der Modellparameter mit den Schiebereglern.&lt;/li&gt;
        &lt;/ol&gt;
        &lt;div style='margin-top: 20px;'&gt;&lt;/div&gt;
        &lt;pre style='background-color: #f8f8f8; padding: 10px; border: 1px solid #ddd; border-radius: 5px; width: fit-content;'&gt;
Laktat-Daten können als CSV-Datei im folgenden Format hochgeladen werden:
t_min,BLC_t
0.0,2.84
1.5,3.60
3.0,5.09
…
        &lt;/pre&gt;
      &lt;/div&gt;"
    )
  })
}

# App ausführen
shinyApp(ui = ui, server = server)</code></pre>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Modellanpassung - Details:
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>nlsLM - Fit:</strong></p>
<ul>
<li>Verwendete Funktion: nlsLM</li>
<li>Parameter: A1, A2, gamma1, gamma2, La0</li>
<li>Modell: BLC_t ~ La0 + A1 · (1 - exp(-gamma1 · t_min)) + A2 · (1 - exp(-gamma2 · t_min))</li>
<li>Grenzen:
<ul>
<li>A1: <em>0.0 bis 100.0 mmol/l</em></li>
<li>A2: <em>-100.0 bis 0.0 mmol/l</em></li>
<li>gamma1: <em>0.05 bis 2.0 min^-1</em></li>
<li>gamma2: <em>0.01 bis 0.5 min^-1</em></li>
<li>La0: <em>0.90 · BLC_t[1] bis 1.10 · BLC_t[1], begrenzt auf 0 bis 5 mmol/l</em></li>
</ul></li>
<li>Prozess:
<ol type="a">
<li>Bestimmung der La0-Grenzen:
<ul>
<li>Untere Grenze: <em>max(0, 0.90 · erster BLC-Wert)</em></li>
<li>Obere Grenze: <em>min(5, 1.10 · erster BLC-Wert)</em></li>
</ul></li>
<li>Iterative Optimierung (100 Durchläufe):
<ul>
<li>Zufällige Startwertebestimmung für jeden Durchlauf: · A1: Zufallswert zwischen 0 und 100 · A2: Zufallswert zwischen -100 und 0 · gamma1: Zufallswert zwischen 0.05 und 2.0 · gamma2: Zufallswert zwischen 0.01 und 0.5 · La0: Zufallswert zwischen der unteren und oberen La0-Grenze</li>
<li>Durchführung der nicht-linearen Regression: · Verwendung des Levenberg-Marquardt-Algorithmus · Maximale Iterationen: <em>1024</em></li>
<li>Berechnung der Residuenquadratsumme (RSS) für jede Anpassung</li>
<li>Speicherung der besten Anpassung (niedrigste RSS)</li>
</ul></li>
</ol></li>
<li>Optimierung: Minimierung der Residuenquadratsumme (RSS)</li>
</ul>
</div>
</div>
</div>
</section>
<section id="quellenverzeichnis" class="level2">
<h2 class="anchored" data-anchor-id="quellenverzeichnis">Quellenverzeichnis</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-Beneke2007" class="csl-entry" role="listitem">
Beneke, R., Jumah, M. D., &amp; Leithäuser, R. M. (2007). <span>Modelling the lactate response to short-term all out exercise</span>. <em>Dynamic Medicine</em>, <em>6</em>, 1–7. <a href="https://doi.org/10.1186/1476-5918-6-10">https://doi.org/10.1186/1476-5918-6-10</a>
</div>
<div id="ref-DiPrampero1981" class="csl-entry" role="listitem">
Di Prampero, P. E. (1981). <span>Energetics of Muscular Exercise</span>. <em>Review of physiology, biochemistry and pharmacology</em>, <em>89</em>, 143–222.
</div>
<div id="ref-Diamant1968" class="csl-entry" role="listitem">
Diamant, B., Karlsson, J., &amp; Saltin, B. (1968). <span>Muscle Tissue Lactate after Maximal Exercise in Man</span>. <em>Acta Physiologica Scandinavica</em>, <em>72</em>(3), 383–384. <a href="https://doi.org/10.1111/j.1365-201X.1968.tb10846.x">https://doi.org/10.1111/j.1365-201X.1968.tb10846.x</a>
</div>
<div id="ref-Freund1986" class="csl-entry" role="listitem">
Freund, H., Oyono-Enguelle, S., Heitz, A., Marbach, J., Ott, C., Zouloumian, P., &amp; Lampert, E. (1986). <span>Work rate-dependent lactate kinetics after exercise in humans.</span> <em>Journal of applied physiology (Bethesda, Md. : 1985)</em>, <em>61</em>(3), 932–939. <a href="https://doi.org/10.1152/jappl.1986.61.3.932">https://doi.org/10.1152/jappl.1986.61.3.932</a>
</div>
<div id="ref-Heck2022" class="csl-entry" role="listitem">
Heck, H., Bartmus, U., &amp; Grabow, V. (2022). <em><span>Laktat</span></em> (1. Aufl., S. 662). Springer Berlin Heidelberg.
</div>
<div id="ref-Mader1981" class="csl-entry" role="listitem">
Mader, A., Heck, H., &amp; Hollmann, W. (1981). <span>Leistung und Leistungsbegrenzung des menschlichen Organismus, interpretiert am Modell thermodynamisch offener Systeme. Ein Beitrag zur Diskussion biologischer Leistungsgrenzen im Hochleistungssport BT - Sport an der Grenze menschlicher Leistungsf<span>ä</span>higkeit</span>. In H. Rieckert (Hrsg.), <em>Angewandte Chemie International Edition, 6(11), 951–952.</em> (S. 69–93). Springer Berlin Heidelberg.
</div>
<div id="ref-Margaria1933" class="csl-entry" role="listitem">
Margaria, R., Edwards, H. T., &amp; Dill, D. B. (1933). <span>The possible mechanisms of contracting and paying the oxygen debt and the role of lactic acid in muscular contraction</span>. <em>American Journal of Physiology</em>, <em>106</em>, 689–715. <a href="https://api.semanticscholar.org/CorpusID:30044859">https://api.semanticscholar.org/CorpusID:30044859</a>
</div>
<div id="ref-Stegemann1991" class="csl-entry" role="listitem">
Stegemann, J. (1991). <em><span>Leistungsphysiologie</span></em> (4. Edition, S. 385). Georg Thieme Verlag.
</div>
<div id="ref-VanHall2010" class="csl-entry" role="listitem">
Van Hall, G. (2010). <span>Lactate kinetics in human tissues at rest and during exercise</span>. <em>Acta Physiologica</em>, <em>199</em>(4), 499–508. <a href="https://doi.org/10.1111/j.1748-1716.2010.02122.x">https://doi.org/10.1111/j.1748-1716.2010.02122.x</a>
</div>
</div>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/JJRW96\.github\.io\/Wirkungsgrad-Rad\.github\.io\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../Theoretischer_Hintergrund/Energieumsatzberechnung/Aerobe_Energiebereitstellung.html" class="pagination-link" aria-label="Aerobe Energiekomponente (W~Aerob~)">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Aerobe Energiekomponente (W<sub>Aerob</sub>)</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../Theoretischer_Hintergrund/Energieumsatzberechnung/Anaerobe_alaktazide_Energiebereitstellung.html" class="pagination-link" aria-label="Anaerobe- alaktazide Energiekomponente (W~PCr~)">
        <span class="nav-page-text">Anaerobe- alaktazide Energiekomponente (W<sub>PCr</sub>)</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Quellcode</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb5" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Anaerobe- laktazide Energiekomponente (W~BLC~)"</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">    resources: </span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">      - shinylive-sw.js</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">      </span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="an">filters:</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">  - shinylive</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co">  engine: knitr</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co">  echo: false</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co">  error: false</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="an">bibliography:</span><span class="co"> references.bib</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="an">lang:</span><span class="co"> de</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="an">number-sections:</span><span class="co"> false</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> </span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="co">  markdown: </span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="co">    wrap: 72</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a><span class="in">```{css}</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>#<span class="op">|</span> echo<span class="in">:</span> false</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>p {</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>  <span class="kw">text-align</span><span class="ch">:</span> <span class="dv">justify</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>caption<span class="op">,</span> <span class="fu">.figure-caption</span> {</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>  <span class="kw">text-align</span><span class="ch">:</span> <span class="dv">left</span><span class="op">;</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>figure<span class="fu">.quarto-float-tbl</span> figcaption {</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>  <span class="kw">text-align</span><span class="ch">:</span> <span class="dv">left</span> <span class="at">!important</span><span class="op">;</span></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>figure figcaption {</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>  <span class="kw">text-align</span><span class="ch">:</span> <span class="dv">justify</span><span class="op">;</span></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>library<span class="in">(</span>dplyr<span class="in">)</span></span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>library<span class="in">(</span>tidyr<span class="in">)</span></span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>library<span class="in">(</span>readxl<span class="in">)</span></span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>library<span class="in">(</span>ggplot2<span class="in">)</span></span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>library<span class="in">(</span>DT<span class="in">)</span></span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>library<span class="in">(</span>extrafont<span class="in">)</span></span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>## Kinetik der Blutlaktatkonzentration </span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>Bei intensiven körperlichen Belastungen übersteigt der Energiebedarf die oxidative Kapazität der Mitochondrien<span class="op">,</span> wodurch vermehrt ATP durch anaerobe Glykolyse bereitgestellt wird. Dieser Stoffwechselweg resultiert in einer verstärkten Bildung von Laktat in der beanspruchten Muskulatur. Das Laktat diffundiert aus dieser Muskulatur in die Zwischenzellräume und gelangt über die Venen zum rechten Herzen. Dort wird das Blut aus der Muskulatur mit dem Blut aus anderen Körperregionen vermischt und durch die Lunge zum linken Herzen gepumpt und in die Aorta ausgeworfen. Anschließend werden sämtliche Arterien<span class="op">,</span> einschließlich jener<span class="op">,</span> die die Regionen um die Blutentnahmestellen am Ohrläppchen versorgen<span class="op">,</span> von Blut mit gleicher Laktatkonzentration durchströmt. Das gebildete Laktat wird nach einer Rückumwandlung von Laktat in Pyruvat vornehmlich im belasteten Muskel selbst<span class="op">,</span> in geringerem Maße im Herzmuskel<span class="op">,</span> in den Nieren und im Gehirn eliminiert. Primär in der Leber wird Laktat über die Glukoneogenese via Pyruvat wieder zu Glukose und Glykogen <span class="in">(</span>Glukoneogenese<span class="in">)</span> aufgebaut. Die Laktateliminationsrate hängt von der Höhe des aeroben Umsatzes und der Laktatkonzentration ab<span class="op">,</span> wobei sie mit steigendem aerobem Stoffwechsel und höherer Laktatkonzentration zunimmt <span class="ex">[</span><span class="ss">@VanHall2010</span>; <span class="im">@Heck2022</span>,38,193,407].&lt;br&gt;</span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>Während einer intensiven Belastung steigt das Muskellaktat steil an und fällt nach Belastungsende annähernd exponentiell ab. Die Blutlaktatkonzentration hingegen erreicht erst nach Belastungsende ihr Maximum <span class="fu">(</span><span class="dv">BLC</span>~<span class="dv">max</span>~<span class="fu">)</span> [@Diamant1968<span class="op">;</span><span class="im">@Mader1981</span><span class="op">;</span> <span class="im">@Heck2022</span>, 193<span class="op">;</span> <span class="im">@Margaria1933</span><span class="op">;</span> <span class="im">@Beneke2007</span>]. BLC~max~ wird in Abhängigkeit von der Belastungsdauer und Intensität sowie der maximalen Laktatkonzentration erst nach bis zu 10-12 Minuten Erholungszeit erreicht, in Einzelfällen sogar erst nach 15-20 Minuten <span class="fu">(</span><span class="dv">siehe </span>@<span class="dv">fig-Laktat3</span><span class="fu">)</span>. Die Ursache hierfür ist der Konzentrationsgradient zwischen der Muskel- und Blutlaktatkonzentration. In @fig-Laktat und @fig-Laktat2 ist der Konzentrationsgradient zwischen Muskel- und Blutlaktatkonzentration gut zu erkennen. Diese charakteristische Laktatkinetik, insbesondere die Differenz zwischen dem Blutlaktatwert vor Belastungsbeginn <span class="fu">(</span><span class="dv">BLC</span>~<span class="dv">Pre</span>~<span class="fu">)</span> und BLC~max~, bildet die Grundlage für die quantitative Bestimmung des anaerob-laktaziden Energieanteils einer Belastung.</span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a>::: {layout="<span class="ex">[</span><span class="ss">[1</span><span class="op">,</span>1]<span class="op">,</span> <span class="ex">[</span><span class="ss">1</span><span class="ex">]</span>]"}</span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>!<span class="ex">[</span><span class="ss">Simulierte Verlaufskurve von Muskellaktat und Blutlaktat bei einer 2 minütigen Maximalbalastung [@Mader1981</span><span class="ex">]</span>]<span class="in">(</span>images/Laktat<span class="fu">.png</span><span class="in">)</span>{<span class="pp">#fig-Laktat</span> height="400"}</span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a>!<span class="ex">[</span><span class="ss">Verlaufskurve von Muskellaktat und Blutlaktat nach einer dreiminütigen Ausbelastung auf dem Fahrradergometer [@Diamant1968</span><span class="ex">]</span>]<span class="in">(</span>images/Nachbelastungslaktat_Diamant2<span class="fu">.png</span><span class="in">)</span>{<span class="pp">#fig-Laktat2</span> height="400"}</span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a>!<span class="ex">[</span><span class="ss">Nachbelastungslaktatwerte aus Ohrkapillarblut nach 300m und 600m Läufen mit unterschiedlicher Intensität [@Heck2022</span><span class="op">,</span> 193]]<span class="in">(</span>images/Nachbelastungslaktat_Heck<span class="fu">.png</span><span class="in">)</span>{<span class="pp">#fig-Laktat3</span> height="500" fig-align="left"}</span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a><span class="in">:::</span></span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a>## Berechnung der W<span class="op">~</span>BLC<span class="op">~</span></span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a>Die Berechnung des anaerob-laktaziden Energieanteils <span class="in">(</span>W<span class="op">~</span>BLC<span class="op">~</span><span class="in">)</span> erfolgt aus dem Blutlaktatwert direkt vor Beginn der Belastung <span class="in">(</span>BLC<span class="op">~</span>Pre<span class="op">~</span><span class="in">)</span> und dem maximalen Laktatwert nach der Belastung <span class="in">(</span>BLC<span class="op">~</span>max<span class="op">~</span><span class="in">)</span>. Die Differenz von BLC<span class="op">~</span>max<span class="op">~</span> und BLC<span class="op">~</span>Pre<span class="op">~</span> ergibt den Nettoblutlaktatwert <span class="in">(</span>BLC<span class="op">~</span>Netto<span class="op">~</span><span class="in">)</span><span class="op">,</span> der die größte Schwankung zwischen BLC<span class="op">~</span>Pre<span class="op">~</span> und BLC<span class="op">~</span>max<span class="op">~</span> darstellt. Durch Multiplikation von BLC<span class="op">~</span>Netto<span class="op">~</span> mit einem Sauerstoff-Laktat-Äquivalent von 3<span class="fu">.0</span> <span class="ex">[</span><span class="ss">ml O</span><span class="op">~</span><span class="ss">2</span><span class="op">~</span><span class="ss">·kg</span><span class="op">^</span><span class="ss">-1</span><span class="op">^</span><span class="ss">·mmol</span><span class="op">^</span><span class="ss">-1</span><span class="op">^</span><span class="ex">]</span> <span class="ex">[</span><span class="ss">@DiPrampero1981</span><span class="ex">]</span> und dem kÄ für Kohlenhydrate <span class="in">(</span>kÄ<span class="op">~</span>KH<span class="op">~</span><span class="in">)</span> bei einem RQ von 1<span class="fu">.0</span> von 21<span class="fu">.131</span> kJ pro Liter O<span class="op">~</span>2<span class="op">~</span> kann der anaerob-laktazide Energieanteil der Belastung in Joule ermittelt werden <span class="ex">[</span><span class="ss">@Stegemann1991</span><span class="op">,</span> 59]<span class="in">:</span></span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a>W_{BLC} = BLC_{Netto} \, <span class="ex">[</span><span class="ss">\text</span>{mmol} \cdot \text{l}^{-1}] \cdot 3<span class="fu">.0</span> \, <span class="ex">[</span><span class="ss">\text</span>{ml O}_2 \cdot \text{kg}^{-1} \cdot \text{mmol}^{-1}] \cdot \text{Körpermasse} \, <span class="ex">[</span><span class="ss">\text</span>{kg}] \cdot kÄ_{\text{KH}} \, <span class="ex">[</span><span class="ss">\text</span>{kJ} \cdot \text{l}^{-1} \,\text{O}_2]</span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a>Die mittlere anaerob-laktazide Leistung <span class="in">(</span>$\overline<span class="er">{</span>P}_{BLC}$) kann dann durch Division des W<span class="op">~</span>BLC<span class="op">~</span>-Wertes in kJ durch die Belastungsdauer t in Sekunden berechnet werden<span class="in">:</span></span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb5-80"><a href="#cb5-80" aria-hidden="true" tabindex="-1"></a>\overline{P}_{BLC}\;<span class="ex">[</span><span class="ss">W</span><span class="ex">]</span> = \frac{W_{BLC}}{t} \cdot 1000</span>
<span id="cb5-81"><a href="#cb5-81" aria-hidden="true" tabindex="-1"></a>$$ {<span class="pp">#eq-PBLC</span>}</span>
<span id="cb5-82"><a href="#cb5-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-85"><a href="#cb5-85" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb5-86"><a href="#cb5-86" aria-hidden="true" tabindex="-1"></a># 3<span class="fu">.0</span> Wert nur Mittelwert mit potentiellen Schwankungen -<span class="op">&gt;</span> weiter ausführen</span>
<span id="cb5-87"><a href="#cb5-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-88"><a href="#cb5-88" aria-hidden="true" tabindex="-1"></a># Brooks2004 ab Seite 222 - Laktat nach der Belastung</span>
<span id="cb5-89"><a href="#cb5-89" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb5-90"><a href="#cb5-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-91"><a href="#cb5-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-92"><a href="#cb5-92" aria-hidden="true" tabindex="-1"></a>## Interaktive Modelle zur Laktatkinetik bei körperlicher Belastung</span>
<span id="cb5-93"><a href="#cb5-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-94"><a href="#cb5-94" aria-hidden="true" tabindex="-1"></a>Die nachfolgenden interaktiven Shiny-Apps dienen der Veranschaulichung verschiedener Laktatreaktionen des Körpers unter Belastung. Sie illustrieren sowohl die Beziehung zwischen Belastungsintensität und Blutlaktatkonzentration als auch den charakteristischen Verlauf der Laktatwerte während und nach definierten Belastungen. Die Apps ermöglichen durch Anpassung der Belastungsparameter ein besseres Verständnis der physiologischen Zusammenhänge. Die jeweiligen Modellparameter werden im Anschluss an jede Shiny-App ausführlich erläutert.</span>
<span id="cb5-95"><a href="#cb5-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-96"><a href="#cb5-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-97"><a href="#cb5-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-98"><a href="#cb5-98" aria-hidden="true" tabindex="-1"></a>## Laktat-Leistungs-Beziehung</span>
<span id="cb5-99"><a href="#cb5-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-100"><a href="#cb5-100" aria-hidden="true" tabindex="-1"></a>In der folgenden Anwendung wird die charakteristische Laktat-Leistungs-Beziehung während ansteigender Belastung visualisiert. Der Verlauf zeigt zunächst einen leichten Anstieg der Blutlaktatkonzentration bei zunehmender Belastungsintensität<span class="op">,</span> welche hier durch die externe Leistung beim Radfahren in Watt ausgedrückt wird. Ab einem bestimmten Belastungspunkt steigt die Laktatkonzentration überproportional an. Dies resultiert in einem exponentiellen Anstieg der Laktat-Leistungs-Kurve. Diese Beziehung verdeutlicht das Verhältnis zwischen der Änderung der Laktatkonzentration <span class="in">(</span>ΔLaktat<span class="in">)</span> und der Änderung der Belastungsintensität <span class="in">(</span>ΔLeistung<span class="in">)</span>.</span>
<span id="cb5-101"><a href="#cb5-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-102"><a href="#cb5-102" aria-hidden="true" tabindex="-1"></a>```{shinylive-r}</span>
<span id="cb5-103"><a href="#cb5-103" aria-hidden="true" tabindex="-1"></a>#<span class="op">|</span> standalone<span class="in">:</span> true</span>
<span id="cb5-104"><a href="#cb5-104" aria-hidden="true" tabindex="-1"></a>#<span class="op">|</span> viewerHeight<span class="in">:</span> 900</span>
<span id="cb5-105"><a href="#cb5-105" aria-hidden="true" tabindex="-1"></a>library<span class="in">(</span>shiny<span class="in">)</span></span>
<span id="cb5-106"><a href="#cb5-106" aria-hidden="true" tabindex="-1"></a>library<span class="in">(</span>plotly<span class="in">)</span></span>
<span id="cb5-107"><a href="#cb5-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-108"><a href="#cb5-108" aria-hidden="true" tabindex="-1"></a># UI bleibt unverändert</span>
<span id="cb5-109"><a href="#cb5-109" aria-hidden="true" tabindex="-1"></a>ui &lt;- fluidPage<span class="in">(</span></span>
<span id="cb5-110"><a href="#cb5-110" aria-hidden="true" tabindex="-1"></a>  titlePanel<span class="in">(</span>"Laktat-Leistungs-Modell"<span class="in">)</span><span class="op">,</span></span>
<span id="cb5-111"><a href="#cb5-111" aria-hidden="true" tabindex="-1"></a>  sidebarLayout<span class="in">(</span></span>
<span id="cb5-112"><a href="#cb5-112" aria-hidden="true" tabindex="-1"></a>    sidebarPanel<span class="in">(</span></span>
<span id="cb5-113"><a href="#cb5-113" aria-hidden="true" tabindex="-1"></a>      numericInput<span class="in">(</span>"num_rows"<span class="op">,</span> "Anzahl der Datenpunkte"<span class="op">,</span> 4<span class="op">,</span> min = 1<span class="op">,</span> max = 20<span class="in">)</span><span class="op">,</span></span>
<span id="cb5-114"><a href="#cb5-114" aria-hidden="true" tabindex="-1"></a>      uiOutput<span class="in">(</span>"input_fields"<span class="in">)</span><span class="op">,</span></span>
<span id="cb5-115"><a href="#cb5-115" aria-hidden="true" tabindex="-1"></a>      width = 2  </span>
<span id="cb5-116"><a href="#cb5-116" aria-hidden="true" tabindex="-1"></a>    <span class="in">)</span><span class="op">,</span></span>
<span id="cb5-117"><a href="#cb5-117" aria-hidden="true" tabindex="-1"></a>    mainPanel<span class="in">(</span></span>
<span id="cb5-118"><a href="#cb5-118" aria-hidden="true" tabindex="-1"></a>      width = 9<span class="op">,</span></span>
<span id="cb5-119"><a href="#cb5-119" aria-hidden="true" tabindex="-1"></a>      plotlyOutput<span class="in">(</span>"plot"<span class="in">)</span><span class="op">,</span></span>
<span id="cb5-120"><a href="#cb5-120" aria-hidden="true" tabindex="-1"></a>      uiOutput<span class="in">(</span>"instructions"<span class="in">)</span></span>
<span id="cb5-121"><a href="#cb5-121" aria-hidden="true" tabindex="-1"></a>    <span class="in">)</span></span>
<span id="cb5-122"><a href="#cb5-122" aria-hidden="true" tabindex="-1"></a>  <span class="in">)</span></span>
<span id="cb5-123"><a href="#cb5-123" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb5-124"><a href="#cb5-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-125"><a href="#cb5-125" aria-hidden="true" tabindex="-1"></a># Server mit angepasstem Plot-Bereich</span>
<span id="cb5-126"><a href="#cb5-126" aria-hidden="true" tabindex="-1"></a>server &lt;- function<span class="in">(</span>input<span class="op">,</span> output<span class="op">,</span> session<span class="in">)</span> {</span>
<span id="cb5-127"><a href="#cb5-127" aria-hidden="true" tabindex="-1"></a>  initial_values &lt;- list(</span>
<span id="cb5-128"><a href="#cb5-128" aria-hidden="true" tabindex="-1"></a>    list(Leistung = 100<span class="op">,</span> DeltaBLC = 0<span class="fu">.3</span>)<span class="op">,</span></span>
<span id="cb5-129"><a href="#cb5-129" aria-hidden="true" tabindex="-1"></a>    list<span class="in">(</span>Leistung = 200<span class="op">,</span> DeltaBLC = 1<span class="fu">.0</span><span class="in">)</span><span class="op">,</span></span>
<span id="cb5-130"><a href="#cb5-130" aria-hidden="true" tabindex="-1"></a>    list<span class="in">(</span>Leistung = 300<span class="op">,</span> DeltaBLC = 2<span class="fu">.8</span><span class="in">)</span><span class="op">,</span></span>
<span id="cb5-131"><a href="#cb5-131" aria-hidden="true" tabindex="-1"></a>    list<span class="in">(</span>Leistung = 400<span class="op">,</span> DeltaBLC = 8<span class="fu">.0</span><span class="in">)</span></span>
<span id="cb5-132"><a href="#cb5-132" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-133"><a href="#cb5-133" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-134"><a href="#cb5-134" aria-hidden="true" tabindex="-1"></a>  output$input_fields &lt;- renderUI<span class="in">(</span><span class="er">{</span></span>
<span id="cb5-135"><a href="#cb5-135" aria-hidden="true" tabindex="-1"></a>    num_rows &lt;- input$num_rows</span>
<span id="cb5-136"><a href="#cb5-136" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-137"><a href="#cb5-137" aria-hidden="true" tabindex="-1"></a>    lapply(1<span class="ch">:</span><span class="dv">num_rows</span><span class="op">,</span> function<span class="fu">(</span><span class="dv">i</span><span class="fu">)</span> {</span>
<span id="cb5-138"><a href="#cb5-138" aria-hidden="true" tabindex="-1"></a>      <span class="dv">initial_value </span>&lt;<span class="dv">- if </span><span class="fu">(</span><span class="dv">i </span>&lt;= length<span class="fu">(</span><span class="dv">initial_values</span><span class="fu">))</span> <span class="dv">initial_values</span>[[<span class="dv">i</span>]] <span class="dv">else </span>list<span class="fu">(</span><span class="dv">Leistung </span>= <span class="dv">0</span><span class="op">,</span> <span class="dv">DeltaBLC </span>= <span class="dv">0</span><span class="fu">)</span></span>
<span id="cb5-139"><a href="#cb5-139" aria-hidden="true" tabindex="-1"></a>      tagList<span class="fu">(</span></span>
<span id="cb5-140"><a href="#cb5-140" aria-hidden="true" tabindex="-1"></a>        numericInput<span class="fu">(</span>paste0<span class="fu">(</span><span class="st">"leistung_"</span><span class="op">,</span> <span class="dv">i</span><span class="fu">)</span><span class="op">,</span> paste<span class="fu">(</span><span class="st">"ΔLeistung"</span><span class="op">,</span> <span class="dv">i</span><span class="fu">)</span><span class="op">,</span> <span class="dv">value </span>= <span class="dv">initial_value</span>$<span class="dv">Leistung</span><span class="op">,</span> <span class="dv">step </span>= <span class="dv">10</span><span class="fu">)</span><span class="op">,</span></span>
<span id="cb5-141"><a href="#cb5-141" aria-hidden="true" tabindex="-1"></a>        numericInput<span class="fu">(</span>paste0<span class="fu">(</span><span class="st">"deltaBLC_"</span><span class="op">,</span> <span class="dv">i</span><span class="fu">)</span><span class="op">,</span> paste<span class="fu">(</span><span class="st">"ΔBLC"</span><span class="op">,</span> <span class="dv">i</span><span class="fu">)</span><span class="op">,</span> <span class="dv">value </span>= <span class="dv">initial_value</span>$<span class="dv">DeltaBLC</span><span class="op">,</span> <span class="dv">step </span>= <span class="dv">0.1</span><span class="fu">)</span></span>
<span id="cb5-142"><a href="#cb5-142" aria-hidden="true" tabindex="-1"></a>      <span class="fu">)</span></span>
<span id="cb5-143"><a href="#cb5-143" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb5-144"><a href="#cb5-144" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb5-145"><a href="#cb5-145" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-146"><a href="#cb5-146" aria-hidden="true" tabindex="-1"></a>  input_data &lt;- reactive<span class="in">(</span><span class="er">{</span></span>
<span id="cb5-147"><a href="#cb5-147" aria-hidden="true" tabindex="-1"></a>    num_rows &lt;- input$num_rows</span>
<span id="cb5-148"><a href="#cb5-148" aria-hidden="true" tabindex="-1"></a>    if (is<span class="fu">.null</span><span class="in">(</span>num_rows<span class="in">)</span>) return<span class="in">(</span>NULL<span class="in">)</span></span>
<span id="cb5-149"><a href="#cb5-149" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-150"><a href="#cb5-150" aria-hidden="true" tabindex="-1"></a>    data &lt;- data<span class="fu">.frame</span><span class="in">(</span>Leistung = numeric<span class="in">(</span>num_rows<span class="in">)</span><span class="op">,</span> ΔBLC = numeric<span class="in">(</span>num_rows<span class="in">))</span></span>
<span id="cb5-151"><a href="#cb5-151" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-152"><a href="#cb5-152" aria-hidden="true" tabindex="-1"></a>    for <span class="in">(</span>i in 1<span class="in">:num</span>_rows<span class="in">)</span> {</span>
<span id="cb5-153"><a href="#cb5-153" aria-hidden="true" tabindex="-1"></a>      leistung_val &lt;- input<span class="ex">[</span><span class="ss">[paste0(</span><span class="st">"leistung_"</span><span class="op">,</span> i)]]</span>
<span id="cb5-154"><a href="#cb5-154" aria-hidden="true" tabindex="-1"></a>      deltaBLC_val &lt;- input<span class="ex">[</span><span class="ss">[paste0(</span><span class="st">"deltaBLC_"</span><span class="op">,</span> i)]]</span>
<span id="cb5-155"><a href="#cb5-155" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-156"><a href="#cb5-156" aria-hidden="true" tabindex="-1"></a>      if <span class="in">(</span>is<span class="fu">.null</span><span class="in">(</span>leistung_val<span class="in">)</span> <span class="op">||</span> is<span class="fu">.null</span><span class="in">(</span>deltaBLC_val<span class="in">))</span> {</span>
<span id="cb5-157"><a href="#cb5-157" aria-hidden="true" tabindex="-1"></a>        data$Leistung<span class="ex">[</span><span class="ss">i</span><span class="ex">]</span> &lt;- if <span class="in">(</span>i &lt;= length<span class="in">(</span>initial_values<span class="in">))</span> initial_values<span class="ex">[</span><span class="ss">[i</span><span class="ex">]</span>]$Leistung else 0</span>
<span id="cb5-158"><a href="#cb5-158" aria-hidden="true" tabindex="-1"></a>        data$ΔBLC<span class="ex">[</span><span class="ss">i</span><span class="ex">]</span> &lt;- if <span class="in">(</span>i &lt;= length<span class="in">(</span>initial_values<span class="in">))</span> initial_values<span class="ex">[</span><span class="ss">[i</span><span class="ex">]</span>]$DeltaBLC else 0</span>
<span id="cb5-159"><a href="#cb5-159" aria-hidden="true" tabindex="-1"></a>      } else {</span>
<span id="cb5-160"><a href="#cb5-160" aria-hidden="true" tabindex="-1"></a>        data$Leistung<span class="ex">[</span><span class="ss">i</span><span class="ex">]</span> &lt;- leistung_val</span>
<span id="cb5-161"><a href="#cb5-161" aria-hidden="true" tabindex="-1"></a>        data$ΔBLC<span class="ex">[</span><span class="ss">i</span><span class="ex">]</span> &lt;- deltaBLC_val</span>
<span id="cb5-162"><a href="#cb5-162" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb5-163"><a href="#cb5-163" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-164"><a href="#cb5-164" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-165"><a href="#cb5-165" aria-hidden="true" tabindex="-1"></a>    data</span>
<span id="cb5-166"><a href="#cb5-166" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb5-167"><a href="#cb5-167" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-168"><a href="#cb5-168" aria-hidden="true" tabindex="-1"></a>  observe<span class="in">(</span><span class="er">{</span></span>
<span id="cb5-169"><a href="#cb5-169" aria-hidden="true" tabindex="-1"></a>    for (i in 1<span class="ch">:</span>length<span class="fu">(</span><span class="dv">initial_values</span><span class="fu">)</span>) {</span>
<span id="cb5-170"><a href="#cb5-170" aria-hidden="true" tabindex="-1"></a>      updateNumericInput<span class="fu">(</span><span class="dv">session</span><span class="op">,</span> paste0<span class="fu">(</span><span class="st">"leistung_"</span><span class="op">,</span> <span class="dv">i</span><span class="fu">)</span><span class="op">,</span> <span class="dv">value </span>= <span class="dv">initial_values</span>[[<span class="dv">i</span>]]$<span class="dv">Leistung</span><span class="fu">)</span></span>
<span id="cb5-171"><a href="#cb5-171" aria-hidden="true" tabindex="-1"></a>      updateNumericInput<span class="fu">(</span><span class="dv">session</span><span class="op">,</span> paste0<span class="fu">(</span><span class="st">"deltaBLC_"</span><span class="op">,</span> <span class="dv">i</span><span class="fu">)</span><span class="op">,</span> <span class="dv">value </span>= <span class="dv">initial_values</span>[[<span class="dv">i</span>]]$<span class="dv">DeltaBLC</span><span class="fu">)</span></span>
<span id="cb5-172"><a href="#cb5-172" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-173"><a href="#cb5-173" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb5-174"><a href="#cb5-174" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-175"><a href="#cb5-175" aria-hidden="true" tabindex="-1"></a>  output$plot &lt;- renderPlotly<span class="in">(</span><span class="er">{</span></span>
<span id="cb5-176"><a href="#cb5-176" aria-hidden="true" tabindex="-1"></a>    df_proband &lt;- input_data()</span>
<span id="cb5-177"><a href="#cb5-177" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-178"><a href="#cb5-178" aria-hidden="true" tabindex="-1"></a>    if (is<span class="fu">.null</span><span class="in">(</span>df_proband<span class="in">)</span>) return<span class="in">(</span>NULL<span class="in">)</span></span>
<span id="cb5-179"><a href="#cb5-179" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-180"><a href="#cb5-180" aria-hidden="true" tabindex="-1"></a>    model &lt;- nls<span class="in">(</span>ΔBLC <span class="op">~</span> a <span class="op">*</span> exp<span class="in">(</span>b <span class="op">*</span> Leistung<span class="in">)</span><span class="op">,</span> data = df_proband<span class="op">,</span> start = list<span class="in">(</span>a = 1<span class="op">,</span> b = 0<span class="fu">.01</span><span class="in">))</span></span>
<span id="cb5-181"><a href="#cb5-181" aria-hidden="true" tabindex="-1"></a>    coef_exponential_model &lt;- coef<span class="in">(</span>model<span class="in">)</span></span>
<span id="cb5-182"><a href="#cb5-182" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-183"><a href="#cb5-183" aria-hidden="true" tabindex="-1"></a>    # Erweiterte x-Sequenz von 0 bis max <span class="op">*</span> 1<span class="fu">.25</span></span>
<span id="cb5-184"><a href="#cb5-184" aria-hidden="true" tabindex="-1"></a>    x_max &lt;- max<span class="in">(</span>df_proband$Leistung<span class="in">)</span> <span class="op">*</span> 1<span class="fu">.25</span></span>
<span id="cb5-185"><a href="#cb5-185" aria-hidden="true" tabindex="-1"></a>    x_seq &lt;- seq<span class="in">(</span>0<span class="op">,</span> x_max<span class="op">,</span> length<span class="fu">.out</span> = 100<span class="in">)</span></span>
<span id="cb5-186"><a href="#cb5-186" aria-hidden="true" tabindex="-1"></a>    y_pred &lt;- predict<span class="in">(</span>model<span class="op">,</span> newdata = data<span class="fu">.frame</span><span class="in">(</span>Leistung = x_seq<span class="in">))</span></span>
<span id="cb5-187"><a href="#cb5-187" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-188"><a href="#cb5-188" aria-hidden="true" tabindex="-1"></a>    plot_ly<span class="in">()</span> %<span class="op">&gt;</span>%</span>
<span id="cb5-189"><a href="#cb5-189" aria-hidden="true" tabindex="-1"></a>      add_trace<span class="in">(</span>data = df_proband<span class="op">,</span> x = <span class="op">~</span>Leistung<span class="op">,</span> y = <span class="op">~</span>ΔBLC<span class="op">,</span> type = 'scatter'<span class="op">,</span> mode = 'markers'<span class="op">,</span></span>
<span id="cb5-190"><a href="#cb5-190" aria-hidden="true" tabindex="-1"></a>                name = "ΔBLC"<span class="op">,</span></span>
<span id="cb5-191"><a href="#cb5-191" aria-hidden="true" tabindex="-1"></a>                marker = list<span class="in">(</span>color = "<span class="pp">#2683C6</span>"<span class="op">,</span> size = 7<span class="fu">.0</span><span class="in">))</span> %<span class="op">&gt;</span>%</span>
<span id="cb5-192"><a href="#cb5-192" aria-hidden="true" tabindex="-1"></a>      add_trace<span class="in">(</span>x = x_seq<span class="op">,</span> y = y_pred<span class="op">,</span> type = 'scatter'<span class="op">,</span> mode = 'lines'<span class="op">,</span> </span>
<span id="cb5-193"><a href="#cb5-193" aria-hidden="true" tabindex="-1"></a>                name = 'Laktat-Modellfunktion'<span class="op">,</span> </span>
<span id="cb5-194"><a href="#cb5-194" aria-hidden="true" tabindex="-1"></a>                line = list<span class="in">(</span>color = '<span class="pp">#62A39F</span>'<span class="op">,</span> width = 3<span class="in">))</span> %<span class="op">&gt;</span>%</span>
<span id="cb5-195"><a href="#cb5-195" aria-hidden="true" tabindex="-1"></a>      add_annotations<span class="in">(</span>text = sprintf<span class="in">(</span>"ΔBLC <span class="in">(</span>ΔLeistung<span class="in">)</span> = %<span class="fu">.5f</span> \u00B7 e&lt;sup<span class="op">&gt;</span>%<span class="fu">.5f</span> \u00B7 ΔLeistung&lt;/sup<span class="op">&gt;</span>"<span class="op">,</span> </span>
<span id="cb5-196"><a href="#cb5-196" aria-hidden="true" tabindex="-1"></a>                                     coef_exponential_model<span class="ex">[</span><span class="st">'a'</span><span class="ex">]</span><span class="op">,</span> coef_exponential_model<span class="ex">[</span><span class="st">'b'</span><span class="ex">]</span><span class="in">)</span><span class="op">,</span></span>
<span id="cb5-197"><a href="#cb5-197" aria-hidden="true" tabindex="-1"></a>                      x = x_max <span class="op">*</span> 0<span class="fu">.02</span><span class="op">,</span></span>
<span id="cb5-198"><a href="#cb5-198" aria-hidden="true" tabindex="-1"></a>                      y = max<span class="in">(</span>y_pred<span class="in">)</span> <span class="op">*</span> 0<span class="fu">.90</span><span class="op">,</span></span>
<span id="cb5-199"><a href="#cb5-199" aria-hidden="true" tabindex="-1"></a>                      showarrow = FALSE<span class="op">,</span></span>
<span id="cb5-200"><a href="#cb5-200" aria-hidden="true" tabindex="-1"></a>                      xanchor = 'left'<span class="op">,</span> </span>
<span id="cb5-201"><a href="#cb5-201" aria-hidden="true" tabindex="-1"></a>                      yanchor = 'top'<span class="op">,</span></span>
<span id="cb5-202"><a href="#cb5-202" aria-hidden="true" tabindex="-1"></a>                      font = list<span class="in">(</span>family = "Arial<span class="op">,</span> sans-serif"<span class="op">,</span> size = 12<span class="op">,</span> color = "black"<span class="in">))</span> %<span class="op">&gt;</span>%</span>
<span id="cb5-203"><a href="#cb5-203" aria-hidden="true" tabindex="-1"></a>      layout<span class="in">(</span></span>
<span id="cb5-204"><a href="#cb5-204" aria-hidden="true" tabindex="-1"></a>        title = "Laktat-Leistungs-Modell"<span class="op">,</span></span>
<span id="cb5-205"><a href="#cb5-205" aria-hidden="true" tabindex="-1"></a>        margin = list<span class="in">(</span>t = 40<span class="in">)</span><span class="op">,</span></span>
<span id="cb5-206"><a href="#cb5-206" aria-hidden="true" tabindex="-1"></a>        xaxis = list<span class="in">(</span></span>
<span id="cb5-207"><a href="#cb5-207" aria-hidden="true" tabindex="-1"></a>          title = "ΔLeistung <span class="ex">[</span><span class="ss">Watt</span><span class="ex">]</span>"<span class="op">,</span></span>
<span id="cb5-208"><a href="#cb5-208" aria-hidden="true" tabindex="-1"></a>          range = c<span class="in">(</span>0<span class="op">,</span> x_max<span class="in">)</span>  # x-Achse von 0 bis max <span class="op">*</span> 1<span class="fu">.25</span></span>
<span id="cb5-209"><a href="#cb5-209" aria-hidden="true" tabindex="-1"></a>        <span class="in">)</span><span class="op">,</span></span>
<span id="cb5-210"><a href="#cb5-210" aria-hidden="true" tabindex="-1"></a>        yaxis = list<span class="in">(</span></span>
<span id="cb5-211"><a href="#cb5-211" aria-hidden="true" tabindex="-1"></a>          title = "ΔBLC <span class="ex">[</span><span class="ss">mmol \u00B7 l&lt;sup</span><span class="op">&gt;</span>-1&lt;/sup<span class="op">&gt;</span>]"<span class="op">,</span></span>
<span id="cb5-212"><a href="#cb5-212" aria-hidden="true" tabindex="-1"></a>          range = c<span class="in">(</span>0<span class="op">,</span> max<span class="in">(</span>y_pred<span class="in">)</span> <span class="op">*</span> 1<span class="fu">.1</span><span class="in">)</span></span>
<span id="cb5-213"><a href="#cb5-213" aria-hidden="true" tabindex="-1"></a>        <span class="in">)</span><span class="op">,</span></span>
<span id="cb5-214"><a href="#cb5-214" aria-hidden="true" tabindex="-1"></a>        legend = list<span class="in">(</span></span>
<span id="cb5-215"><a href="#cb5-215" aria-hidden="true" tabindex="-1"></a>          x = 0<span class="fu">.01</span><span class="op">,</span></span>
<span id="cb5-216"><a href="#cb5-216" aria-hidden="true" tabindex="-1"></a>          y = 0<span class="fu">.99</span><span class="op">,</span></span>
<span id="cb5-217"><a href="#cb5-217" aria-hidden="true" tabindex="-1"></a>          xanchor = "left"<span class="op">,</span></span>
<span id="cb5-218"><a href="#cb5-218" aria-hidden="true" tabindex="-1"></a>          yanchor = "top"<span class="op">,</span></span>
<span id="cb5-219"><a href="#cb5-219" aria-hidden="true" tabindex="-1"></a>          bgcolor = "rgba<span class="in">(</span>255<span class="op">,</span> 255<span class="op">,</span> 255<span class="op">,</span> 0<span class="fu">.8</span><span class="in">)</span>"<span class="op">,</span></span>
<span id="cb5-220"><a href="#cb5-220" aria-hidden="true" tabindex="-1"></a>          bordercolor = "rgba<span class="in">(</span>0<span class="op">,</span>0<span class="op">,</span>0<span class="op">,</span>0<span class="in">)</span>"<span class="op">,</span></span>
<span id="cb5-221"><a href="#cb5-221" aria-hidden="true" tabindex="-1"></a>          borderwidth = 0</span>
<span id="cb5-222"><a href="#cb5-222" aria-hidden="true" tabindex="-1"></a>        <span class="in">)</span></span>
<span id="cb5-223"><a href="#cb5-223" aria-hidden="true" tabindex="-1"></a>      <span class="in">)</span></span>
<span id="cb5-224"><a href="#cb5-224" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb5-225"><a href="#cb5-225" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-226"><a href="#cb5-226" aria-hidden="true" tabindex="-1"></a>  output$instructions &lt;- renderUI<span class="in">(</span><span class="er">{</span></span>
<span id="cb5-227"><a href="#cb5-227" aria-hidden="true" tabindex="-1"></a>    HTML(</span>
<span id="cb5-228"><a href="#cb5-228" aria-hidden="true" tabindex="-1"></a>      "&lt;div style='margin-top<span class="ch">:</span> <span class="dv">20</span><span class="dt">px</span><span class="op">;</span> <span class="kw">padding</span><span class="ch">:</span> <span class="dv">10</span><span class="dt">px</span><span class="op">;</span> <span class="kw">background-color</span><span class="ch">:</span> <span class="cn">#f0f0f0</span><span class="op">;</span> <span class="kw">border</span><span class="ch">:</span> <span class="dv">1</span><span class="dt">px</span> <span class="dv">solid</span> <span class="cn">#ddd</span><span class="op">;</span> <span class="kw">border-radius</span><span class="ch">:</span> <span class="dv">5</span><span class="dt">px</span><span class="op">;</span> <span class="kw">width</span><span class="ch">:</span> <span class="dv">fit-content</span><span class="op">;</span>'<span class="op">&gt;</span></span>
<span id="cb5-229"><a href="#cb5-229" aria-hidden="true" tabindex="-1"></a>        &lt;h4 style='color<span class="in">:</span> <span class="pp">#333</span>;'<span class="op">&gt;</span>&lt;strong<span class="op">&gt;</span>Anleitung - Modellanpassung<span class="in">:</span>&lt;/strong<span class="op">&gt;</span>&lt;/h4<span class="op">&gt;</span></span>
<span id="cb5-230"><a href="#cb5-230" aria-hidden="true" tabindex="-1"></a>        &lt;ol style='color<span class="in">:</span> <span class="pp">#555</span>; list-style-position<span class="in">:</span> outside; padding-left<span class="in">:</span> 20px;'<span class="op">&gt;</span></span>
<span id="cb5-231"><a href="#cb5-231" aria-hidden="true" tabindex="-1"></a>          &lt;li<span class="op">&gt;</span>Anzahl der Datenpunkte bestimmen.&lt;/li<span class="op">&gt;</span></span>
<span id="cb5-232"><a href="#cb5-232" aria-hidden="true" tabindex="-1"></a>          &lt;li<span class="op">&gt;</span>Für jeden Datenpunkt die Leistung <span class="in">(</span>in Watt<span class="in">)</span> und den entsprechenden ΔBLC-Wert eingeben.&lt;/li<span class="op">&gt;</span></span>
<span id="cb5-233"><a href="#cb5-233" aria-hidden="true" tabindex="-1"></a>          &lt;li<span class="op">&gt;</span>Das exponentielle Modell wird automatisch an die eingegebenen Daten angepasst.&lt;/li<span class="op">&gt;</span></span>
<span id="cb5-234"><a href="#cb5-234" aria-hidden="true" tabindex="-1"></a>        &lt;/ol<span class="op">&gt;</span></span>
<span id="cb5-235"><a href="#cb5-235" aria-hidden="true" tabindex="-1"></a>      &lt;/div<span class="op">&gt;</span>"</span>
<span id="cb5-236"><a href="#cb5-236" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-237"><a href="#cb5-237" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb5-238"><a href="#cb5-238" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-239"><a href="#cb5-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-240"><a href="#cb5-240" aria-hidden="true" tabindex="-1"></a>shinyApp<span class="in">(</span>ui = ui<span class="op">,</span> server = server<span class="in">)</span></span>
<span id="cb5-241"><a href="#cb5-241" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb5-242"><a href="#cb5-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-243"><a href="#cb5-243" aria-hidden="true" tabindex="-1"></a><span class="in">:::</span> {<span class="fu">.callout-note</span> icon=false collapse=true appearance="simple"}</span>
<span id="cb5-244"><a href="#cb5-244" aria-hidden="true" tabindex="-1"></a>#### Modellanpassung - Details<span class="in">:</span> {<span class="fu">.unlisted</span>}</span>
<span id="cb5-245"><a href="#cb5-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-246"><a href="#cb5-246" aria-hidden="true" tabindex="-1"></a><span class="op">**</span>1. Optimierung <span class="in">(</span>nls - Fit<span class="in">):</span><span class="op">**</span></span>
<span id="cb5-247"><a href="#cb5-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-248"><a href="#cb5-248" aria-hidden="true" tabindex="-1"></a>- Verwendete Funktion<span class="in">:</span> nls <span class="in">(</span>Non-Linear Least Squares<span class="in">)</span></span>
<span id="cb5-249"><a href="#cb5-249" aria-hidden="true" tabindex="-1"></a>- Parameter<span class="in">:</span> a<span class="op">,</span> b</span>
<span id="cb5-250"><a href="#cb5-250" aria-hidden="true" tabindex="-1"></a>- Modell<span class="in">:</span> ΔBLC <span class="op">~</span> a · exp<span class="in">(</span>b · Leistung<span class="in">)</span></span>
<span id="cb5-251"><a href="#cb5-251" aria-hidden="true" tabindex="-1"></a>- Prozess<span class="in">:</span></span>
<span id="cb5-252"><a href="#cb5-252" aria-hidden="true" tabindex="-1"></a>  a) Datenaufbereitung<span class="in">:</span></span>
<span id="cb5-253"><a href="#cb5-253" aria-hidden="true" tabindex="-1"></a>     - Erstellung eines reaktiven Dataframes basierend auf den Benutzereingaben</span>
<span id="cb5-254"><a href="#cb5-254" aria-hidden="true" tabindex="-1"></a>  b) Modellierung<span class="in">:</span></span>
<span id="cb5-255"><a href="#cb5-255" aria-hidden="true" tabindex="-1"></a>     - Anwendung des nicht-linearen Regressionsmodells auf die eingegebenen Daten</span>
<span id="cb5-256"><a href="#cb5-256" aria-hidden="true" tabindex="-1"></a>     - Startwerte<span class="in">:</span></span>
<span id="cb5-257"><a href="#cb5-257" aria-hidden="true" tabindex="-1"></a>       - a<span class="in">:</span> <span class="op">*</span>1<span class="fu">.0</span><span class="op">*</span></span>
<span id="cb5-258"><a href="#cb5-258" aria-hidden="true" tabindex="-1"></a>       - b<span class="in">:</span> <span class="op">*</span>0<span class="fu">.01</span><span class="op">*</span></span>
<span id="cb5-259"><a href="#cb5-259" aria-hidden="true" tabindex="-1"></a>  c) Durchführung der nicht-linearen Regression<span class="in">:</span></span>
<span id="cb5-260"><a href="#cb5-260" aria-hidden="true" tabindex="-1"></a>     - Verwendung der Standard-nls-Funktion in R</span>
<span id="cb5-261"><a href="#cb5-261" aria-hidden="true" tabindex="-1"></a>     - Keine expliziten Grenzen für die Parameter gesetzt</span>
<span id="cb5-262"><a href="#cb5-262" aria-hidden="true" tabindex="-1"></a>  d) Ergebnisverarbeitung<span class="in">:</span></span>
<span id="cb5-263"><a href="#cb5-263" aria-hidden="true" tabindex="-1"></a>     - Extraktion der Koeffizienten a und b aus dem angepassten Modell</span>
<span id="cb5-264"><a href="#cb5-264" aria-hidden="true" tabindex="-1"></a>  e) Visualisierung<span class="in">:</span></span>
<span id="cb5-265"><a href="#cb5-265" aria-hidden="true" tabindex="-1"></a>     - Erstellung einer Sequenz von Leistungswerten für glatte Kurvendarstellung</span>
<span id="cb5-266"><a href="#cb5-266" aria-hidden="true" tabindex="-1"></a>     - Berechnung der vorhergesagten ΔBLC-Werte basierend auf dem Modell</span>
<span id="cb5-267"><a href="#cb5-267" aria-hidden="true" tabindex="-1"></a>     - Darstellung der eingegebenen Datenpunkte und der Modellkurve</span>
<span id="cb5-268"><a href="#cb5-268" aria-hidden="true" tabindex="-1"></a>     - Anzeige der Modellgleichung mit den angepassten Koeffizienten</span>
<span id="cb5-269"><a href="#cb5-269" aria-hidden="true" tabindex="-1"></a>- Optimierung<span class="in">:</span> Minimierung der Summe der quadrierten Abweichungen <span class="in">(</span>nls<span class="in">)</span></span>
<span id="cb5-270"><a href="#cb5-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-271"><a href="#cb5-271" aria-hidden="true" tabindex="-1"></a><span class="in">:::</span></span>
<span id="cb5-272"><a href="#cb5-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-273"><a href="#cb5-273" aria-hidden="true" tabindex="-1"></a>### Blutlaktat-Modellfunktion<span class="in">:</span> Exponentieller Abfall nach dem Belastungsende</span>
<span id="cb5-274"><a href="#cb5-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-275"><a href="#cb5-275" aria-hidden="true" tabindex="-1"></a>Die nachfolgende Shiny-App visualisiert den Verlauf der Blutlaktatkonzentration nach Belastungsende. Der Verlauf zeigt ausgehend vom gewählten Startzeitpunkt und unter der vereinfachten Annahme eines sofortigen Laktatabbaus ohne weiteren Anstieg einen exponentiellen Abfall über die Zeit. Die Laktatkonzentration sinkt zunächst schnell und nähert sich dann asymptotisch dem Ruheniveau an. Diese Beziehung verdeutlicht das Verhältnis zwischen der Änderung der Laktatkonzentration <span class="in">(</span>ΔLaktat<span class="in">)</span> und der verstrichenen Zeit nach Belastungsende <span class="in">(</span>ΔZeit<span class="in">)</span>.</span>
<span id="cb5-276"><a href="#cb5-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-277"><a href="#cb5-277" aria-hidden="true" tabindex="-1"></a>```{shinylive-r}</span>
<span id="cb5-278"><a href="#cb5-278" aria-hidden="true" tabindex="-1"></a>#<span class="op">|</span> standalone<span class="in">:</span> true</span>
<span id="cb5-279"><a href="#cb5-279" aria-hidden="true" tabindex="-1"></a>#<span class="op">|</span> viewerHeight<span class="in">:</span> 900</span>
<span id="cb5-280"><a href="#cb5-280" aria-hidden="true" tabindex="-1"></a>library<span class="in">(</span>shiny<span class="in">)</span></span>
<span id="cb5-281"><a href="#cb5-281" aria-hidden="true" tabindex="-1"></a>library<span class="in">(</span>shinylive<span class="in">)</span></span>
<span id="cb5-282"><a href="#cb5-282" aria-hidden="true" tabindex="-1"></a>library<span class="in">(</span>plotly<span class="in">)</span></span>
<span id="cb5-283"><a href="#cb5-283" aria-hidden="true" tabindex="-1"></a>library<span class="in">(</span>minpack<span class="fu">.lm</span><span class="in">)</span></span>
<span id="cb5-284"><a href="#cb5-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-285"><a href="#cb5-285" aria-hidden="true" tabindex="-1"></a># Define data</span>
<span id="cb5-286"><a href="#cb5-286" aria-hidden="true" tabindex="-1"></a>t_s &lt;- c<span class="in">(</span>23<span class="op">,</span> 127<span class="op">,</span> 261<span class="op">,</span> 422<span class="fu">.5</span><span class="op">,</span> 549<span class="fu">.8</span><span class="op">,</span> 664<span class="fu">.5</span><span class="op">,</span> 795<span class="fu">.8</span><span class="op">,</span> 1254<span class="fu">.9</span><span class="in">)</span></span>
<span id="cb5-287"><a href="#cb5-287" aria-hidden="true" tabindex="-1"></a>BLC_t &lt;- c<span class="in">(</span>10<span class="fu">.04</span><span class="op">,</span> 7<span class="fu">.49</span><span class="op">,</span> 5<span class="fu">.18</span><span class="op">,</span> 3<span class="fu">.9</span><span class="op">,</span> 2<span class="fu">.67</span><span class="op">,</span> 2<span class="fu">.18</span><span class="op">,</span> 1<span class="fu">.64</span><span class="op">,</span> 0<span class="fu">.98</span><span class="in">)</span></span>
<span id="cb5-288"><a href="#cb5-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-289"><a href="#cb5-289" aria-hidden="true" tabindex="-1"></a># New model function<span class="in">:</span> A <span class="op">*</span> exp<span class="in">(</span>-k <span class="op">*</span> <span class="in">(</span>t - delay<span class="in">))</span> <span class="op">+</span> BLC0</span>
<span id="cb5-290"><a href="#cb5-290" aria-hidden="true" tabindex="-1"></a>laktat_model_function &lt;- function<span class="in">(</span>t<span class="op">,</span> A<span class="op">,</span> k<span class="op">,</span> BLC0<span class="op">,</span> delay<span class="in">)</span> {</span>
<span id="cb5-291"><a href="#cb5-291" aria-hidden="true" tabindex="-1"></a>  A <span class="op">*</span> exp<span class="in">(</span>-k <span class="op">*</span> <span class="in">(</span>t - delay<span class="in">))</span> <span class="op">+</span> BLC0</span>
<span id="cb5-292"><a href="#cb5-292" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-293"><a href="#cb5-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-294"><a href="#cb5-294" aria-hidden="true" tabindex="-1"></a># UI</span>
<span id="cb5-295"><a href="#cb5-295" aria-hidden="true" tabindex="-1"></a>ui &lt;- fluidPage<span class="in">(</span></span>
<span id="cb5-296"><a href="#cb5-296" aria-hidden="true" tabindex="-1"></a>  titlePanel<span class="in">(</span>"BLC-Modellfunktion"<span class="in">)</span><span class="op">,</span></span>
<span id="cb5-297"><a href="#cb5-297" aria-hidden="true" tabindex="-1"></a>  fluidRow<span class="in">(</span></span>
<span id="cb5-298"><a href="#cb5-298" aria-hidden="true" tabindex="-1"></a>    column<span class="in">(</span>3<span class="op">,</span></span>
<span id="cb5-299"><a href="#cb5-299" aria-hidden="true" tabindex="-1"></a>           style = "height<span class="in">:</span> 90vh; overflow-y<span class="in">:</span> auto;"<span class="op">,</span></span>
<span id="cb5-300"><a href="#cb5-300" aria-hidden="true" tabindex="-1"></a>           </span>
<span id="cb5-301"><a href="#cb5-301" aria-hidden="true" tabindex="-1"></a>           tags$h4<span class="in">(</span>tags$strong<span class="in">(</span>"Modellparameter<span class="in">:</span>"<span class="in">))</span><span class="op">,</span></span>
<span id="cb5-302"><a href="#cb5-302" aria-hidden="true" tabindex="-1"></a>           sliderInput<span class="in">(</span>"A"<span class="op">,</span> "A <span class="ex">[</span><span class="ss">mmol/l</span><span class="ex">]</span>"<span class="op">,</span> min = 0<span class="fu">.0</span><span class="op">,</span> max = 15<span class="fu">.0</span><span class="op">,</span> value = 8<span class="fu">.0</span><span class="op">,</span> step = 0<span class="fu">.1</span><span class="in">)</span><span class="op">,</span></span>
<span id="cb5-303"><a href="#cb5-303" aria-hidden="true" tabindex="-1"></a>           sliderInput<span class="in">(</span>"k"<span class="op">,</span> "k <span class="ex">[</span><span class="ss">s</span><span class="op">^</span><span class="ss">-1</span><span class="ex">]</span>"<span class="op">,</span> min = 0<span class="fu">.0001</span><span class="op">,</span> max = 0<span class="fu">.02</span><span class="op">,</span> value = 0<span class="fu">.005</span><span class="op">,</span> step = 0<span class="fu">.0001</span><span class="in">)</span><span class="op">,</span></span>
<span id="cb5-304"><a href="#cb5-304" aria-hidden="true" tabindex="-1"></a>           sliderInput<span class="in">(</span>"BLC0"<span class="op">,</span> "BLC0 <span class="ex">[</span><span class="ss">mmol/l</span><span class="ex">]</span>"<span class="op">,</span> min = 0<span class="fu">.0</span><span class="op">,</span> max = 5<span class="fu">.0</span><span class="op">,</span> value = 1<span class="fu">.0</span><span class="op">,</span> step = 0<span class="fu">.01</span><span class="in">)</span><span class="op">,</span></span>
<span id="cb5-305"><a href="#cb5-305" aria-hidden="true" tabindex="-1"></a>           sliderInput<span class="in">(</span>"delay"<span class="op">,</span> "Delay <span class="ex">[</span><span class="ss">s</span><span class="ex">]</span>"<span class="op">,</span> min = 0<span class="op">,</span> max = 3600<span class="op">,</span> value = 0<span class="op">,</span> step = 0<span class="fu">.1</span><span class="in">)</span><span class="op">,</span></span>
<span id="cb5-306"><a href="#cb5-306" aria-hidden="true" tabindex="-1"></a>           actionButton<span class="in">(</span>"set_delay"<span class="op">,</span> "Delay auf BLC_1"<span class="in">)</span><span class="op">,</span></span>
<span id="cb5-307"><a href="#cb5-307" aria-hidden="true" tabindex="-1"></a>           br<span class="in">()</span><span class="op">,</span> br<span class="in">()</span><span class="op">,</span></span>
<span id="cb5-308"><a href="#cb5-308" aria-hidden="true" tabindex="-1"></a>           actionButton<span class="in">(</span>"optimize"<span class="op">,</span> "Fit<span class="in">:</span> nlsLM"<span class="in">)</span><span class="op">,</span> </span>
<span id="cb5-309"><a href="#cb5-309" aria-hidden="true" tabindex="-1"></a>           br<span class="in">()</span><span class="op">,</span> br<span class="in">()</span><span class="op">,</span></span>
<span id="cb5-310"><a href="#cb5-310" aria-hidden="true" tabindex="-1"></a>           fileInput<span class="in">(</span>"file_upload"<span class="op">,</span> "CSV-Datei hochladen"<span class="op">,</span> accept = "<span class="fu">.csv</span>"<span class="in">)</span></span>
<span id="cb5-311"><a href="#cb5-311" aria-hidden="true" tabindex="-1"></a>    <span class="in">)</span><span class="op">,</span></span>
<span id="cb5-312"><a href="#cb5-312" aria-hidden="true" tabindex="-1"></a>    mainPanel<span class="in">(</span></span>
<span id="cb5-313"><a href="#cb5-313" aria-hidden="true" tabindex="-1"></a>      width = 9<span class="op">,</span></span>
<span id="cb5-314"><a href="#cb5-314" aria-hidden="true" tabindex="-1"></a>      plotlyOutput<span class="in">(</span>"plot"<span class="in">)</span><span class="op">,</span></span>
<span id="cb5-315"><a href="#cb5-315" aria-hidden="true" tabindex="-1"></a>      uiOutput<span class="in">(</span>"instructions"<span class="in">)</span></span>
<span id="cb5-316"><a href="#cb5-316" aria-hidden="true" tabindex="-1"></a>    <span class="in">)</span></span>
<span id="cb5-317"><a href="#cb5-317" aria-hidden="true" tabindex="-1"></a>  <span class="in">)</span></span>
<span id="cb5-318"><a href="#cb5-318" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb5-319"><a href="#cb5-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-320"><a href="#cb5-320" aria-hidden="true" tabindex="-1"></a># Server logic</span>
<span id="cb5-321"><a href="#cb5-321" aria-hidden="true" tabindex="-1"></a>server &lt;- function<span class="in">(</span>input<span class="op">,</span> output<span class="op">,</span> session<span class="in">)</span> {</span>
<span id="cb5-322"><a href="#cb5-322" aria-hidden="true" tabindex="-1"></a>  # Reactive value for uploaded data</span>
<span id="cb5-323"><a href="#cb5-323" aria-hidden="true" tabindex="-1"></a>  uploaded_data &lt;- reactiveVal<span class="in">(</span>NULL<span class="in">)</span></span>
<span id="cb5-324"><a href="#cb5-324" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-325"><a href="#cb5-325" aria-hidden="true" tabindex="-1"></a>  # Observer for CSV upload</span>
<span id="cb5-326"><a href="#cb5-326" aria-hidden="true" tabindex="-1"></a>  observeEvent<span class="in">(</span>input$file_upload<span class="op">,</span> <span class="er">{</span></span>
<span id="cb5-327"><a href="#cb5-327" aria-hidden="true" tabindex="-1"></a>    req(input$file_upload)</span>
<span id="cb5-328"><a href="#cb5-328" aria-hidden="true" tabindex="-1"></a>    df &lt;- read<span class="fu">.csv</span><span class="in">(</span>input$file_upload$datapath<span class="in">)</span></span>
<span id="cb5-329"><a href="#cb5-329" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-330"><a href="#cb5-330" aria-hidden="true" tabindex="-1"></a>    if <span class="in">(</span>"t_s" %in% names<span class="in">(</span>df<span class="in">)</span> <span class="op">&amp;&amp;</span> "BLC_t" %in% names<span class="in">(</span>df<span class="in">))</span> {</span>
<span id="cb5-331"><a href="#cb5-331" aria-hidden="true" tabindex="-1"></a>      uploaded_data(df)</span>
<span id="cb5-332"><a href="#cb5-332" aria-hidden="true" tabindex="-1"></a>    } else {</span>
<span id="cb5-333"><a href="#cb5-333" aria-hidden="true" tabindex="-1"></a>      showModal(modalDialog(</span>
<span id="cb5-334"><a href="#cb5-334" aria-hidden="true" tabindex="-1"></a>        title = "Ungültige CSV"<span class="op">,</span></span>
<span id="cb5-335"><a href="#cb5-335" aria-hidden="true" tabindex="-1"></a>        "Die CSV-Datei muss 't_s' und 'BLC_t' als Spaltennamen enthalten."<span class="op">,</span></span>
<span id="cb5-336"><a href="#cb5-336" aria-hidden="true" tabindex="-1"></a>        easyClose = TRUE<span class="op">,</span></span>
<span id="cb5-337"><a href="#cb5-337" aria-hidden="true" tabindex="-1"></a>        footer = NULL</span>
<span id="cb5-338"><a href="#cb5-338" aria-hidden="true" tabindex="-1"></a>      ))</span>
<span id="cb5-339"><a href="#cb5-339" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-340"><a href="#cb5-340" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb5-341"><a href="#cb5-341" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-342"><a href="#cb5-342" aria-hidden="true" tabindex="-1"></a>  # Observer for setting delay to first time point</span>
<span id="cb5-343"><a href="#cb5-343" aria-hidden="true" tabindex="-1"></a>  observeEvent<span class="in">(</span>input$set_delay<span class="op">,</span> <span class="er">{</span></span>
<span id="cb5-344"><a href="#cb5-344" aria-hidden="true" tabindex="-1"></a>    data &lt;- if (is<span class="fu">.null</span><span class="in">(</span>uploaded_data<span class="in">())</span>) {</span>
<span id="cb5-345"><a href="#cb5-345" aria-hidden="true" tabindex="-1"></a>      data<span class="fu">.frame</span><span class="in">(</span>t_s = t_s<span class="op">,</span> BLC_t = BLC_t<span class="in">)</span></span>
<span id="cb5-346"><a href="#cb5-346" aria-hidden="true" tabindex="-1"></a>    } else {</span>
<span id="cb5-347"><a href="#cb5-347" aria-hidden="true" tabindex="-1"></a>      uploaded_data()</span>
<span id="cb5-348"><a href="#cb5-348" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-349"><a href="#cb5-349" aria-hidden="true" tabindex="-1"></a>    updateSliderInput(session<span class="op">,</span> "delay"<span class="op">,</span> value = min<span class="in">(</span>data$t_s<span class="in">)</span>)</span>
<span id="cb5-350"><a href="#cb5-350" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb5-351"><a href="#cb5-351" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-352"><a href="#cb5-352" aria-hidden="true" tabindex="-1"></a>  observeEvent<span class="in">(</span>input$optimize<span class="op">,</span> <span class="er">{</span></span>
<span id="cb5-353"><a href="#cb5-353" aria-hidden="true" tabindex="-1"></a>    data &lt;- if (is<span class="fu">.null</span><span class="in">(</span>uploaded_data<span class="in">())</span>) {</span>
<span id="cb5-354"><a href="#cb5-354" aria-hidden="true" tabindex="-1"></a>      data<span class="fu">.frame</span><span class="in">(</span>t_s = t_s<span class="op">,</span> BLC_t = BLC_t<span class="in">)</span></span>
<span id="cb5-355"><a href="#cb5-355" aria-hidden="true" tabindex="-1"></a>    } else {</span>
<span id="cb5-356"><a href="#cb5-356" aria-hidden="true" tabindex="-1"></a>      uploaded_data()</span>
<span id="cb5-357"><a href="#cb5-357" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-358"><a href="#cb5-358" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-359"><a href="#cb5-359" aria-hidden="true" tabindex="-1"></a>    delay &lt;- input$delay</span>
<span id="cb5-360"><a href="#cb5-360" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-361"><a href="#cb5-361" aria-hidden="true" tabindex="-1"></a>    # Filter data points after the delay</span>
<span id="cb5-362"><a href="#cb5-362" aria-hidden="true" tabindex="-1"></a>    data_filtered &lt;- data<span class="ex">[</span><span class="ss">data</span><span class="op">$</span><span class="ss">t_s </span><span class="op">&gt;</span> delay<span class="op">,</span> ]</span>
<span id="cb5-363"><a href="#cb5-363" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-364"><a href="#cb5-364" aria-hidden="true" tabindex="-1"></a>    if <span class="in">(</span>nrow<span class="in">(</span>data_filtered<span class="in">)</span> &lt; 3<span class="in">)</span> {</span>
<span id="cb5-365"><a href="#cb5-365" aria-hidden="true" tabindex="-1"></a>      showNotification("Nicht genügend Datenpunkte nach dem Delay für den Fitting-Prozess."<span class="op">,</span> type = "error")</span>
<span id="cb5-366"><a href="#cb5-366" aria-hidden="true" tabindex="-1"></a>      return<span class="in">()</span></span>
<span id="cb5-367"><a href="#cb5-367" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-368"><a href="#cb5-368" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-369"><a href="#cb5-369" aria-hidden="true" tabindex="-1"></a>    best_fit &lt;- NULL</span>
<span id="cb5-370"><a href="#cb5-370" aria-hidden="true" tabindex="-1"></a>    best_rss &lt;- Inf</span>
<span id="cb5-371"><a href="#cb5-371" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-372"><a href="#cb5-372" aria-hidden="true" tabindex="-1"></a>    withProgress(message = 'Fitting in progress'<span class="op">,</span> value = 0<span class="op">,</span> {</span>
<span id="cb5-373"><a href="#cb5-373" aria-hidden="true" tabindex="-1"></a>      for (i in 1<span class="ch">:</span><span class="dv">100</span>) {</span>
<span id="cb5-374"><a href="#cb5-374" aria-hidden="true" tabindex="-1"></a>        # <span class="dv">Randomized starting values</span></span>
<span id="cb5-375"><a href="#cb5-375" aria-hidden="true" tabindex="-1"></a>        <span class="dv">A_start </span>&lt;<span class="dv">- </span>runif<span class="fu">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">15</span><span class="fu">)</span></span>
<span id="cb5-376"><a href="#cb5-376" aria-hidden="true" tabindex="-1"></a>        <span class="dv">k_start </span>&lt;<span class="dv">- </span>runif<span class="fu">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">0.0001</span><span class="op">,</span> <span class="dv">0.02</span><span class="fu">)</span></span>
<span id="cb5-377"><a href="#cb5-377" aria-hidden="true" tabindex="-1"></a>        <span class="dv">BLC0_start </span>&lt;<span class="dv">- </span>runif<span class="fu">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">5</span><span class="fu">)</span></span>
<span id="cb5-378"><a href="#cb5-378" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-379"><a href="#cb5-379" aria-hidden="true" tabindex="-1"></a>        <span class="dv">start_values </span>&lt;<span class="dv">- </span>list<span class="fu">(</span><span class="dv">A </span>= <span class="dv">A_start</span><span class="op">,</span> <span class="dv">k </span>= <span class="dv">k_start</span><span class="op">,</span> <span class="dv">BLC0 </span>= <span class="dv">BLC0_start</span><span class="fu">)</span></span>
<span id="cb5-380"><a href="#cb5-380" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-381"><a href="#cb5-381" aria-hidden="true" tabindex="-1"></a>        <span class="dv">model_equation </span>&lt;<span class="dv">- BLC_t </span>~ <span class="dv">A </span>* <span class="fu">exp(</span><span class="dv">-k </span>* <span class="fu">(</span><span class="dv">t_s - delay</span><span class="fu">))</span> + <span class="dv">BLC0</span></span>
<span id="cb5-382"><a href="#cb5-382" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-383"><a href="#cb5-383" aria-hidden="true" tabindex="-1"></a>        <span class="dv">fit </span>&lt;<span class="dv">- </span>try<span class="fu">(</span>nlsLM<span class="fu">(</span><span class="dv">model_equation</span><span class="op">,</span></span>
<span id="cb5-384"><a href="#cb5-384" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">data </span>= <span class="dv">data_filtered</span><span class="op">,</span></span>
<span id="cb5-385"><a href="#cb5-385" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">start</span> = <span class="dv">start_values</span><span class="op">,</span></span>
<span id="cb5-386"><a href="#cb5-386" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">lower </span>= c<span class="fu">(</span><span class="dv">A </span>= <span class="dv">0</span><span class="op">,</span> <span class="dv">k </span>= <span class="dv">0.0001</span><span class="op">,</span> <span class="dv">BLC0 </span>= <span class="dv">0</span><span class="fu">)</span><span class="op">,</span></span>
<span id="cb5-387"><a href="#cb5-387" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">upper </span>= c<span class="fu">(</span><span class="dv">A </span>= <span class="dv">15</span><span class="op">,</span> <span class="dv">k </span>= <span class="dv">0.02</span><span class="op">,</span> <span class="dv">BLC0 </span>= <span class="dv">5</span><span class="fu">)</span><span class="op">,</span></span>
<span id="cb5-388"><a href="#cb5-388" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">control </span>= <span class="dv">nls</span>.control<span class="fu">(</span><span class="dv">maxiter </span>= <span class="dv">1024</span><span class="fu">))</span><span class="op">,</span> <span class="dv">silent </span>= <span class="dv">TRUE</span><span class="fu">)</span></span>
<span id="cb5-389"><a href="#cb5-389" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-390"><a href="#cb5-390" aria-hidden="true" tabindex="-1"></a>        <span class="dv">if </span><span class="fu">(</span><span class="at">!</span>inherits<span class="fu">(</span><span class="dv">fit</span><span class="op">,</span> <span class="st">"try-error"</span><span class="fu">))</span> {</span>
<span id="cb5-391"><a href="#cb5-391" aria-hidden="true" tabindex="-1"></a>          <span class="dv">rss </span>&lt;<span class="dv">- </span>sum<span class="fu">(</span>residuals<span class="fu">(</span><span class="dv">fit</span><span class="fu">)</span>^<span class="dv">2</span><span class="fu">)</span></span>
<span id="cb5-392"><a href="#cb5-392" aria-hidden="true" tabindex="-1"></a>          <span class="dv">if </span><span class="fu">(</span><span class="dv">rss </span>&lt; <span class="dv">best_rss</span><span class="fu">)</span> {</span>
<span id="cb5-393"><a href="#cb5-393" aria-hidden="true" tabindex="-1"></a>            <span class="dv">best_rss </span>&lt;<span class="dv">- rss</span></span>
<span id="cb5-394"><a href="#cb5-394" aria-hidden="true" tabindex="-1"></a>            <span class="dv">best_fit </span>&lt;<span class="dv">- fit</span></span>
<span id="cb5-395"><a href="#cb5-395" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb5-396"><a href="#cb5-396" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb5-397"><a href="#cb5-397" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-398"><a href="#cb5-398" aria-hidden="true" tabindex="-1"></a>        incProgress<span class="in">(</span>1/100<span class="op">,</span> detail = paste<span class="in">(</span>"Iteration"<span class="op">,</span> i<span class="in">))</span></span>
<span id="cb5-399"><a href="#cb5-399" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb5-400"><a href="#cb5-400" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb5-401"><a href="#cb5-401" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-402"><a href="#cb5-402" aria-hidden="true" tabindex="-1"></a>    if <span class="in">(</span>!is<span class="fu">.null</span><span class="in">(</span>best_fit<span class="in">))</span> {</span>
<span id="cb5-403"><a href="#cb5-403" aria-hidden="true" tabindex="-1"></a>      params &lt;- as<span class="fu">.list</span><span class="in">(</span>coef<span class="in">(</span>best_fit<span class="in">))</span></span>
<span id="cb5-404"><a href="#cb5-404" aria-hidden="true" tabindex="-1"></a>      updateSliderInput<span class="in">(</span>session<span class="op">,</span> "A"<span class="op">,</span> value = params$A<span class="in">)</span></span>
<span id="cb5-405"><a href="#cb5-405" aria-hidden="true" tabindex="-1"></a>      updateSliderInput<span class="in">(</span>session<span class="op">,</span> "k"<span class="op">,</span> value = params$k<span class="in">)</span></span>
<span id="cb5-406"><a href="#cb5-406" aria-hidden="true" tabindex="-1"></a>      updateSliderInput<span class="in">(</span>session<span class="op">,</span> "BLC0"<span class="op">,</span> value = params$BLC0<span class="in">)</span></span>
<span id="cb5-407"><a href="#cb5-407" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-408"><a href="#cb5-408" aria-hidden="true" tabindex="-1"></a>      showNotification<span class="in">(</span>"Fitting completed successfully!"<span class="op">,</span> type = "message"<span class="in">)</span></span>
<span id="cb5-409"><a href="#cb5-409" aria-hidden="true" tabindex="-1"></a>    } else {</span>
<span id="cb5-410"><a href="#cb5-410" aria-hidden="true" tabindex="-1"></a>      showModal(modalDialog(</span>
<span id="cb5-411"><a href="#cb5-411" aria-hidden="true" tabindex="-1"></a>        title = "nlsLM fehlgeschlagen"<span class="op">,</span></span>
<span id="cb5-412"><a href="#cb5-412" aria-hidden="true" tabindex="-1"></a>        "Die nicht-lineare Regression mit dem Levenberg-Marquardt-Algorithmus konnte nicht erfolgreich durchgeführt werden."<span class="op">,</span></span>
<span id="cb5-413"><a href="#cb5-413" aria-hidden="true" tabindex="-1"></a>        easyClose = TRUE<span class="op">,</span></span>
<span id="cb5-414"><a href="#cb5-414" aria-hidden="true" tabindex="-1"></a>        footer = NULL</span>
<span id="cb5-415"><a href="#cb5-415" aria-hidden="true" tabindex="-1"></a>      ))</span>
<span id="cb5-416"><a href="#cb5-416" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-417"><a href="#cb5-417" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb5-418"><a href="#cb5-418" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-419"><a href="#cb5-419" aria-hidden="true" tabindex="-1"></a>  output$plot &lt;- renderPlotly<span class="in">(</span><span class="er">{</span></span>
<span id="cb5-420"><a href="#cb5-420" aria-hidden="true" tabindex="-1"></a>    A &lt;- input$A</span>
<span id="cb5-421"><a href="#cb5-421" aria-hidden="true" tabindex="-1"></a>    k &lt;- input$k</span>
<span id="cb5-422"><a href="#cb5-422" aria-hidden="true" tabindex="-1"></a>    BLC0 &lt;- input$BLC0</span>
<span id="cb5-423"><a href="#cb5-423" aria-hidden="true" tabindex="-1"></a>    delay &lt;- input$delay</span>
<span id="cb5-424"><a href="#cb5-424" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-425"><a href="#cb5-425" aria-hidden="true" tabindex="-1"></a>    data &lt;- if (is<span class="fu">.null</span><span class="in">(</span>uploaded_data<span class="in">())</span>) {</span>
<span id="cb5-426"><a href="#cb5-426" aria-hidden="true" tabindex="-1"></a>      data<span class="fu">.frame</span><span class="in">(</span>t_s = t_s<span class="op">,</span> BLC_t = BLC_t<span class="in">)</span></span>
<span id="cb5-427"><a href="#cb5-427" aria-hidden="true" tabindex="-1"></a>    } else {</span>
<span id="cb5-428"><a href="#cb5-428" aria-hidden="true" tabindex="-1"></a>      uploaded_data()</span>
<span id="cb5-429"><a href="#cb5-429" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-430"><a href="#cb5-430" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-431"><a href="#cb5-431" aria-hidden="true" tabindex="-1"></a>    max_x &lt;- max(data$t_s) <span class="op">*</span> 1<span class="fu">.66</span></span>
<span id="cb5-432"><a href="#cb5-432" aria-hidden="true" tabindex="-1"></a>    min_x &lt;- max<span class="in">(</span>delay - 360<span class="op">,</span> 0<span class="in">)</span></span>
<span id="cb5-433"><a href="#cb5-433" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-434"><a href="#cb5-434" aria-hidden="true" tabindex="-1"></a>    t_s_modell &lt;- seq<span class="in">(</span>min_x<span class="op">,</span> max_x<span class="op">,</span> length<span class="fu">.out</span> = 1000<span class="in">)</span></span>
<span id="cb5-435"><a href="#cb5-435" aria-hidden="true" tabindex="-1"></a>    BLC_t_modell &lt;- laktat_model_function<span class="in">(</span>t_s_modell<span class="op">,</span> A<span class="op">,</span> k<span class="op">,</span> BLC0<span class="op">,</span> delay<span class="in">)</span></span>
<span id="cb5-436"><a href="#cb5-436" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-437"><a href="#cb5-437" aria-hidden="true" tabindex="-1"></a>    max_y &lt;- max<span class="in">(</span>max<span class="in">(</span>BLC_t_modell<span class="in">)</span> <span class="op">*</span> 1<span class="fu">.1</span><span class="op">,</span> max<span class="in">(</span>data$BLC_t<span class="in">)</span> <span class="op">*</span> 1<span class="fu">.1</span><span class="in">)</span></span>
<span id="cb5-438"><a href="#cb5-438" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-439"><a href="#cb5-439" aria-hidden="true" tabindex="-1"></a>    # Create equation text</span>
<span id="cb5-440"><a href="#cb5-440" aria-hidden="true" tabindex="-1"></a>    eq_text &lt;- sprintf<span class="in">(</span>"BLC<span class="in">(</span>t<span class="in">)</span> = %<span class="fu">.2f</span> <span class="op">*</span> e&lt;sup<span class="op">&gt;</span>-%<span class="fu">.4f</span><span class="op">*</span><span class="in">(</span>t-%<span class="fu">.2f</span><span class="in">)</span>&lt;/sup<span class="op">&gt;</span> <span class="op">+</span> %<span class="fu">.3f</span>"<span class="op">,</span> A<span class="op">,</span> k<span class="op">,</span> delay<span class="op">,</span> BLC0<span class="in">)</span></span>
<span id="cb5-441"><a href="#cb5-441" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-442"><a href="#cb5-442" aria-hidden="true" tabindex="-1"></a>    # Calculate R²</span>
<span id="cb5-443"><a href="#cb5-443" aria-hidden="true" tabindex="-1"></a>    data_filtered &lt;- data<span class="ex">[</span><span class="ss">data</span><span class="op">$</span><span class="ss">t_s </span><span class="op">&gt;</span> delay<span class="op">,</span> ]</span>
<span id="cb5-444"><a href="#cb5-444" aria-hidden="true" tabindex="-1"></a>    BLC_t_modell_at_data &lt;- laktat_model_function<span class="in">(</span>data_filtered$t_s<span class="op">,</span> A<span class="op">,</span> k<span class="op">,</span> BLC0<span class="op">,</span> delay<span class="in">)</span></span>
<span id="cb5-445"><a href="#cb5-445" aria-hidden="true" tabindex="-1"></a>    ss_res &lt;- sum<span class="in">((</span>data_filtered$BLC_t - BLC_t_modell_at_data<span class="in">)</span>^2<span class="in">)</span></span>
<span id="cb5-446"><a href="#cb5-446" aria-hidden="true" tabindex="-1"></a>    ss_tot &lt;- sum<span class="in">((</span>data_filtered$BLC_t - mean<span class="in">(</span>data_filtered$BLC_t<span class="in">))</span>^2<span class="in">)</span></span>
<span id="cb5-447"><a href="#cb5-447" aria-hidden="true" tabindex="-1"></a>    r_squared &lt;- 1 - <span class="in">(</span>ss_res / ss_tot<span class="in">)</span></span>
<span id="cb5-448"><a href="#cb5-448" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-449"><a href="#cb5-449" aria-hidden="true" tabindex="-1"></a>    # Plotly plot</span>
<span id="cb5-450"><a href="#cb5-450" aria-hidden="true" tabindex="-1"></a>    p &lt;- plot_ly<span class="in">()</span> %<span class="op">&gt;</span>%</span>
<span id="cb5-451"><a href="#cb5-451" aria-hidden="true" tabindex="-1"></a>      add_trace<span class="in">(</span>x = t_s_modell<span class="ex">[</span><span class="ss">t_s_modell </span><span class="op">&gt;</span>= delay]<span class="op">,</span> y = BLC_t_modell<span class="ex">[</span><span class="ss">t_s_modell </span><span class="op">&gt;</span>= delay]<span class="op">,</span> </span>
<span id="cb5-452"><a href="#cb5-452" aria-hidden="true" tabindex="-1"></a>                type = 'scatter'<span class="op">,</span> mode = 'lines'<span class="op">,</span> </span>
<span id="cb5-453"><a href="#cb5-453" aria-hidden="true" tabindex="-1"></a>                name = 'Modellfunktion'<span class="op">,</span> line = list<span class="in">(</span>color = '<span class="pp">#EF6F6A</span>'<span class="in">))</span> %<span class="op">&gt;</span>%</span>
<span id="cb5-454"><a href="#cb5-454" aria-hidden="true" tabindex="-1"></a>      add_trace<span class="in">(</span>x = t_s_modell<span class="ex">[</span><span class="ss">t_s_modell &lt; delay</span><span class="ex">]</span><span class="op">,</span> y = BLC_t_modell<span class="ex">[</span><span class="ss">t_s_modell &lt; delay</span><span class="ex">]</span><span class="op">,</span> </span>
<span id="cb5-455"><a href="#cb5-455" aria-hidden="true" tabindex="-1"></a>                type = 'scatter'<span class="op">,</span> mode = 'lines'<span class="op">,</span> </span>
<span id="cb5-456"><a href="#cb5-456" aria-hidden="true" tabindex="-1"></a>                name = 'Modellfunktion <span class="in">(</span>vor Delay<span class="in">)</span>'<span class="op">,</span> line = list<span class="in">(</span>color = '<span class="pp">#EF6F6A</span>'<span class="op">,</span> dash = 'dash'<span class="in">))</span> %<span class="op">&gt;</span>%</span>
<span id="cb5-457"><a href="#cb5-457" aria-hidden="true" tabindex="-1"></a>      add_trace<span class="in">(</span>x = data$t_s<span class="op">,</span> y = data$BLC_t<span class="op">,</span> type = 'scatter'<span class="op">,</span> mode = 'markers'<span class="op">,</span> </span>
<span id="cb5-458"><a href="#cb5-458" aria-hidden="true" tabindex="-1"></a>                name = 'Gemessene BLC-Werte'<span class="op">,</span> marker = list<span class="in">(</span>color = '<span class="pp">#42BA97</span>'<span class="op">,</span> size = 10<span class="op">,</span> symbol = 'x'<span class="in">))</span> %<span class="op">&gt;</span>%</span>
<span id="cb5-459"><a href="#cb5-459" aria-hidden="true" tabindex="-1"></a>      add_segments<span class="in">(</span>x = delay<span class="op">,</span> xend = delay<span class="op">,</span> y = 0<span class="op">,</span> yend = max_y<span class="op">,</span> </span>
<span id="cb5-460"><a href="#cb5-460" aria-hidden="true" tabindex="-1"></a>                   line = list<span class="in">(</span>color = 'darkgrey'<span class="op">,</span> width = 1<span class="op">,</span> dash = 'dash'<span class="in">)</span><span class="op">,</span> </span>
<span id="cb5-461"><a href="#cb5-461" aria-hidden="true" tabindex="-1"></a>                   showlegend = FALSE<span class="op">,</span> opacity = 0<span class="fu">.75</span><span class="in">)</span> %<span class="op">&gt;</span>%</span>
<span id="cb5-462"><a href="#cb5-462" aria-hidden="true" tabindex="-1"></a>      layout<span class="in">(</span>title = "Exponentielles Laktat-Abbaumodell"<span class="op">,</span></span>
<span id="cb5-463"><a href="#cb5-463" aria-hidden="true" tabindex="-1"></a>             margin = list<span class="in">(</span>t = 40<span class="in">)</span><span class="op">,</span></span>
<span id="cb5-464"><a href="#cb5-464" aria-hidden="true" tabindex="-1"></a>             xaxis = list<span class="in">(</span>title = "Zeit <span class="ex">[</span><span class="ss">s</span><span class="ex">]</span>"<span class="op">,</span> range = c<span class="in">(</span>min_x<span class="op">,</span> max_x<span class="in">))</span><span class="op">,</span></span>
<span id="cb5-465"><a href="#cb5-465" aria-hidden="true" tabindex="-1"></a>             yaxis = list<span class="in">(</span>title = "BLC <span class="ex">[</span><span class="ss">mmol·l⁻¹</span><span class="ex">]</span>"<span class="op">,</span> range = c<span class="in">(</span>0<span class="op">,</span> max_y<span class="in">))</span><span class="op">,</span></span>
<span id="cb5-466"><a href="#cb5-466" aria-hidden="true" tabindex="-1"></a>             legend = list<span class="in">(</span></span>
<span id="cb5-467"><a href="#cb5-467" aria-hidden="true" tabindex="-1"></a>               x = 0<span class="fu">.07</span><span class="op">,</span></span>
<span id="cb5-468"><a href="#cb5-468" aria-hidden="true" tabindex="-1"></a>               y = 0<span class="fu">.99</span><span class="op">,</span></span>
<span id="cb5-469"><a href="#cb5-469" aria-hidden="true" tabindex="-1"></a>               xanchor = "left"<span class="op">,</span></span>
<span id="cb5-470"><a href="#cb5-470" aria-hidden="true" tabindex="-1"></a>               yanchor = "top"<span class="op">,</span></span>
<span id="cb5-471"><a href="#cb5-471" aria-hidden="true" tabindex="-1"></a>               bgcolor = "rgba<span class="in">(</span>255<span class="op">,</span> 255<span class="op">,</span> 255<span class="op">,</span> 0<span class="fu">.4</span><span class="in">)</span>"<span class="op">,</span></span>
<span id="cb5-472"><a href="#cb5-472" aria-hidden="true" tabindex="-1"></a>               bordercolor = "rgba<span class="in">(</span>0<span class="op">,</span>0<span class="op">,</span>0<span class="op">,</span>0<span class="in">)</span>"<span class="op">,</span></span>
<span id="cb5-473"><a href="#cb5-473" aria-hidden="true" tabindex="-1"></a>               borderwidth = 0</span>
<span id="cb5-474"><a href="#cb5-474" aria-hidden="true" tabindex="-1"></a>             <span class="in">)</span><span class="op">,</span></span>
<span id="cb5-475"><a href="#cb5-475" aria-hidden="true" tabindex="-1"></a>             paper_bgcolor = 'rgba<span class="in">(</span>0<span class="op">,</span>0<span class="op">,</span>0<span class="op">,</span>0<span class="in">)</span>'<span class="op">,</span></span>
<span id="cb5-476"><a href="#cb5-476" aria-hidden="true" tabindex="-1"></a>             plot_bgcolor = 'rgba<span class="in">(</span>0<span class="op">,</span>0<span class="op">,</span>0<span class="op">,</span>0<span class="in">)</span>'<span class="op">,</span></span>
<span id="cb5-477"><a href="#cb5-477" aria-hidden="true" tabindex="-1"></a>             annotations = list<span class="in">(</span></span>
<span id="cb5-478"><a href="#cb5-478" aria-hidden="true" tabindex="-1"></a>               list<span class="in">(</span></span>
<span id="cb5-479"><a href="#cb5-479" aria-hidden="true" tabindex="-1"></a>                 x = max_x <span class="op">*</span> 0<span class="fu">.4</span><span class="op">,</span> </span>
<span id="cb5-480"><a href="#cb5-480" aria-hidden="true" tabindex="-1"></a>                 y = max_y <span class="op">*</span> 0<span class="fu">.95</span><span class="op">,</span></span>
<span id="cb5-481"><a href="#cb5-481" aria-hidden="true" tabindex="-1"></a>                 text = eq_text<span class="op">,</span></span>
<span id="cb5-482"><a href="#cb5-482" aria-hidden="true" tabindex="-1"></a>                 showarrow = FALSE<span class="op">,</span></span>
<span id="cb5-483"><a href="#cb5-483" aria-hidden="true" tabindex="-1"></a>                 xanchor = 'left'<span class="op">,</span></span>
<span id="cb5-484"><a href="#cb5-484" aria-hidden="true" tabindex="-1"></a>                 yanchor = 'bottom'<span class="op">,</span></span>
<span id="cb5-485"><a href="#cb5-485" aria-hidden="true" tabindex="-1"></a>                 font = list<span class="in">(</span></span>
<span id="cb5-486"><a href="#cb5-486" aria-hidden="true" tabindex="-1"></a>                   size = 12<span class="op">,</span></span>
<span id="cb5-487"><a href="#cb5-487" aria-hidden="true" tabindex="-1"></a>                   color = "black"</span>
<span id="cb5-488"><a href="#cb5-488" aria-hidden="true" tabindex="-1"></a>                 <span class="in">)</span></span>
<span id="cb5-489"><a href="#cb5-489" aria-hidden="true" tabindex="-1"></a>               <span class="in">)</span><span class="op">,</span></span>
<span id="cb5-490"><a href="#cb5-490" aria-hidden="true" tabindex="-1"></a>               list<span class="in">(</span></span>
<span id="cb5-491"><a href="#cb5-491" aria-hidden="true" tabindex="-1"></a>                 x = max_x <span class="op">*</span> 0<span class="fu">.4</span><span class="op">,</span></span>
<span id="cb5-492"><a href="#cb5-492" aria-hidden="true" tabindex="-1"></a>                 y = max_y <span class="op">*</span> 0<span class="fu">.90</span><span class="op">,</span></span>
<span id="cb5-493"><a href="#cb5-493" aria-hidden="true" tabindex="-1"></a>                 text = sprintf<span class="in">(</span>"R²<span class="in">:</span> %<span class="fu">.4f</span>"<span class="op">,</span> r_squared<span class="in">)</span><span class="op">,</span></span>
<span id="cb5-494"><a href="#cb5-494" aria-hidden="true" tabindex="-1"></a>                 showarrow = FALSE<span class="op">,</span></span>
<span id="cb5-495"><a href="#cb5-495" aria-hidden="true" tabindex="-1"></a>                 xanchor = 'left'<span class="op">,</span></span>
<span id="cb5-496"><a href="#cb5-496" aria-hidden="true" tabindex="-1"></a>                 yanchor = 'bottom'<span class="op">,</span></span>
<span id="cb5-497"><a href="#cb5-497" aria-hidden="true" tabindex="-1"></a>                 font = list<span class="in">(</span></span>
<span id="cb5-498"><a href="#cb5-498" aria-hidden="true" tabindex="-1"></a>                   size = 12<span class="op">,</span></span>
<span id="cb5-499"><a href="#cb5-499" aria-hidden="true" tabindex="-1"></a>                   color = "black"</span>
<span id="cb5-500"><a href="#cb5-500" aria-hidden="true" tabindex="-1"></a>                 <span class="in">)</span></span>
<span id="cb5-501"><a href="#cb5-501" aria-hidden="true" tabindex="-1"></a>               <span class="in">)</span></span>
<span id="cb5-502"><a href="#cb5-502" aria-hidden="true" tabindex="-1"></a>             <span class="in">))</span></span>
<span id="cb5-503"><a href="#cb5-503" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-504"><a href="#cb5-504" aria-hidden="true" tabindex="-1"></a>    p</span>
<span id="cb5-505"><a href="#cb5-505" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb5-506"><a href="#cb5-506" aria-hidden="true" tabindex="-1"></a>  output$instructions &lt;- renderUI<span class="in">(</span><span class="er">{</span></span>
<span id="cb5-507"><a href="#cb5-507" aria-hidden="true" tabindex="-1"></a>    HTML(</span>
<span id="cb5-508"><a href="#cb5-508" aria-hidden="true" tabindex="-1"></a>      "&lt;div style='margin-top<span class="ch">:</span> <span class="dv">20</span><span class="dt">px</span><span class="op">;</span> <span class="kw">padding</span><span class="ch">:</span> <span class="dv">10</span><span class="dt">px</span><span class="op">;</span> <span class="kw">background-color</span><span class="ch">:</span> <span class="cn">#f0f0f0</span><span class="op">;</span> <span class="kw">border</span><span class="ch">:</span> <span class="dv">1</span><span class="dt">px</span> <span class="dv">solid</span> <span class="cn">#ddd</span><span class="op">;</span> <span class="kw">border-radius</span><span class="ch">:</span> <span class="dv">5</span><span class="dt">px</span><span class="op">;</span> <span class="kw">width</span><span class="ch">:</span> <span class="dv">fit-content</span><span class="op">;</span>'<span class="op">&gt;</span></span>
<span id="cb5-509"><a href="#cb5-509" aria-hidden="true" tabindex="-1"></a>        &lt;h4 style='color<span class="in">:</span> <span class="pp">#333</span>;'<span class="op">&gt;</span>&lt;strong<span class="op">&gt;</span>Anleitung - Modellanpassung<span class="in">:</span>&lt;/strong<span class="op">&gt;</span>&lt;/h4<span class="op">&gt;</span></span>
<span id="cb5-510"><a href="#cb5-510" aria-hidden="true" tabindex="-1"></a>        &lt;ol style='color<span class="in">:</span> <span class="pp">#555</span>; list-style-position<span class="in">:</span> outside; padding-left<span class="in">:</span> 20px;'<span class="op">&gt;</span></span>
<span id="cb5-511"><a href="#cb5-511" aria-hidden="true" tabindex="-1"></a>          &lt;li<span class="op">&gt;</span>Beispiel-Laktatdaten verwenden oder eigene Laktat-Daten als CSV-Datei einfügen.&lt;/li<span class="op">&gt;</span></span>
<span id="cb5-512"><a href="#cb5-512" aria-hidden="true" tabindex="-1"></a>          &lt;li<span class="op">&gt;</span>Zeitverzögerung manuell setzen oder mit 'Delay auf BLC_1' die Zeitverzögerung auf den Zeitpunkt des ersten BLC-Wertes setzen.&lt;/li<span class="op">&gt;</span></span>
<span id="cb5-513"><a href="#cb5-513" aria-hidden="true" tabindex="-1"></a>          &lt;li<span class="op">&gt;</span>Modellanpassung 'Fit<span class="in">:</span> nlsLM' durchführen.&lt;/li<span class="op">&gt;</span></span>
<span id="cb5-514"><a href="#cb5-514" aria-hidden="true" tabindex="-1"></a>          &lt;li<span class="op">&gt;</span>Alternativ<span class="in">:</span> Manuelle Modellanpassung der Modellparameter mit den Schiebereglern.&lt;/li<span class="op">&gt;</span></span>
<span id="cb5-515"><a href="#cb5-515" aria-hidden="true" tabindex="-1"></a>        &lt;/ol<span class="op">&gt;</span></span>
<span id="cb5-516"><a href="#cb5-516" aria-hidden="true" tabindex="-1"></a>        &lt;div style='margin-top<span class="in">:</span> 20px;'<span class="op">&gt;</span>&lt;/div<span class="op">&gt;</span></span>
<span id="cb5-517"><a href="#cb5-517" aria-hidden="true" tabindex="-1"></a>        &lt;pre style='background-color<span class="in">:</span> <span class="pp">#f8f8f8</span>; padding<span class="in">:</span> 10px; border<span class="in">:</span> 1px solid <span class="pp">#ddd</span>; border-radius<span class="in">:</span> 5px; width<span class="in">:</span> fit-content;'<span class="op">&gt;</span></span>
<span id="cb5-518"><a href="#cb5-518" aria-hidden="true" tabindex="-1"></a>Laktat-Daten können als CSV-Datei im folgenden Format hochgeladen werden<span class="in">:</span></span>
<span id="cb5-519"><a href="#cb5-519" aria-hidden="true" tabindex="-1"></a>t_s<span class="op">,</span>BLC_t</span>
<span id="cb5-520"><a href="#cb5-520" aria-hidden="true" tabindex="-1"></a>0<span class="fu">.0</span><span class="op">,</span>5<span class="fu">.84</span></span>
<span id="cb5-521"><a href="#cb5-521" aria-hidden="true" tabindex="-1"></a>90<span class="fu">.0</span><span class="op">,</span>3<span class="fu">.60</span></span>
<span id="cb5-522"><a href="#cb5-522" aria-hidden="true" tabindex="-1"></a>180<span class="fu">.0</span><span class="op">,</span>1<span class="fu">.09</span></span>
<span id="cb5-523"><a href="#cb5-523" aria-hidden="true" tabindex="-1"></a>…</span>
<span id="cb5-524"><a href="#cb5-524" aria-hidden="true" tabindex="-1"></a>        &lt;/pre<span class="op">&gt;</span></span>
<span id="cb5-525"><a href="#cb5-525" aria-hidden="true" tabindex="-1"></a>      &lt;/div<span class="op">&gt;</span>"</span>
<span id="cb5-526"><a href="#cb5-526" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-527"><a href="#cb5-527" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb5-528"><a href="#cb5-528" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-529"><a href="#cb5-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-530"><a href="#cb5-530" aria-hidden="true" tabindex="-1"></a># App ausführen</span>
<span id="cb5-531"><a href="#cb5-531" aria-hidden="true" tabindex="-1"></a>shinyApp<span class="in">(</span>ui = ui<span class="op">,</span> server = server<span class="in">)</span></span>
<span id="cb5-532"><a href="#cb5-532" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb5-533"><a href="#cb5-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-534"><a href="#cb5-534" aria-hidden="true" tabindex="-1"></a><span class="in">:::</span> {<span class="fu">.callout-note</span> icon=false collapse=true appearance="simple"}</span>
<span id="cb5-535"><a href="#cb5-535" aria-hidden="true" tabindex="-1"></a>#### Modellanpassung - Details<span class="in">:</span> {<span class="fu">.unlisted</span>}</span>
<span id="cb5-536"><a href="#cb5-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-537"><a href="#cb5-537" aria-hidden="true" tabindex="-1"></a><span class="op">**</span>nlsLM - Fit<span class="in">:</span><span class="op">**</span></span>
<span id="cb5-538"><a href="#cb5-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-539"><a href="#cb5-539" aria-hidden="true" tabindex="-1"></a>- Verwendete Funktion<span class="in">:</span> nlsLM</span>
<span id="cb5-540"><a href="#cb5-540" aria-hidden="true" tabindex="-1"></a>- Parameter<span class="in">:</span> a<span class="op">,</span> k1<span class="op">,</span> k2<span class="op">,</span> BLC0</span>
<span id="cb5-541"><a href="#cb5-541" aria-hidden="true" tabindex="-1"></a>- Modell<span class="in">:</span> BLC_t <span class="op">~</span> BLC0 <span class="op">+</span> <span class="in">(</span>a · k1 / <span class="in">(</span>k2 - k1<span class="in">))</span> · <span class="in">(</span>exp<span class="in">(</span>-k1 · t_min<span class="in">)</span> - exp<span class="in">(</span>-k2 · t_min<span class="in">))</span></span>
<span id="cb5-542"><a href="#cb5-542" aria-hidden="true" tabindex="-1"></a>- Grenzen<span class="in">:</span></span>
<span id="cb5-543"><a href="#cb5-543" aria-hidden="true" tabindex="-1"></a>  - a<span class="in">:</span> <span class="op">*</span>0<span class="fu">.0</span> bis 30<span class="fu">.0</span> mmol/l<span class="op">*</span></span>
<span id="cb5-544"><a href="#cb5-544" aria-hidden="true" tabindex="-1"></a>  - k1<span class="in">:</span> <span class="op">*</span>0<span class="fu">.1</span> bis 3<span class="fu">.5</span> min^-1<span class="op">*</span></span>
<span id="cb5-545"><a href="#cb5-545" aria-hidden="true" tabindex="-1"></a>  - k2<span class="in">:</span> <span class="op">*</span>0<span class="fu">.020</span> bis 0<span class="fu">.200</span> min^-1<span class="op">*</span></span>
<span id="cb5-546"><a href="#cb5-546" aria-hidden="true" tabindex="-1"></a>  - BLC0<span class="in">:</span> <span class="op">*</span>0<span class="fu">.90</span> · BLC_t<span class="ex">[</span><span class="ss">1</span><span class="ex">]</span> bis 1<span class="fu">.10</span> · BLC_t<span class="ex">[</span><span class="ss">1</span><span class="ex">]</span><span class="op">,</span> begrenzt auf 0 bis 5 mmol/l<span class="op">*</span></span>
<span id="cb5-547"><a href="#cb5-547" aria-hidden="true" tabindex="-1"></a>- Prozess<span class="in">:</span></span>
<span id="cb5-548"><a href="#cb5-548" aria-hidden="true" tabindex="-1"></a>  a) Bestimmung der BLC0-Grenzen<span class="in">:</span></span>
<span id="cb5-549"><a href="#cb5-549" aria-hidden="true" tabindex="-1"></a>     - Untere Grenze<span class="in">:</span> <span class="op">*</span>max<span class="in">(</span>0<span class="op">,</span> 0<span class="fu">.90</span> · erster BLC-Wert<span class="in">)</span><span class="op">*</span></span>
<span id="cb5-550"><a href="#cb5-550" aria-hidden="true" tabindex="-1"></a>     - Obere Grenze<span class="in">:</span> <span class="op">*</span>min<span class="in">(</span>5<span class="op">,</span> 1<span class="fu">.10</span> · erster BLC-Wert<span class="in">)</span><span class="op">*</span></span>
<span id="cb5-551"><a href="#cb5-551" aria-hidden="true" tabindex="-1"></a>  b) Iterative Optimierung <span class="in">(</span>100 Durchläufe<span class="in">):</span></span>
<span id="cb5-552"><a href="#cb5-552" aria-hidden="true" tabindex="-1"></a>     - Zufällige Startwertebestimmung für jeden Durchlauf<span class="in">:</span></span>
<span id="cb5-553"><a href="#cb5-553" aria-hidden="true" tabindex="-1"></a>       · a<span class="in">:</span> Zufallswert zwischen 0 und 30</span>
<span id="cb5-554"><a href="#cb5-554" aria-hidden="true" tabindex="-1"></a>       · k1<span class="in">:</span> Zufallswert zwischen 0<span class="fu">.1</span> und 3<span class="fu">.5</span></span>
<span id="cb5-555"><a href="#cb5-555" aria-hidden="true" tabindex="-1"></a>       · k2<span class="in">:</span> Zufallswert zwischen 0<span class="fu">.020</span> und 0<span class="fu">.200</span></span>
<span id="cb5-556"><a href="#cb5-556" aria-hidden="true" tabindex="-1"></a>       · BLC0<span class="in">:</span> Zufallswert zwischen der unteren und oberen BLC0-Grenze</span>
<span id="cb5-557"><a href="#cb5-557" aria-hidden="true" tabindex="-1"></a>     - Durchführung der nicht-linearen Regression<span class="in">:</span></span>
<span id="cb5-558"><a href="#cb5-558" aria-hidden="true" tabindex="-1"></a>       · Verwendung des Levenberg-Marquardt-Algorithmus</span>
<span id="cb5-559"><a href="#cb5-559" aria-hidden="true" tabindex="-1"></a>       · Maximale Iterationen<span class="in">:</span> <span class="op">*</span>1024<span class="op">*</span></span>
<span id="cb5-560"><a href="#cb5-560" aria-hidden="true" tabindex="-1"></a>     - Berechnung der Residuenquadratsumme <span class="in">(</span>RSS<span class="in">)</span> für jede Anpassung</span>
<span id="cb5-561"><a href="#cb5-561" aria-hidden="true" tabindex="-1"></a>     - Speicherung der besten Anpassung <span class="in">(</span>niedrigste RSS<span class="in">)</span></span>
<span id="cb5-562"><a href="#cb5-562" aria-hidden="true" tabindex="-1"></a>- Optimierung<span class="in">:</span> Minimierung der Residuenquadratsumme <span class="in">(</span>RSS<span class="in">)</span></span>
<span id="cb5-563"><a href="#cb5-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-564"><a href="#cb5-564" aria-hidden="true" tabindex="-1"></a><span class="in">:::</span></span>
<span id="cb5-565"><a href="#cb5-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-566"><a href="#cb5-566" aria-hidden="true" tabindex="-1"></a>## Blutlaktat-Bateman-Modellfunktion<span class="in">:</span> Während und nach dem Belastungszeitraum</span>
<span id="cb5-567"><a href="#cb5-567" aria-hidden="true" tabindex="-1"></a>In der folgenden Shiny-Anwendung wird die Laktatkinetik während und nach einer intensiven Belastung mithilfe der Bateman-Funktion modelliert. Diese mathematische Funktion beschreibt sowohl den Einstrom <span class="in">(</span>Invasion<span class="in">)</span> des Laktats aus der Muskulatur ins Blut als auch die gleichzeitige Elimination aus dem Blut. Der Konzentrationsverlauf zeigt nach Belastungsende zunächst einen Anstieg bis zu einem Maximum<span class="op">,</span> gefolgt von einem exponentiellen Abfall. Die Parameter k1 und k2 beschreiben dabei die Geschwindigkeitskonstanten für Invasion bzw. Elimination<span class="op">,</span> während der Parameter a die theoretische Gesamtmenge des zu eliminierenden Laktats darstellt <span class="ex">[</span><span class="ss">@Heck2022</span><span class="op">,</span>194].</span>
<span id="cb5-568"><a href="#cb5-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-569"><a href="#cb5-569" aria-hidden="true" tabindex="-1"></a>```{shinylive-r}</span>
<span id="cb5-570"><a href="#cb5-570" aria-hidden="true" tabindex="-1"></a>#<span class="op">|</span> standalone<span class="in">:</span> true</span>
<span id="cb5-571"><a href="#cb5-571" aria-hidden="true" tabindex="-1"></a>#<span class="op">|</span> viewerHeight<span class="in">:</span> 900</span>
<span id="cb5-572"><a href="#cb5-572" aria-hidden="true" tabindex="-1"></a>library<span class="in">(</span>shiny<span class="in">)</span></span>
<span id="cb5-573"><a href="#cb5-573" aria-hidden="true" tabindex="-1"></a>library<span class="in">(</span>plotly<span class="in">)</span></span>
<span id="cb5-574"><a href="#cb5-574" aria-hidden="true" tabindex="-1"></a>library<span class="in">(</span>minpack<span class="fu">.lm</span><span class="in">)</span></span>
<span id="cb5-575"><a href="#cb5-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-576"><a href="#cb5-576" aria-hidden="true" tabindex="-1"></a># Definiere Daten</span>
<span id="cb5-577"><a href="#cb5-577" aria-hidden="true" tabindex="-1"></a>t_min &lt;- c<span class="in">(</span>0<span class="fu">.4</span><span class="op">,</span> 3<span class="fu">.3</span><span class="op">,</span> 6<span class="fu">.5</span><span class="op">,</span> 8<span class="fu">.4</span><span class="op">,</span> 10<span class="fu">.2</span><span class="op">,</span> 12<span class="fu">.5</span><span class="op">,</span> 14<span class="fu">.9</span><span class="op">,</span> 16<span class="fu">.7</span><span class="op">,</span> 19<span class="fu">.3</span><span class="in">)</span></span>
<span id="cb5-578"><a href="#cb5-578" aria-hidden="true" tabindex="-1"></a>BLC_t &lt;- c<span class="in">(</span>0<span class="fu">.82</span><span class="op">,</span> 4<span class="fu">.53</span><span class="op">,</span> 6<span class="fu">.97</span><span class="op">,</span> 7<span class="fu">.52</span><span class="op">,</span> 7<span class="fu">.73</span><span class="op">,</span> 7<span class="fu">.28</span><span class="op">,</span> 6<span class="fu">.37</span><span class="op">,</span> 5<span class="fu">.41</span><span class="op">,</span> 4<span class="fu">.71</span><span class="in">)</span></span>
<span id="cb5-579"><a href="#cb5-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-580"><a href="#cb5-580" aria-hidden="true" tabindex="-1"></a># Normalisiere t_min<span class="op">,</span> wenn der kleinste Wert größer als 0<span class="fu">.0</span> ist</span>
<span id="cb5-581"><a href="#cb5-581" aria-hidden="true" tabindex="-1"></a>if <span class="in">(</span>min<span class="in">(</span>t_min<span class="in">)</span> <span class="op">&gt;</span> 0<span class="fu">.0</span><span class="in">)</span> {</span>
<span id="cb5-582"><a href="#cb5-582" aria-hidden="true" tabindex="-1"></a>  t_min &lt;- t_min - min(t_min)</span>
<span id="cb5-583"><a href="#cb5-583" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-584"><a href="#cb5-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-585"><a href="#cb5-585" aria-hidden="true" tabindex="-1"></a># Bateman-Funktion für Laktatwerte <span class="in">(</span>in Minuten<span class="in">)</span> mit BLC0</span>
<span id="cb5-586"><a href="#cb5-586" aria-hidden="true" tabindex="-1"></a>bateman_function &lt;- function<span class="in">(</span>t<span class="op">,</span> a<span class="op">,</span> k1<span class="op">,</span> k2<span class="op">,</span> BLC0<span class="in">)</span> {</span>
<span id="cb5-587"><a href="#cb5-587" aria-hidden="true" tabindex="-1"></a>  BLC0 <span class="op">+</span> <span class="in">(</span>a <span class="op">*</span> k1 / <span class="in">(</span>k2 - k1<span class="in">))</span> <span class="op">*</span> <span class="in">(</span>exp<span class="in">(</span>-k1 <span class="op">*</span> t<span class="in">)</span> - exp<span class="in">(</span>-k2 <span class="op">*</span> t<span class="in">))</span></span>
<span id="cb5-588"><a href="#cb5-588" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-589"><a href="#cb5-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-590"><a href="#cb5-590" aria-hidden="true" tabindex="-1"></a># Invasions- und Eliminationsfunktionen</span>
<span id="cb5-591"><a href="#cb5-591" aria-hidden="true" tabindex="-1"></a>invasion_function &lt;- function<span class="in">(</span>t<span class="op">,</span> a<span class="op">,</span> k1<span class="op">,</span> BLC0<span class="in">)</span> {</span>
<span id="cb5-592"><a href="#cb5-592" aria-hidden="true" tabindex="-1"></a>  BLC0 <span class="op">+</span> a <span class="op">*</span> <span class="in">(</span>1 - exp<span class="in">(</span>-k1 <span class="op">*</span> t<span class="in">))</span></span>
<span id="cb5-593"><a href="#cb5-593" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-594"><a href="#cb5-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-595"><a href="#cb5-595" aria-hidden="true" tabindex="-1"></a>elimination_function &lt;- function<span class="in">(</span>t<span class="op">,</span> a<span class="op">,</span> k2<span class="op">,</span> BLC0<span class="in">)</span> {</span>
<span id="cb5-596"><a href="#cb5-596" aria-hidden="true" tabindex="-1"></a>  BLC0 <span class="op">+</span> a <span class="op">*</span> exp<span class="in">(</span>-k2 <span class="op">*</span> t<span class="in">)</span></span>
<span id="cb5-597"><a href="#cb5-597" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-598"><a href="#cb5-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-599"><a href="#cb5-599" aria-hidden="true" tabindex="-1"></a># UI</span>
<span id="cb5-600"><a href="#cb5-600" aria-hidden="true" tabindex="-1"></a>ui &lt;- fluidPage<span class="in">(</span></span>
<span id="cb5-601"><a href="#cb5-601" aria-hidden="true" tabindex="-1"></a>  titlePanel<span class="in">(</span>"Bateman-Modellfunktion"<span class="in">)</span><span class="op">,</span></span>
<span id="cb5-602"><a href="#cb5-602" aria-hidden="true" tabindex="-1"></a>  fluidRow<span class="in">(</span></span>
<span id="cb5-603"><a href="#cb5-603" aria-hidden="true" tabindex="-1"></a>    column<span class="in">(</span>3<span class="op">,</span></span>
<span id="cb5-604"><a href="#cb5-604" aria-hidden="true" tabindex="-1"></a>           style = "height<span class="in">:</span> 90vh; overflow-y<span class="in">:</span> auto;"<span class="op">,</span></span>
<span id="cb5-605"><a href="#cb5-605" aria-hidden="true" tabindex="-1"></a>           </span>
<span id="cb5-606"><a href="#cb5-606" aria-hidden="true" tabindex="-1"></a>           tags$h4<span class="in">(</span>tags$strong<span class="in">(</span>"Modellparameter<span class="in">:</span>"<span class="in">))</span><span class="op">,</span></span>
<span id="cb5-607"><a href="#cb5-607" aria-hidden="true" tabindex="-1"></a>           sliderInput<span class="in">(</span>"a"<span class="op">,</span> "a <span class="ex">[</span><span class="ss">mmol/l</span><span class="ex">]</span>"<span class="op">,</span> min = 0<span class="fu">.0</span><span class="op">,</span> max = 30<span class="fu">.0</span><span class="op">,</span> value = 15<span class="fu">.0</span><span class="op">,</span> step = 0<span class="fu">.01</span><span class="in">)</span><span class="op">,</span></span>
<span id="cb5-608"><a href="#cb5-608" aria-hidden="true" tabindex="-1"></a>           sliderInput<span class="in">(</span>"k1"<span class="op">,</span> "k1 <span class="ex">[</span><span class="ss">min</span><span class="op">^</span><span class="ss">-1</span><span class="ex">]</span>"<span class="op">,</span> min = 0<span class="fu">.1</span><span class="op">,</span> max = 3<span class="fu">.5</span><span class="op">,</span> value = 0<span class="fu">.5</span><span class="op">,</span> step = 0<span class="fu">.001</span><span class="in">)</span><span class="op">,</span></span>
<span id="cb5-609"><a href="#cb5-609" aria-hidden="true" tabindex="-1"></a>           sliderInput<span class="in">(</span>"k2"<span class="op">,</span> "k2 <span class="ex">[</span><span class="ss">min</span><span class="op">^</span><span class="ss">-1</span><span class="ex">]</span>"<span class="op">,</span> min = 0<span class="fu">.020</span><span class="op">,</span> max = 0<span class="fu">.200</span><span class="op">,</span> value = 0<span class="fu">.10</span><span class="op">,</span> step = 0<span class="fu">.001</span><span class="in">)</span><span class="op">,</span></span>
<span id="cb5-610"><a href="#cb5-610" aria-hidden="true" tabindex="-1"></a>           sliderInput<span class="in">(</span>"BLC0"<span class="op">,</span> "BLC0 <span class="ex">[</span><span class="ss">mmol/l</span><span class="ex">]</span>"<span class="op">,</span> min = 0<span class="fu">.0</span><span class="op">,</span> max = 5<span class="fu">.0</span><span class="op">,</span> value = 1<span class="fu">.0</span><span class="op">,</span> step = 0<span class="fu">.01</span><span class="in">)</span><span class="op">,</span></span>
<span id="cb5-611"><a href="#cb5-611" aria-hidden="true" tabindex="-1"></a>           actionButton<span class="in">(</span>"optimize"<span class="op">,</span> "Fit<span class="in">:</span> nlsLM"<span class="in">)</span><span class="op">,</span> </span>
<span id="cb5-612"><a href="#cb5-612" aria-hidden="true" tabindex="-1"></a>           br<span class="in">()</span><span class="op">,</span> br<span class="in">()</span><span class="op">,</span></span>
<span id="cb5-613"><a href="#cb5-613" aria-hidden="true" tabindex="-1"></a>           fileInput<span class="in">(</span>"file_upload"<span class="op">,</span> "CSV-Datei hochladen"<span class="op">,</span> accept = "<span class="fu">.csv</span>"<span class="in">)</span></span>
<span id="cb5-614"><a href="#cb5-614" aria-hidden="true" tabindex="-1"></a>    <span class="in">)</span><span class="op">,</span></span>
<span id="cb5-615"><a href="#cb5-615" aria-hidden="true" tabindex="-1"></a>    mainPanel<span class="in">(</span></span>
<span id="cb5-616"><a href="#cb5-616" aria-hidden="true" tabindex="-1"></a>      width = 9<span class="op">,</span></span>
<span id="cb5-617"><a href="#cb5-617" aria-hidden="true" tabindex="-1"></a>      plotlyOutput<span class="in">(</span>"plot"<span class="in">)</span><span class="op">,</span></span>
<span id="cb5-618"><a href="#cb5-618" aria-hidden="true" tabindex="-1"></a>      uiOutput<span class="in">(</span>"instructions"<span class="in">)</span></span>
<span id="cb5-619"><a href="#cb5-619" aria-hidden="true" tabindex="-1"></a>    <span class="in">)</span></span>
<span id="cb5-620"><a href="#cb5-620" aria-hidden="true" tabindex="-1"></a>  <span class="in">)</span></span>
<span id="cb5-621"><a href="#cb5-621" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb5-622"><a href="#cb5-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-623"><a href="#cb5-623" aria-hidden="true" tabindex="-1"></a># Server-Logik</span>
<span id="cb5-624"><a href="#cb5-624" aria-hidden="true" tabindex="-1"></a>server &lt;- function<span class="in">(</span>input<span class="op">,</span> output<span class="op">,</span> session<span class="in">)</span> {</span>
<span id="cb5-625"><a href="#cb5-625" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-626"><a href="#cb5-626" aria-hidden="true" tabindex="-1"></a>  # Reaktiver Wert für hochgeladene Daten</span>
<span id="cb5-627"><a href="#cb5-627" aria-hidden="true" tabindex="-1"></a>  uploaded_data &lt;- reactiveVal<span class="in">(</span>NULL<span class="in">)</span></span>
<span id="cb5-628"><a href="#cb5-628" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-629"><a href="#cb5-629" aria-hidden="true" tabindex="-1"></a>  # Beobachter für CSV-Upload</span>
<span id="cb5-630"><a href="#cb5-630" aria-hidden="true" tabindex="-1"></a>  observeEvent<span class="in">(</span>input$file_upload<span class="op">,</span> <span class="er">{</span></span>
<span id="cb5-631"><a href="#cb5-631" aria-hidden="true" tabindex="-1"></a>    req(input$file_upload)</span>
<span id="cb5-632"><a href="#cb5-632" aria-hidden="true" tabindex="-1"></a>    df &lt;- read<span class="fu">.csv</span><span class="in">(</span>input$file_upload$datapath<span class="in">)</span></span>
<span id="cb5-633"><a href="#cb5-633" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-634"><a href="#cb5-634" aria-hidden="true" tabindex="-1"></a>    if <span class="in">(</span>"t_min" %in% names<span class="in">(</span>df<span class="in">)</span> <span class="op">&amp;&amp;</span> "BLC_t" %in% names<span class="in">(</span>df<span class="in">))</span> {</span>
<span id="cb5-635"><a href="#cb5-635" aria-hidden="true" tabindex="-1"></a>      if (df$t_min<span class="ex">[</span><span class="ss">1</span><span class="ex">]</span> != 0<span class="fu">.0</span>) {</span>
<span id="cb5-636"><a href="#cb5-636" aria-hidden="true" tabindex="-1"></a>        df$t_min &lt;- df$t_min - df$t_min<span class="ex">[</span><span class="ss">1</span><span class="ex">]</span></span>
<span id="cb5-637"><a href="#cb5-637" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb5-638"><a href="#cb5-638" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-639"><a href="#cb5-639" aria-hidden="true" tabindex="-1"></a>      uploaded_data(df)</span>
<span id="cb5-640"><a href="#cb5-640" aria-hidden="true" tabindex="-1"></a>    } else {</span>
<span id="cb5-641"><a href="#cb5-641" aria-hidden="true" tabindex="-1"></a>      showModal(modalDialog(</span>
<span id="cb5-642"><a href="#cb5-642" aria-hidden="true" tabindex="-1"></a>        title = "Ungültige CSV"<span class="op">,</span></span>
<span id="cb5-643"><a href="#cb5-643" aria-hidden="true" tabindex="-1"></a>        "Die CSV-Datei muss 't_min' und 'BLC_t' als Spaltennamen enthalten."<span class="op">,</span></span>
<span id="cb5-644"><a href="#cb5-644" aria-hidden="true" tabindex="-1"></a>        easyClose = TRUE<span class="op">,</span></span>
<span id="cb5-645"><a href="#cb5-645" aria-hidden="true" tabindex="-1"></a>        footer = NULL</span>
<span id="cb5-646"><a href="#cb5-646" aria-hidden="true" tabindex="-1"></a>      ))</span>
<span id="cb5-647"><a href="#cb5-647" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-648"><a href="#cb5-648" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb5-649"><a href="#cb5-649" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-650"><a href="#cb5-650" aria-hidden="true" tabindex="-1"></a>  observeEvent<span class="in">(</span>input$optimize<span class="op">,</span> <span class="er">{</span></span>
<span id="cb5-651"><a href="#cb5-651" aria-hidden="true" tabindex="-1"></a>    data &lt;- if (is<span class="fu">.null</span><span class="in">(</span>uploaded_data<span class="in">())</span>) {</span>
<span id="cb5-652"><a href="#cb5-652" aria-hidden="true" tabindex="-1"></a>      data<span class="fu">.frame</span><span class="in">(</span>t_min = t_min<span class="op">,</span> BLC_t = BLC_t<span class="in">)</span></span>
<span id="cb5-653"><a href="#cb5-653" aria-hidden="true" tabindex="-1"></a>    } else {</span>
<span id="cb5-654"><a href="#cb5-654" aria-hidden="true" tabindex="-1"></a>      uploaded_data()</span>
<span id="cb5-655"><a href="#cb5-655" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-656"><a href="#cb5-656" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-657"><a href="#cb5-657" aria-hidden="true" tabindex="-1"></a>    # Setze BLC0 Grenzen basierend auf dem ersten BLC_t Wert</span>
<span id="cb5-658"><a href="#cb5-658" aria-hidden="true" tabindex="-1"></a>    BLC0_lower &lt;- max<span class="in">(</span>0<span class="op">,</span> data$BLC_t<span class="ex">[</span><span class="ss">1</span><span class="ex">]</span> <span class="op">*</span> 0<span class="fu">.9</span><span class="in">)</span></span>
<span id="cb5-659"><a href="#cb5-659" aria-hidden="true" tabindex="-1"></a>    BLC0_upper &lt;- min<span class="in">(</span>5<span class="op">,</span> data$BLC_t<span class="ex">[</span><span class="ss">1</span><span class="ex">]</span> <span class="op">*</span> 1<span class="fu">.1</span><span class="in">)</span></span>
<span id="cb5-660"><a href="#cb5-660" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-661"><a href="#cb5-661" aria-hidden="true" tabindex="-1"></a>    best_fit &lt;- NULL</span>
<span id="cb5-662"><a href="#cb5-662" aria-hidden="true" tabindex="-1"></a>    best_rss &lt;- Inf</span>
<span id="cb5-663"><a href="#cb5-663" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-664"><a href="#cb5-664" aria-hidden="true" tabindex="-1"></a>    withProgress<span class="in">(</span>message = 'Fitting in progress'<span class="op">,</span> value = 0<span class="op">,</span> <span class="er">{</span></span>
<span id="cb5-665"><a href="#cb5-665" aria-hidden="true" tabindex="-1"></a>      for (i in 1<span class="ch">:</span><span class="dv">100</span>) {</span>
<span id="cb5-666"><a href="#cb5-666" aria-hidden="true" tabindex="-1"></a>        # <span class="dv">Randomisierte Startwerte</span></span>
<span id="cb5-667"><a href="#cb5-667" aria-hidden="true" tabindex="-1"></a>        <span class="dv">a_start </span>&lt;<span class="dv">- </span>runif<span class="fu">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">30</span><span class="fu">)</span></span>
<span id="cb5-668"><a href="#cb5-668" aria-hidden="true" tabindex="-1"></a>        <span class="dv">k1_start </span>&lt;<span class="dv">- </span>runif<span class="fu">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">0.1</span><span class="op">,</span> <span class="dv">3.5</span><span class="fu">)</span></span>
<span id="cb5-669"><a href="#cb5-669" aria-hidden="true" tabindex="-1"></a>        <span class="dv">k2_start </span>&lt;<span class="dv">- </span>runif<span class="fu">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">0.020</span><span class="op">,</span> <span class="dv">0.200</span><span class="fu">)</span></span>
<span id="cb5-670"><a href="#cb5-670" aria-hidden="true" tabindex="-1"></a>        <span class="dv">BLC0_start </span>&lt;<span class="dv">- </span>runif<span class="fu">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">BLC0_lower</span><span class="op">,</span> <span class="dv">BLC0_upper</span><span class="fu">)</span></span>
<span id="cb5-671"><a href="#cb5-671" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-672"><a href="#cb5-672" aria-hidden="true" tabindex="-1"></a>        <span class="dv">start_values </span>&lt;<span class="dv">- </span>list<span class="fu">(</span><span class="dv">a </span>= <span class="dv">a_start</span><span class="op">,</span> <span class="dv">k1 </span>= <span class="dv">k1_start</span><span class="op">,</span> <span class="dv">k2 </span>= <span class="dv">k2_start</span><span class="op">,</span> <span class="dv">BLC0 </span>= <span class="dv">BLC0_start</span><span class="fu">)</span></span>
<span id="cb5-673"><a href="#cb5-673" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-674"><a href="#cb5-674" aria-hidden="true" tabindex="-1"></a>        <span class="dv">model_equation </span>&lt;<span class="dv">- BLC_t </span>~ <span class="dv">BLC0 </span>+ <span class="fu">(</span><span class="dv">a </span>* <span class="dv">k1 </span>/ <span class="fu">(</span><span class="dv">k2 - k1</span><span class="fu">))</span> * <span class="fu">(exp(</span><span class="dv">-k1 </span>* <span class="dv">t_min</span><span class="fu">)</span> <span class="dv">- </span><span class="fu">exp(</span><span class="dv">-k2 </span>* <span class="dv">t_min</span><span class="fu">))</span></span>
<span id="cb5-675"><a href="#cb5-675" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-676"><a href="#cb5-676" aria-hidden="true" tabindex="-1"></a>        <span class="dv">fit </span>&lt;<span class="dv">- </span>try<span class="fu">(</span>nlsLM<span class="fu">(</span><span class="dv">model_equation</span><span class="op">,</span></span>
<span id="cb5-677"><a href="#cb5-677" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">data </span>= <span class="dv">data</span><span class="op">,</span></span>
<span id="cb5-678"><a href="#cb5-678" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">start</span> = <span class="dv">start_values</span><span class="op">,</span></span>
<span id="cb5-679"><a href="#cb5-679" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">lower </span>= c<span class="fu">(</span><span class="dv">a </span>= <span class="dv">0.0</span><span class="op">,</span> <span class="dv">k1 </span>= <span class="dv">0.1</span><span class="op">,</span> <span class="dv">k2 </span>= <span class="dv">0.020</span><span class="op">,</span> <span class="dv">BLC0 </span>= <span class="dv">BLC0_lower</span><span class="fu">)</span><span class="op">,</span></span>
<span id="cb5-680"><a href="#cb5-680" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">upper </span>= c<span class="fu">(</span><span class="dv">a </span>= <span class="dv">30.0</span><span class="op">,</span> <span class="dv">k1 </span>= <span class="dv">3.5</span><span class="op">,</span> <span class="dv">k2 </span>= <span class="dv">0.200</span><span class="op">,</span> <span class="dv">BLC0 </span>= <span class="dv">BLC0_upper</span><span class="fu">)</span><span class="op">,</span></span>
<span id="cb5-681"><a href="#cb5-681" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">control </span>= <span class="dv">nls</span>.control<span class="fu">(</span><span class="dv">maxiter </span>= <span class="dv">1024</span><span class="fu">))</span><span class="op">,</span> <span class="dv">silent </span>= <span class="dv">TRUE</span><span class="fu">)</span></span>
<span id="cb5-682"><a href="#cb5-682" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-683"><a href="#cb5-683" aria-hidden="true" tabindex="-1"></a>        <span class="dv">if </span><span class="fu">(</span><span class="at">!</span>inherits<span class="fu">(</span><span class="dv">fit</span><span class="op">,</span> <span class="st">"try-error"</span><span class="fu">))</span> {</span>
<span id="cb5-684"><a href="#cb5-684" aria-hidden="true" tabindex="-1"></a>          <span class="dv">rss </span>&lt;<span class="dv">- </span>sum<span class="fu">(</span>residuals<span class="fu">(</span><span class="dv">fit</span><span class="fu">)</span>^<span class="dv">2</span><span class="fu">)</span></span>
<span id="cb5-685"><a href="#cb5-685" aria-hidden="true" tabindex="-1"></a>          <span class="dv">if </span><span class="fu">(</span><span class="dv">rss </span>&lt; <span class="dv">best_rss</span><span class="fu">)</span> {</span>
<span id="cb5-686"><a href="#cb5-686" aria-hidden="true" tabindex="-1"></a>            <span class="dv">best_rss </span>&lt;<span class="dv">- rss</span></span>
<span id="cb5-687"><a href="#cb5-687" aria-hidden="true" tabindex="-1"></a>            <span class="dv">best_fit </span>&lt;<span class="dv">- fit</span></span>
<span id="cb5-688"><a href="#cb5-688" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb5-689"><a href="#cb5-689" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb5-690"><a href="#cb5-690" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-691"><a href="#cb5-691" aria-hidden="true" tabindex="-1"></a>        incProgress<span class="in">(</span>1/100<span class="op">,</span> detail = paste<span class="in">(</span>"Iteration"<span class="op">,</span> i<span class="in">))</span></span>
<span id="cb5-692"><a href="#cb5-692" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb5-693"><a href="#cb5-693" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb5-694"><a href="#cb5-694" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-695"><a href="#cb5-695" aria-hidden="true" tabindex="-1"></a>    if <span class="in">(</span>!is<span class="fu">.null</span><span class="in">(</span>best_fit<span class="in">))</span> {</span>
<span id="cb5-696"><a href="#cb5-696" aria-hidden="true" tabindex="-1"></a>      params &lt;- as<span class="fu">.list</span><span class="in">(</span>coef<span class="in">(</span>best_fit<span class="in">))</span></span>
<span id="cb5-697"><a href="#cb5-697" aria-hidden="true" tabindex="-1"></a>      updateSliderInput<span class="in">(</span>session<span class="op">,</span> "a"<span class="op">,</span> value = params$a<span class="in">)</span></span>
<span id="cb5-698"><a href="#cb5-698" aria-hidden="true" tabindex="-1"></a>      updateSliderInput<span class="in">(</span>session<span class="op">,</span> "k1"<span class="op">,</span> value = params$k1<span class="in">)</span></span>
<span id="cb5-699"><a href="#cb5-699" aria-hidden="true" tabindex="-1"></a>      updateSliderInput<span class="in">(</span>session<span class="op">,</span> "k2"<span class="op">,</span> value = params$k2<span class="in">)</span></span>
<span id="cb5-700"><a href="#cb5-700" aria-hidden="true" tabindex="-1"></a>      updateSliderInput<span class="in">(</span>session<span class="op">,</span> "BLC0"<span class="op">,</span> value = params$BLC0<span class="in">)</span></span>
<span id="cb5-701"><a href="#cb5-701" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-702"><a href="#cb5-702" aria-hidden="true" tabindex="-1"></a>      showNotification<span class="in">(</span>"Fitting completed successfully!"<span class="op">,</span> type = "message"<span class="in">)</span></span>
<span id="cb5-703"><a href="#cb5-703" aria-hidden="true" tabindex="-1"></a>    } else {</span>
<span id="cb5-704"><a href="#cb5-704" aria-hidden="true" tabindex="-1"></a>      showModal(modalDialog(</span>
<span id="cb5-705"><a href="#cb5-705" aria-hidden="true" tabindex="-1"></a>        title = "nlsLM fehlgeschlagen"<span class="op">,</span></span>
<span id="cb5-706"><a href="#cb5-706" aria-hidden="true" tabindex="-1"></a>        "Die nicht-lineare Regression mit dem Levenberg-Marquardt-Algorithmus konnte nicht erfolgreich durchgeführt werden."<span class="op">,</span></span>
<span id="cb5-707"><a href="#cb5-707" aria-hidden="true" tabindex="-1"></a>        easyClose = TRUE<span class="op">,</span></span>
<span id="cb5-708"><a href="#cb5-708" aria-hidden="true" tabindex="-1"></a>        footer = NULL</span>
<span id="cb5-709"><a href="#cb5-709" aria-hidden="true" tabindex="-1"></a>      ))</span>
<span id="cb5-710"><a href="#cb5-710" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-711"><a href="#cb5-711" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb5-712"><a href="#cb5-712" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-713"><a href="#cb5-713" aria-hidden="true" tabindex="-1"></a>  output$plot &lt;- renderPlotly<span class="in">(</span><span class="er">{</span></span>
<span id="cb5-714"><a href="#cb5-714" aria-hidden="true" tabindex="-1"></a>    a &lt;- input$a</span>
<span id="cb5-715"><a href="#cb5-715" aria-hidden="true" tabindex="-1"></a>    k1 &lt;- input$k1</span>
<span id="cb5-716"><a href="#cb5-716" aria-hidden="true" tabindex="-1"></a>    k2 &lt;- input$k2</span>
<span id="cb5-717"><a href="#cb5-717" aria-hidden="true" tabindex="-1"></a>    BLC0 &lt;- input$BLC0</span>
<span id="cb5-718"><a href="#cb5-718" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-719"><a href="#cb5-719" aria-hidden="true" tabindex="-1"></a>    data &lt;- if (is<span class="fu">.null</span><span class="in">(</span>uploaded_data<span class="in">())</span>) {</span>
<span id="cb5-720"><a href="#cb5-720" aria-hidden="true" tabindex="-1"></a>      data<span class="fu">.frame</span><span class="in">(</span>t_min = t_min<span class="op">,</span> BLC_t = BLC_t<span class="in">)</span></span>
<span id="cb5-721"><a href="#cb5-721" aria-hidden="true" tabindex="-1"></a>    } else {</span>
<span id="cb5-722"><a href="#cb5-722" aria-hidden="true" tabindex="-1"></a>      uploaded_data()</span>
<span id="cb5-723"><a href="#cb5-723" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-724"><a href="#cb5-724" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-725"><a href="#cb5-725" aria-hidden="true" tabindex="-1"></a>    max_x &lt;- max(data$t_min) <span class="op">*</span> 1<span class="fu">.66</span></span>
<span id="cb5-726"><a href="#cb5-726" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-727"><a href="#cb5-727" aria-hidden="true" tabindex="-1"></a>    t_min_modell &lt;- seq<span class="in">(</span>0<span class="op">,</span> max_x<span class="op">,</span> length<span class="fu">.out</span> = 1000<span class="in">)</span></span>
<span id="cb5-728"><a href="#cb5-728" aria-hidden="true" tabindex="-1"></a>    BLC_t_modell &lt;- bateman_function<span class="in">(</span>t_min_modell<span class="op">,</span> a<span class="op">,</span> k1<span class="op">,</span> k2<span class="op">,</span> BLC0<span class="in">)</span></span>
<span id="cb5-729"><a href="#cb5-729" aria-hidden="true" tabindex="-1"></a>    invasion_modell &lt;- invasion_function<span class="in">(</span>t_min_modell<span class="op">,</span> a<span class="op">,</span> k1<span class="op">,</span> BLC0<span class="in">)</span></span>
<span id="cb5-730"><a href="#cb5-730" aria-hidden="true" tabindex="-1"></a>    elimination_modell &lt;- elimination_function<span class="in">(</span>t_min_modell<span class="op">,</span> a<span class="op">,</span> k2<span class="op">,</span> BLC0<span class="in">)</span></span>
<span id="cb5-731"><a href="#cb5-731" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-732"><a href="#cb5-732" aria-hidden="true" tabindex="-1"></a>    max_y &lt;- max<span class="in">(</span>max<span class="in">(</span>BLC_t_modell<span class="in">)</span> <span class="op">*</span> 1<span class="fu">.2</span><span class="op">,</span> max<span class="in">(</span>data$BLC_t<span class="in">)</span> <span class="op">*</span> 1<span class="fu">.2</span><span class="op">,</span> max<span class="in">(</span>invasion_modell<span class="in">)</span> <span class="op">*</span> 1<span class="fu">.2</span><span class="op">,</span> max<span class="in">(</span>elimination_modell<span class="in">)</span> <span class="op">*</span> 1<span class="fu">.2</span><span class="in">)</span></span>
<span id="cb5-733"><a href="#cb5-733" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-734"><a href="#cb5-734" aria-hidden="true" tabindex="-1"></a>    # Berechne tmax und Lamax</span>
<span id="cb5-735"><a href="#cb5-735" aria-hidden="true" tabindex="-1"></a>    tmax &lt;- log<span class="in">(</span>k1/k2<span class="in">)</span> / <span class="in">(</span>k1 - k2<span class="in">)</span></span>
<span id="cb5-736"><a href="#cb5-736" aria-hidden="true" tabindex="-1"></a>    Lamax &lt;- bateman_function<span class="in">(</span>tmax<span class="op">,</span> a<span class="op">,</span> k1<span class="op">,</span> k2<span class="op">,</span> BLC0<span class="in">)</span></span>
<span id="cb5-737"><a href="#cb5-737" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-738"><a href="#cb5-738" aria-hidden="true" tabindex="-1"></a>    # Erstelle Gleichungstext</span>
<span id="cb5-739"><a href="#cb5-739" aria-hidden="true" tabindex="-1"></a>    eq_text &lt;- sprintf<span class="in">(</span>"<span class="ex">[</span><span class="ss">La</span><span class="ex">]</span>&lt;sub<span class="op">&gt;</span>b&lt;/sub<span class="op">&gt;</span><span class="in">(</span>t<span class="in">)</span> = %<span class="fu">.2f</span> <span class="op">+</span> <span class="in">(</span>%<span class="fu">.2f</span> <span class="op">*</span> %<span class="fu">.3f</span> / <span class="in">(</span>%<span class="fu">.3f</span> - %<span class="fu">.3f</span><span class="in">))</span> <span class="op">*</span> <span class="in">(</span>e&lt;sup<span class="op">&gt;</span>-%<span class="fu">.3f</span><span class="op">*</span>t&lt;/sup<span class="op">&gt;</span> - e&lt;sup<span class="op">&gt;</span>-%<span class="fu">.3f</span><span class="op">*</span>t&lt;/sup<span class="op">&gt;</span><span class="in">)</span>"<span class="op">,</span> </span>
<span id="cb5-740"><a href="#cb5-740" aria-hidden="true" tabindex="-1"></a>                       BLC0<span class="op">,</span> a<span class="op">,</span> k1<span class="op">,</span> k2<span class="op">,</span> k1<span class="op">,</span> k1<span class="op">,</span> k2<span class="in">)</span></span>
<span id="cb5-741"><a href="#cb5-741" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-742"><a href="#cb5-742" aria-hidden="true" tabindex="-1"></a>    # Berechne R²</span>
<span id="cb5-743"><a href="#cb5-743" aria-hidden="true" tabindex="-1"></a>    BLC_t_modell_at_data &lt;- bateman_function<span class="in">(</span>data$t_min<span class="op">,</span> a<span class="op">,</span> k1<span class="op">,</span> k2<span class="op">,</span> BLC0<span class="in">)</span></span>
<span id="cb5-744"><a href="#cb5-744" aria-hidden="true" tabindex="-1"></a>    ss_res &lt;- sum<span class="in">((</span>data$BLC_t - BLC_t_modell_at_data<span class="in">)</span>^2<span class="in">)</span></span>
<span id="cb5-745"><a href="#cb5-745" aria-hidden="true" tabindex="-1"></a>    ss_tot &lt;- sum<span class="in">((</span>data$BLC_t - mean<span class="in">(</span>data$BLC_t<span class="in">))</span>^2<span class="in">)</span></span>
<span id="cb5-746"><a href="#cb5-746" aria-hidden="true" tabindex="-1"></a>    r_squared &lt;- 1 - <span class="in">(</span>ss_res / ss_tot<span class="in">)</span></span>
<span id="cb5-747"><a href="#cb5-747" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-748"><a href="#cb5-748" aria-hidden="true" tabindex="-1"></a>    # Plotly-Plot</span>
<span id="cb5-749"><a href="#cb5-749" aria-hidden="true" tabindex="-1"></a>    p &lt;- plot_ly<span class="in">()</span> %<span class="op">&gt;</span>%</span>
<span id="cb5-750"><a href="#cb5-750" aria-hidden="true" tabindex="-1"></a>      add_trace<span class="in">(</span>x = t_min_modell<span class="op">,</span> y = BLC_t_modell<span class="op">,</span> type = 'scatter'<span class="op">,</span> mode = 'lines'<span class="op">,</span> </span>
<span id="cb5-751"><a href="#cb5-751" aria-hidden="true" tabindex="-1"></a>                name = 'Bateman-Funktion'<span class="op">,</span> line = list<span class="in">(</span>color = '<span class="pp">#EF5350</span>'<span class="in">))</span> %<span class="op">&gt;</span>%</span>
<span id="cb5-752"><a href="#cb5-752" aria-hidden="true" tabindex="-1"></a>      add_trace<span class="in">(</span>x = t_min_modell<span class="op">,</span> y = invasion_modell<span class="op">,</span> type = 'scatter'<span class="op">,</span> mode = 'lines'<span class="op">,</span> </span>
<span id="cb5-753"><a href="#cb5-753" aria-hidden="true" tabindex="-1"></a>                name = 'Invasion'<span class="op">,</span> line = list<span class="in">(</span>color = "<span class="pp">#9C85C0</span>"<span class="op">,</span> width = 2<span class="op">,</span> dash = '8 5'<span class="in">)</span><span class="op">,</span></span>
<span id="cb5-754"><a href="#cb5-754" aria-hidden="true" tabindex="-1"></a>                opacity = 0<span class="fu">.65</span><span class="in">)</span> %<span class="op">&gt;</span>%</span>
<span id="cb5-755"><a href="#cb5-755" aria-hidden="true" tabindex="-1"></a>      add_trace<span class="in">(</span>x = t_min_modell<span class="op">,</span> y = elimination_modell<span class="op">,</span> type = 'scatter'<span class="op">,</span> mode = 'lines'<span class="op">,</span> </span>
<span id="cb5-756"><a href="#cb5-756" aria-hidden="true" tabindex="-1"></a>                name = 'Elimination'<span class="op">,</span> line = list<span class="in">(</span>color = '<span class="pp">#2683C6</span>'<span class="op">,</span> width = 2<span class="op">,</span> dash = '8 5'<span class="in">)</span><span class="op">,</span></span>
<span id="cb5-757"><a href="#cb5-757" aria-hidden="true" tabindex="-1"></a>                opacity = 0<span class="fu">.65</span><span class="in">)</span> %<span class="op">&gt;</span>%</span>
<span id="cb5-758"><a href="#cb5-758" aria-hidden="true" tabindex="-1"></a>      add_trace<span class="in">(</span>x = data$t_min<span class="op">,</span> y = data$BLC_t<span class="op">,</span> type = 'scatter'<span class="op">,</span> mode = 'markers'<span class="op">,</span> </span>
<span id="cb5-759"><a href="#cb5-759" aria-hidden="true" tabindex="-1"></a>                name = 'Gemessene BLC-Werte'<span class="op">,</span> marker = list<span class="in">(</span>color = "<span class="pp">#42BA97</span>"<span class="op">,</span> size = 9<span class="op">,</span> symbol = 'x'<span class="in">))</span> %<span class="op">&gt;</span>%</span>
<span id="cb5-760"><a href="#cb5-760" aria-hidden="true" tabindex="-1"></a>      add_segments<span class="in">(</span>x = tmax<span class="op">,</span> xend = tmax<span class="op">,</span> y = 0<span class="op">,</span> yend = max_y<span class="op">,</span> </span>
<span id="cb5-761"><a href="#cb5-761" aria-hidden="true" tabindex="-1"></a>                   line = list<span class="in">(</span>color = 'darkgrey'<span class="op">,</span> width = 1<span class="op">,</span> dash = 'dash'<span class="in">)</span><span class="op">,</span> </span>
<span id="cb5-762"><a href="#cb5-762" aria-hidden="true" tabindex="-1"></a>                   showlegend = FALSE<span class="op">,</span> opacity = 0<span class="fu">.5</span><span class="in">)</span> %<span class="op">&gt;</span>%</span>
<span id="cb5-763"><a href="#cb5-763" aria-hidden="true" tabindex="-1"></a>      add_segments<span class="in">(</span>x = 0<span class="op">,</span> xend = max_x<span class="op">,</span> y = Lamax<span class="op">,</span> yend = Lamax<span class="op">,</span> </span>
<span id="cb5-764"><a href="#cb5-764" aria-hidden="true" tabindex="-1"></a>                   line = list<span class="in">(</span>color = 'darkgrey'<span class="op">,</span> width = 1<span class="op">,</span> dash = 'dash'<span class="in">)</span><span class="op">,</span> </span>
<span id="cb5-765"><a href="#cb5-765" aria-hidden="true" tabindex="-1"></a>                   showlegend = FALSE<span class="op">,</span> opacity = 0<span class="fu">.5</span><span class="in">)</span> %<span class="op">&gt;</span>%</span>
<span id="cb5-766"><a href="#cb5-766" aria-hidden="true" tabindex="-1"></a>      layout<span class="in">(</span></span>
<span id="cb5-767"><a href="#cb5-767" aria-hidden="true" tabindex="-1"></a>        title = "Bateman-Funktion für Laktat-Modellierung"<span class="op">,</span></span>
<span id="cb5-768"><a href="#cb5-768" aria-hidden="true" tabindex="-1"></a>        margin = list<span class="in">(</span>t = 40<span class="in">)</span><span class="op">,</span></span>
<span id="cb5-769"><a href="#cb5-769" aria-hidden="true" tabindex="-1"></a>        xaxis = list<span class="in">(</span>title = "Zeit <span class="ex">[</span><span class="ss">min</span><span class="ex">]</span>"<span class="op">,</span> range = c<span class="in">(</span>0<span class="op">,</span> max_x<span class="in">))</span><span class="op">,</span></span>
<span id="cb5-770"><a href="#cb5-770" aria-hidden="true" tabindex="-1"></a>        yaxis = list<span class="in">(</span>title = "Laktat <span class="ex">[</span><span class="ss">mmol/l</span><span class="ex">]</span>"<span class="op">,</span> range = c<span class="in">(</span>0<span class="op">,</span> max_y<span class="in">))</span><span class="op">,</span></span>
<span id="cb5-771"><a href="#cb5-771" aria-hidden="true" tabindex="-1"></a>        legend = list<span class="in">(</span></span>
<span id="cb5-772"><a href="#cb5-772" aria-hidden="true" tabindex="-1"></a>          x = 0<span class="fu">.01</span><span class="op">,</span></span>
<span id="cb5-773"><a href="#cb5-773" aria-hidden="true" tabindex="-1"></a>          y = 0<span class="fu">.99</span><span class="op">,</span></span>
<span id="cb5-774"><a href="#cb5-774" aria-hidden="true" tabindex="-1"></a>          xanchor = "left"<span class="op">,</span></span>
<span id="cb5-775"><a href="#cb5-775" aria-hidden="true" tabindex="-1"></a>          yanchor = "top"<span class="op">,</span></span>
<span id="cb5-776"><a href="#cb5-776" aria-hidden="true" tabindex="-1"></a>          bgcolor = "rgba<span class="in">(</span>255<span class="op">,</span> 255<span class="op">,</span> 255<span class="op">,</span> 0<span class="fu">.2</span><span class="in">)</span>"<span class="op">,</span></span>
<span id="cb5-777"><a href="#cb5-777" aria-hidden="true" tabindex="-1"></a>          bordercolor = "rgba<span class="in">(</span>0<span class="op">,</span>0<span class="op">,</span>0<span class="op">,</span>0<span class="in">)</span>"<span class="op">,</span></span>
<span id="cb5-778"><a href="#cb5-778" aria-hidden="true" tabindex="-1"></a>          borderwidth = 0</span>
<span id="cb5-779"><a href="#cb5-779" aria-hidden="true" tabindex="-1"></a>        <span class="in">)</span><span class="op">,</span></span>
<span id="cb5-780"><a href="#cb5-780" aria-hidden="true" tabindex="-1"></a>        annotations = list<span class="in">(</span></span>
<span id="cb5-781"><a href="#cb5-781" aria-hidden="true" tabindex="-1"></a>          list<span class="in">(</span></span>
<span id="cb5-782"><a href="#cb5-782" aria-hidden="true" tabindex="-1"></a>            x = max_x <span class="op">*</span> 0<span class="fu">.3</span><span class="op">,</span> </span>
<span id="cb5-783"><a href="#cb5-783" aria-hidden="true" tabindex="-1"></a>            y = max_y <span class="op">*</span> 0<span class="fu">.90</span><span class="op">,</span></span>
<span id="cb5-784"><a href="#cb5-784" aria-hidden="true" tabindex="-1"></a>            text = eq_text<span class="op">,</span></span>
<span id="cb5-785"><a href="#cb5-785" aria-hidden="true" tabindex="-1"></a>            showarrow = FALSE<span class="op">,</span></span>
<span id="cb5-786"><a href="#cb5-786" aria-hidden="true" tabindex="-1"></a>            xanchor = 'left'<span class="op">,</span></span>
<span id="cb5-787"><a href="#cb5-787" aria-hidden="true" tabindex="-1"></a>            yanchor = 'bottom'<span class="op">,</span></span>
<span id="cb5-788"><a href="#cb5-788" aria-hidden="true" tabindex="-1"></a>            font = list<span class="in">(</span></span>
<span id="cb5-789"><a href="#cb5-789" aria-hidden="true" tabindex="-1"></a>              size = 12<span class="op">,</span></span>
<span id="cb5-790"><a href="#cb5-790" aria-hidden="true" tabindex="-1"></a>              color = "black"</span>
<span id="cb5-791"><a href="#cb5-791" aria-hidden="true" tabindex="-1"></a>            <span class="in">)</span></span>
<span id="cb5-792"><a href="#cb5-792" aria-hidden="true" tabindex="-1"></a>          <span class="in">)</span><span class="op">,</span></span>
<span id="cb5-793"><a href="#cb5-793" aria-hidden="true" tabindex="-1"></a>          list<span class="in">(</span></span>
<span id="cb5-794"><a href="#cb5-794" aria-hidden="true" tabindex="-1"></a>            x = max_x <span class="op">*</span> 0<span class="fu">.3</span><span class="op">,</span></span>
<span id="cb5-795"><a href="#cb5-795" aria-hidden="true" tabindex="-1"></a>            y = max_y <span class="op">*</span> 0<span class="fu">.85</span><span class="op">,</span></span>
<span id="cb5-796"><a href="#cb5-796" aria-hidden="true" tabindex="-1"></a>            text = sprintf<span class="in">(</span>"R²<span class="in">:</span> %<span class="fu">.4f</span>"<span class="op">,</span> r_squared<span class="in">)</span><span class="op">,</span></span>
<span id="cb5-797"><a href="#cb5-797" aria-hidden="true" tabindex="-1"></a>            showarrow = FALSE<span class="op">,</span></span>
<span id="cb5-798"><a href="#cb5-798" aria-hidden="true" tabindex="-1"></a>            xanchor = 'left'<span class="op">,</span></span>
<span id="cb5-799"><a href="#cb5-799" aria-hidden="true" tabindex="-1"></a>            yanchor = 'bottom'<span class="op">,</span></span>
<span id="cb5-800"><a href="#cb5-800" aria-hidden="true" tabindex="-1"></a>            font = list<span class="in">(</span></span>
<span id="cb5-801"><a href="#cb5-801" aria-hidden="true" tabindex="-1"></a>              size = 12<span class="op">,</span></span>
<span id="cb5-802"><a href="#cb5-802" aria-hidden="true" tabindex="-1"></a>              color = "black"</span>
<span id="cb5-803"><a href="#cb5-803" aria-hidden="true" tabindex="-1"></a>            <span class="in">)</span></span>
<span id="cb5-804"><a href="#cb5-804" aria-hidden="true" tabindex="-1"></a>          <span class="in">)</span><span class="op">,</span></span>
<span id="cb5-805"><a href="#cb5-805" aria-hidden="true" tabindex="-1"></a>          list<span class="in">(</span></span>
<span id="cb5-806"><a href="#cb5-806" aria-hidden="true" tabindex="-1"></a>            x = max_x <span class="op">*</span> 0<span class="fu">.3</span><span class="op">,</span></span>
<span id="cb5-807"><a href="#cb5-807" aria-hidden="true" tabindex="-1"></a>            y = max_y <span class="op">*</span> 0<span class="fu">.80</span><span class="op">,</span></span>
<span id="cb5-808"><a href="#cb5-808" aria-hidden="true" tabindex="-1"></a>            text = sprintf<span class="in">(</span>"BLC&lt;sub<span class="op">&gt;</span>max&lt;/sub<span class="op">&gt;</span><span class="in">:</span> %<span class="fu">.2f</span> mmol/l"<span class="op">,</span> Lamax<span class="in">)</span><span class="op">,</span></span>
<span id="cb5-809"><a href="#cb5-809" aria-hidden="true" tabindex="-1"></a>            showarrow = FALSE<span class="op">,</span></span>
<span id="cb5-810"><a href="#cb5-810" aria-hidden="true" tabindex="-1"></a>            xanchor = 'left'<span class="op">,</span></span>
<span id="cb5-811"><a href="#cb5-811" aria-hidden="true" tabindex="-1"></a>            yanchor = 'bottom'<span class="op">,</span></span>
<span id="cb5-812"><a href="#cb5-812" aria-hidden="true" tabindex="-1"></a>            font = list<span class="in">(</span></span>
<span id="cb5-813"><a href="#cb5-813" aria-hidden="true" tabindex="-1"></a>              size = 12<span class="op">,</span></span>
<span id="cb5-814"><a href="#cb5-814" aria-hidden="true" tabindex="-1"></a>              color = "black"</span>
<span id="cb5-815"><a href="#cb5-815" aria-hidden="true" tabindex="-1"></a>            <span class="in">)</span></span>
<span id="cb5-816"><a href="#cb5-816" aria-hidden="true" tabindex="-1"></a>          <span class="in">)</span><span class="op">,</span></span>
<span id="cb5-817"><a href="#cb5-817" aria-hidden="true" tabindex="-1"></a>          list<span class="in">(</span></span>
<span id="cb5-818"><a href="#cb5-818" aria-hidden="true" tabindex="-1"></a>            x = max_x <span class="op">*</span> 0<span class="fu">.3</span><span class="op">,</span></span>
<span id="cb5-819"><a href="#cb5-819" aria-hidden="true" tabindex="-1"></a>            y = max_y <span class="op">*</span> 0<span class="fu">.75</span><span class="op">,</span></span>
<span id="cb5-820"><a href="#cb5-820" aria-hidden="true" tabindex="-1"></a>            text = sprintf<span class="in">(</span>"TBLC&lt;sub<span class="op">&gt;</span>max&lt;/sub<span class="op">&gt;</span><span class="in">:</span> %<span class="fu">.2f</span> min"<span class="op">,</span>tmax<span class="in">)</span><span class="op">,</span></span>
<span id="cb5-821"><a href="#cb5-821" aria-hidden="true" tabindex="-1"></a>            showarrow = FALSE<span class="op">,</span></span>
<span id="cb5-822"><a href="#cb5-822" aria-hidden="true" tabindex="-1"></a>            xanchor = 'left'<span class="op">,</span></span>
<span id="cb5-823"><a href="#cb5-823" aria-hidden="true" tabindex="-1"></a>            yanchor = 'bottom'<span class="op">,</span></span>
<span id="cb5-824"><a href="#cb5-824" aria-hidden="true" tabindex="-1"></a>            font = list<span class="in">(</span></span>
<span id="cb5-825"><a href="#cb5-825" aria-hidden="true" tabindex="-1"></a>              size = 12<span class="op">,</span></span>
<span id="cb5-826"><a href="#cb5-826" aria-hidden="true" tabindex="-1"></a>              color = "black"</span>
<span id="cb5-827"><a href="#cb5-827" aria-hidden="true" tabindex="-1"></a>            <span class="in">)</span></span>
<span id="cb5-828"><a href="#cb5-828" aria-hidden="true" tabindex="-1"></a>          <span class="in">)</span></span>
<span id="cb5-829"><a href="#cb5-829" aria-hidden="true" tabindex="-1"></a>        <span class="in">)</span></span>
<span id="cb5-830"><a href="#cb5-830" aria-hidden="true" tabindex="-1"></a>      <span class="in">)</span></span>
<span id="cb5-831"><a href="#cb5-831" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-832"><a href="#cb5-832" aria-hidden="true" tabindex="-1"></a>    p</span>
<span id="cb5-833"><a href="#cb5-833" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb5-834"><a href="#cb5-834" aria-hidden="true" tabindex="-1"></a>  output$instructions &lt;- renderUI<span class="in">(</span><span class="er">{</span></span>
<span id="cb5-835"><a href="#cb5-835" aria-hidden="true" tabindex="-1"></a>    HTML(</span>
<span id="cb5-836"><a href="#cb5-836" aria-hidden="true" tabindex="-1"></a>      "&lt;div style='margin-top<span class="ch">:</span> <span class="dv">20</span><span class="dt">px</span><span class="op">;</span> <span class="kw">padding</span><span class="ch">:</span> <span class="dv">10</span><span class="dt">px</span><span class="op">;</span> <span class="kw">background-color</span><span class="ch">:</span> <span class="cn">#f0f0f0</span><span class="op">;</span> <span class="kw">border</span><span class="ch">:</span> <span class="dv">1</span><span class="dt">px</span> <span class="dv">solid</span> <span class="cn">#ddd</span><span class="op">;</span> <span class="kw">border-radius</span><span class="ch">:</span> <span class="dv">5</span><span class="dt">px</span><span class="op">;</span> <span class="kw">width</span><span class="ch">:</span> <span class="dv">fit-content</span><span class="op">;</span>'<span class="op">&gt;</span></span>
<span id="cb5-837"><a href="#cb5-837" aria-hidden="true" tabindex="-1"></a>        &lt;h4 style='color<span class="in">:</span> <span class="pp">#333</span>;'<span class="op">&gt;</span>&lt;strong<span class="op">&gt;</span>Anleitung - Modellanpassung<span class="in">:</span>&lt;/strong<span class="op">&gt;</span>&lt;/h4<span class="op">&gt;</span></span>
<span id="cb5-838"><a href="#cb5-838" aria-hidden="true" tabindex="-1"></a>        &lt;ol style='color<span class="in">:</span> <span class="pp">#555</span>; list-style-position<span class="in">:</span> outside; padding-left<span class="in">:</span> 20px;'<span class="op">&gt;</span></span>
<span id="cb5-839"><a href="#cb5-839" aria-hidden="true" tabindex="-1"></a>          &lt;li<span class="op">&gt;</span>Beispiel-Laktatdaten verwenden oder eigene Laktat-Daten als CSV-Datei einfügen.&lt;/li<span class="op">&gt;</span></span>
<span id="cb5-840"><a href="#cb5-840" aria-hidden="true" tabindex="-1"></a>          &lt;li<span class="op">&gt;</span>Modellanpassung 'Fit<span class="in">:</span> nlsLM' durchführen.&lt;/li<span class="op">&gt;</span></span>
<span id="cb5-841"><a href="#cb5-841" aria-hidden="true" tabindex="-1"></a>          &lt;li<span class="op">&gt;</span>Alternativ<span class="in">:</span> Manuelle Modellanpassung der Modellparameter mit den Schiebereglern.&lt;/li<span class="op">&gt;</span></span>
<span id="cb5-842"><a href="#cb5-842" aria-hidden="true" tabindex="-1"></a>        &lt;/ol<span class="op">&gt;</span></span>
<span id="cb5-843"><a href="#cb5-843" aria-hidden="true" tabindex="-1"></a>        &lt;div style='margin-top<span class="in">:</span> 20px;'<span class="op">&gt;</span>&lt;/div<span class="op">&gt;</span></span>
<span id="cb5-844"><a href="#cb5-844" aria-hidden="true" tabindex="-1"></a>        &lt;pre style='background-color<span class="in">:</span> <span class="pp">#f8f8f8</span>; padding<span class="in">:</span> 10px; border<span class="in">:</span> 1px solid <span class="pp">#ddd</span>; border-radius<span class="in">:</span> 5px; width<span class="in">:</span> fit-content;'<span class="op">&gt;</span></span>
<span id="cb5-845"><a href="#cb5-845" aria-hidden="true" tabindex="-1"></a>Laktat-Daten können als CSV-Datei im folgenden Format hochgeladen werden<span class="in">:</span></span>
<span id="cb5-846"><a href="#cb5-846" aria-hidden="true" tabindex="-1"></a>t_min<span class="op">,</span>BLC_t</span>
<span id="cb5-847"><a href="#cb5-847" aria-hidden="true" tabindex="-1"></a>0<span class="fu">.0</span><span class="op">,</span>2<span class="fu">.84</span></span>
<span id="cb5-848"><a href="#cb5-848" aria-hidden="true" tabindex="-1"></a>1<span class="fu">.5</span><span class="op">,</span>3<span class="fu">.60</span></span>
<span id="cb5-849"><a href="#cb5-849" aria-hidden="true" tabindex="-1"></a>3<span class="fu">.0</span><span class="op">,</span>5<span class="fu">.09</span></span>
<span id="cb5-850"><a href="#cb5-850" aria-hidden="true" tabindex="-1"></a>…</span>
<span id="cb5-851"><a href="#cb5-851" aria-hidden="true" tabindex="-1"></a>        &lt;/pre<span class="op">&gt;</span></span>
<span id="cb5-852"><a href="#cb5-852" aria-hidden="true" tabindex="-1"></a>      &lt;/div<span class="op">&gt;</span>"</span>
<span id="cb5-853"><a href="#cb5-853" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-854"><a href="#cb5-854" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb5-855"><a href="#cb5-855" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-856"><a href="#cb5-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-857"><a href="#cb5-857" aria-hidden="true" tabindex="-1"></a># App ausführen</span>
<span id="cb5-858"><a href="#cb5-858" aria-hidden="true" tabindex="-1"></a>shinyApp<span class="in">(</span>ui = ui<span class="op">,</span> server = server<span class="in">)</span></span>
<span id="cb5-859"><a href="#cb5-859" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb5-860"><a href="#cb5-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-861"><a href="#cb5-861" aria-hidden="true" tabindex="-1"></a><span class="in">:::</span> {<span class="fu">.callout-note</span> icon=false collapse=true appearance="simple"}</span>
<span id="cb5-862"><a href="#cb5-862" aria-hidden="true" tabindex="-1"></a>#### Modellanpassung - Details<span class="in">:</span> {<span class="fu">.unlisted</span>}</span>
<span id="cb5-863"><a href="#cb5-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-864"><a href="#cb5-864" aria-hidden="true" tabindex="-1"></a><span class="op">**</span>nlsLM - Fit<span class="in">:</span><span class="op">**</span></span>
<span id="cb5-865"><a href="#cb5-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-866"><a href="#cb5-866" aria-hidden="true" tabindex="-1"></a>- Verwendete Funktion<span class="in">:</span> nlsLM</span>
<span id="cb5-867"><a href="#cb5-867" aria-hidden="true" tabindex="-1"></a>- Parameter<span class="in">:</span> a<span class="op">,</span> k1<span class="op">,</span> k2<span class="op">,</span> BLC0</span>
<span id="cb5-868"><a href="#cb5-868" aria-hidden="true" tabindex="-1"></a>- Modell<span class="in">:</span> BLC_t <span class="op">~</span> BLC0 <span class="op">+</span> <span class="in">(</span>a · k1 / <span class="in">(</span>k2 - k1<span class="in">))</span> · <span class="in">(</span>exp<span class="in">(</span>-k1 · t_min<span class="in">)</span> - exp<span class="in">(</span>-k2 · t_min<span class="in">))</span></span>
<span id="cb5-869"><a href="#cb5-869" aria-hidden="true" tabindex="-1"></a>- Grenzen<span class="in">:</span></span>
<span id="cb5-870"><a href="#cb5-870" aria-hidden="true" tabindex="-1"></a>  - a<span class="in">:</span> <span class="op">*</span>0<span class="fu">.0</span> bis 30<span class="fu">.0</span> mmol/l<span class="op">*</span></span>
<span id="cb5-871"><a href="#cb5-871" aria-hidden="true" tabindex="-1"></a>  - k1<span class="in">:</span> <span class="op">*</span>0<span class="fu">.1</span> bis 3<span class="fu">.5</span> min^-1<span class="op">*</span></span>
<span id="cb5-872"><a href="#cb5-872" aria-hidden="true" tabindex="-1"></a>  - k2<span class="in">:</span> <span class="op">*</span>0<span class="fu">.020</span> bis 0<span class="fu">.200</span> min^-1<span class="op">*</span></span>
<span id="cb5-873"><a href="#cb5-873" aria-hidden="true" tabindex="-1"></a>  - BLC0<span class="in">:</span> <span class="op">*</span>0<span class="fu">.90</span> · BLC_t<span class="ex">[</span><span class="ss">1</span><span class="ex">]</span> bis 1<span class="fu">.10</span> · BLC_t<span class="ex">[</span><span class="ss">1</span><span class="ex">]</span><span class="op">,</span> begrenzt auf 0 bis 5 mmol/l<span class="op">*</span></span>
<span id="cb5-874"><a href="#cb5-874" aria-hidden="true" tabindex="-1"></a>- Prozess<span class="in">:</span></span>
<span id="cb5-875"><a href="#cb5-875" aria-hidden="true" tabindex="-1"></a>  a) Bestimmung der BLC0-Grenzen<span class="in">:</span></span>
<span id="cb5-876"><a href="#cb5-876" aria-hidden="true" tabindex="-1"></a>     - Untere Grenze<span class="in">:</span> <span class="op">*</span>max<span class="in">(</span>0<span class="op">,</span> 0<span class="fu">.90</span> · erster BLC-Wert<span class="in">)</span><span class="op">*</span></span>
<span id="cb5-877"><a href="#cb5-877" aria-hidden="true" tabindex="-1"></a>     - Obere Grenze<span class="in">:</span> <span class="op">*</span>min<span class="in">(</span>5<span class="op">,</span> 1<span class="fu">.10</span> · erster BLC-Wert<span class="in">)</span><span class="op">*</span></span>
<span id="cb5-878"><a href="#cb5-878" aria-hidden="true" tabindex="-1"></a>  b) Iterative Optimierung <span class="in">(</span>100 Durchläufe<span class="in">):</span></span>
<span id="cb5-879"><a href="#cb5-879" aria-hidden="true" tabindex="-1"></a>     - Zufällige Startwertebestimmung für jeden Durchlauf<span class="in">:</span></span>
<span id="cb5-880"><a href="#cb5-880" aria-hidden="true" tabindex="-1"></a>       · a<span class="in">:</span> Zufallswert zwischen 0 und 30</span>
<span id="cb5-881"><a href="#cb5-881" aria-hidden="true" tabindex="-1"></a>       · k1<span class="in">:</span> Zufallswert zwischen 0<span class="fu">.1</span> und 3<span class="fu">.5</span></span>
<span id="cb5-882"><a href="#cb5-882" aria-hidden="true" tabindex="-1"></a>       · k2<span class="in">:</span> Zufallswert zwischen 0<span class="fu">.020</span> und 0<span class="fu">.200</span></span>
<span id="cb5-883"><a href="#cb5-883" aria-hidden="true" tabindex="-1"></a>       · BLC0<span class="in">:</span> Zufallswert zwischen der unteren und oberen BLC0-Grenze</span>
<span id="cb5-884"><a href="#cb5-884" aria-hidden="true" tabindex="-1"></a>     - Durchführung der nicht-linearen Regression<span class="in">:</span></span>
<span id="cb5-885"><a href="#cb5-885" aria-hidden="true" tabindex="-1"></a>       · Verwendung des Levenberg-Marquardt-Algorithmus</span>
<span id="cb5-886"><a href="#cb5-886" aria-hidden="true" tabindex="-1"></a>       · Maximale Iterationen<span class="in">:</span> <span class="op">*</span>1024<span class="op">*</span></span>
<span id="cb5-887"><a href="#cb5-887" aria-hidden="true" tabindex="-1"></a>     - Berechnung der Residuenquadratsumme <span class="in">(</span>RSS<span class="in">)</span> für jede Anpassung</span>
<span id="cb5-888"><a href="#cb5-888" aria-hidden="true" tabindex="-1"></a>     - Speicherung der besten Anpassung <span class="in">(</span>niedrigste RSS<span class="in">)</span></span>
<span id="cb5-889"><a href="#cb5-889" aria-hidden="true" tabindex="-1"></a>- Optimierung<span class="in">:</span> Minimierung der Residuenquadratsumme <span class="in">(</span>RSS<span class="in">)</span></span>
<span id="cb5-890"><a href="#cb5-890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-891"><a href="#cb5-891" aria-hidden="true" tabindex="-1"></a><span class="in">:::</span></span>
<span id="cb5-892"><a href="#cb5-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-893"><a href="#cb5-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-894"><a href="#cb5-894" aria-hidden="true" tabindex="-1"></a>## Blutlaktat-Kompartmentmodell-Modellfunktion <span class="in">(</span>nach Freund et al. 1986<span class="in">)</span></span>
<span id="cb5-895"><a href="#cb5-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-896"><a href="#cb5-896" aria-hidden="true" tabindex="-1"></a>Die Shiny-App stellt die Laktatkinetik während und nach einer intensiven Belastung mithilfe des Zwei-Kompartment-Modells nach Freund et al. dar. Dieses mathematische Modell berücksichtigt sowohl die Laktatbildung und -elimination im Muskel- und Nicht-Muskelkompartment als auch den Austausch zwischen diesen Kompartmenten. Der Konzentrationsverlauf wird durch die Summe zweier Exponentialfunktionen beschrieben<span class="op">,</span> deren Amplituden <span class="in">(</span>A<span class="op">~</span>1<span class="op">~,</span> A<span class="op">~</span>2<span class="op">~</span><span class="in">)</span> und Geschwindigkeitskonstanten <span class="in">(</span>γ<span class="op">~</span>1<span class="op">~,</span> γ<span class="op">~</span>2<span class="op">~</span><span class="in">)</span> die Dynamik der Laktatkinetik charakterisieren <span class="ex">[</span><span class="ss">@Freund1986</span>; <span class="im">@Heck2022</span>, 197].</span>
<span id="cb5-897"><a href="#cb5-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-898"><a href="#cb5-898" aria-hidden="true" tabindex="-1"></a>```{shinylive-r}</span>
<span id="cb5-899"><a href="#cb5-899" aria-hidden="true" tabindex="-1"></a>#<span class="op">|</span> standalone<span class="in">:</span> true</span>
<span id="cb5-900"><a href="#cb5-900" aria-hidden="true" tabindex="-1"></a>#<span class="op">|</span> viewerHeight<span class="in">:</span> 900</span>
<span id="cb5-901"><a href="#cb5-901" aria-hidden="true" tabindex="-1"></a>library<span class="in">(</span>shiny<span class="in">)</span></span>
<span id="cb5-902"><a href="#cb5-902" aria-hidden="true" tabindex="-1"></a>library<span class="in">(</span>plotly<span class="in">)</span></span>
<span id="cb5-903"><a href="#cb5-903" aria-hidden="true" tabindex="-1"></a>library<span class="in">(</span>minpack<span class="fu">.lm</span><span class="in">)</span></span>
<span id="cb5-904"><a href="#cb5-904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-905"><a href="#cb5-905" aria-hidden="true" tabindex="-1"></a># Definiere Daten</span>
<span id="cb5-906"><a href="#cb5-906" aria-hidden="true" tabindex="-1"></a>t_min &lt;- c<span class="in">(</span>0<span class="fu">.4</span><span class="op">,</span> 3<span class="fu">.3</span><span class="op">,</span> 6<span class="fu">.5</span><span class="op">,</span> 8<span class="fu">.4</span><span class="op">,</span> 10<span class="fu">.2</span><span class="op">,</span> 12<span class="fu">.5</span><span class="op">,</span> 14<span class="fu">.9</span><span class="op">,</span> 16<span class="fu">.7</span><span class="op">,</span> 19<span class="fu">.3</span><span class="in">)</span></span>
<span id="cb5-907"><a href="#cb5-907" aria-hidden="true" tabindex="-1"></a>BLC_t &lt;- c<span class="in">(</span>0<span class="fu">.82</span><span class="op">,</span> 4<span class="fu">.53</span><span class="op">,</span> 6<span class="fu">.97</span><span class="op">,</span> 7<span class="fu">.52</span><span class="op">,</span> 7<span class="fu">.73</span><span class="op">,</span> 7<span class="fu">.28</span><span class="op">,</span> 6<span class="fu">.37</span><span class="op">,</span> 5<span class="fu">.41</span><span class="op">,</span> 4<span class="fu">.71</span><span class="in">)</span></span>
<span id="cb5-908"><a href="#cb5-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-909"><a href="#cb5-909" aria-hidden="true" tabindex="-1"></a># Normalisiere t_min<span class="op">,</span> wenn der kleinste Wert größer als 0<span class="fu">.0</span> ist</span>
<span id="cb5-910"><a href="#cb5-910" aria-hidden="true" tabindex="-1"></a>if <span class="in">(</span>min<span class="in">(</span>t_min<span class="in">)</span> <span class="op">&gt;</span> 0<span class="fu">.0</span><span class="in">)</span> {</span>
<span id="cb5-911"><a href="#cb5-911" aria-hidden="true" tabindex="-1"></a>  t_min &lt;- t_min - min(t_min)</span>
<span id="cb5-912"><a href="#cb5-912" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-913"><a href="#cb5-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-914"><a href="#cb5-914" aria-hidden="true" tabindex="-1"></a># Freund et al. Kompartmentmodell-Funktion</span>
<span id="cb5-915"><a href="#cb5-915" aria-hidden="true" tabindex="-1"></a>freund_model &lt;- function<span class="in">(</span>t<span class="op">,</span> A1<span class="op">,</span> A2<span class="op">,</span> gamma1<span class="op">,</span> gamma2<span class="op">,</span> La0<span class="in">)</span> {</span>
<span id="cb5-916"><a href="#cb5-916" aria-hidden="true" tabindex="-1"></a>  La0 <span class="op">+</span> A1 <span class="op">*</span> <span class="in">(</span>1 - exp<span class="in">(</span>-gamma1 <span class="op">*</span> t<span class="in">))</span> <span class="op">+</span> A2 <span class="op">*</span> <span class="in">(</span>1 - exp<span class="in">(</span>-gamma2 <span class="op">*</span> t<span class="in">))</span></span>
<span id="cb5-917"><a href="#cb5-917" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-918"><a href="#cb5-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-919"><a href="#cb5-919" aria-hidden="true" tabindex="-1"></a># Berechne tmax und Lamax</span>
<span id="cb5-920"><a href="#cb5-920" aria-hidden="true" tabindex="-1"></a>calculate_tmax_lamax &lt;- function<span class="in">(</span>A1<span class="op">,</span> A2<span class="op">,</span> gamma1<span class="op">,</span> gamma2<span class="op">,</span> La0<span class="in">)</span> {</span>
<span id="cb5-921"><a href="#cb5-921" aria-hidden="true" tabindex="-1"></a>  f &lt;- function(t) freund_model(t<span class="op">,</span> A1<span class="op">,</span> A2<span class="op">,</span> gamma1<span class="op">,</span> gamma2<span class="op">,</span> La0)</span>
<span id="cb5-922"><a href="#cb5-922" aria-hidden="true" tabindex="-1"></a>  tmax &lt;- optimize<span class="in">(</span>f<span class="op">,</span> c<span class="in">(</span>0<span class="op">,</span> 100<span class="in">)</span><span class="op">,</span> maximum = TRUE<span class="in">)</span>$maximum</span>
<span id="cb5-923"><a href="#cb5-923" aria-hidden="true" tabindex="-1"></a>  Lamax &lt;- f<span class="in">(</span>tmax<span class="in">)</span></span>
<span id="cb5-924"><a href="#cb5-924" aria-hidden="true" tabindex="-1"></a>  list<span class="in">(</span>tmax = tmax<span class="op">,</span> Lamax = Lamax<span class="in">)</span></span>
<span id="cb5-925"><a href="#cb5-925" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-926"><a href="#cb5-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-927"><a href="#cb5-927" aria-hidden="true" tabindex="-1"></a># UI</span>
<span id="cb5-928"><a href="#cb5-928" aria-hidden="true" tabindex="-1"></a>ui &lt;- fluidPage<span class="in">(</span></span>
<span id="cb5-929"><a href="#cb5-929" aria-hidden="true" tabindex="-1"></a>  titlePanel<span class="in">(</span>"BLC-Kompartmentmodell-Modellfunktion"<span class="in">)</span><span class="op">,</span></span>
<span id="cb5-930"><a href="#cb5-930" aria-hidden="true" tabindex="-1"></a>  fluidRow<span class="in">(</span></span>
<span id="cb5-931"><a href="#cb5-931" aria-hidden="true" tabindex="-1"></a>    column<span class="in">(</span>3<span class="op">,</span></span>
<span id="cb5-932"><a href="#cb5-932" aria-hidden="true" tabindex="-1"></a>           style = "height<span class="in">:</span> 90vh; overflow-y<span class="in">:</span> auto;"<span class="op">,</span></span>
<span id="cb5-933"><a href="#cb5-933" aria-hidden="true" tabindex="-1"></a>           </span>
<span id="cb5-934"><a href="#cb5-934" aria-hidden="true" tabindex="-1"></a>           tags$h4<span class="in">(</span>tags$strong<span class="in">(</span>"Modellparameter<span class="in">:</span>"<span class="in">))</span><span class="op">,</span></span>
<span id="cb5-935"><a href="#cb5-935" aria-hidden="true" tabindex="-1"></a>           sliderInput<span class="in">(</span>"A1"<span class="op">,</span> "A1 <span class="ex">[</span><span class="ss">mmol/l</span><span class="ex">]</span>"<span class="op">,</span> min = 0<span class="fu">.0</span><span class="op">,</span> max = 100<span class="fu">.0</span><span class="op">,</span> value = 20<span class="fu">.0</span><span class="op">,</span> step = 0<span class="fu">.1</span><span class="in">)</span><span class="op">,</span></span>
<span id="cb5-936"><a href="#cb5-936" aria-hidden="true" tabindex="-1"></a>           sliderInput<span class="in">(</span>"A2"<span class="op">,</span> "A2 <span class="ex">[</span><span class="ss">mmol/l</span><span class="ex">]</span>"<span class="op">,</span> min = -100<span class="fu">.0</span><span class="op">,</span> max = 0<span class="fu">.0</span><span class="op">,</span> value = -20<span class="fu">.0</span><span class="op">,</span> step = 0<span class="fu">.1</span><span class="in">)</span><span class="op">,</span></span>
<span id="cb5-937"><a href="#cb5-937" aria-hidden="true" tabindex="-1"></a>           sliderInput<span class="in">(</span>"gamma1"<span class="op">,</span> "γ1 <span class="ex">[</span><span class="ss">min</span><span class="op">^</span><span class="ss">-1</span><span class="ex">]</span>"<span class="op">,</span> min = 0<span class="fu">.05</span><span class="op">,</span> max = 2<span class="fu">.0</span><span class="op">,</span> value = 0<span class="fu">.1</span><span class="op">,</span> step = 0<span class="fu">.001</span><span class="in">)</span><span class="op">,</span></span>
<span id="cb5-938"><a href="#cb5-938" aria-hidden="true" tabindex="-1"></a>           sliderInput<span class="in">(</span>"gamma2"<span class="op">,</span> "γ2 <span class="ex">[</span><span class="ss">min</span><span class="op">^</span><span class="ss">-1</span><span class="ex">]</span>"<span class="op">,</span> min = 0<span class="fu">.01</span><span class="op">,</span> max = 0<span class="fu">.5</span><span class="op">,</span> value = 0<span class="fu">.05</span><span class="op">,</span> step = 0<span class="fu">.001</span><span class="in">)</span><span class="op">,</span></span>
<span id="cb5-939"><a href="#cb5-939" aria-hidden="true" tabindex="-1"></a>           sliderInput<span class="in">(</span>"La0"<span class="op">,</span> "La0 <span class="ex">[</span><span class="ss">mmol/l</span><span class="ex">]</span>"<span class="op">,</span> min = 0<span class="fu">.0</span><span class="op">,</span> max = 5<span class="fu">.0</span><span class="op">,</span> value = 1<span class="fu">.0</span><span class="op">,</span> step = 0<span class="fu">.01</span><span class="in">)</span><span class="op">,</span></span>
<span id="cb5-940"><a href="#cb5-940" aria-hidden="true" tabindex="-1"></a>           actionButton<span class="in">(</span>"optimize"<span class="op">,</span> "Fit<span class="in">:</span> nlsLM"<span class="in">)</span><span class="op">,</span> </span>
<span id="cb5-941"><a href="#cb5-941" aria-hidden="true" tabindex="-1"></a>           br<span class="in">()</span><span class="op">,</span> br<span class="in">()</span><span class="op">,</span></span>
<span id="cb5-942"><a href="#cb5-942" aria-hidden="true" tabindex="-1"></a>           fileInput<span class="in">(</span>"file_upload"<span class="op">,</span> "CSV-Datei hochladen"<span class="op">,</span> accept = "<span class="fu">.csv</span>"<span class="in">)</span></span>
<span id="cb5-943"><a href="#cb5-943" aria-hidden="true" tabindex="-1"></a>    <span class="in">)</span><span class="op">,</span></span>
<span id="cb5-944"><a href="#cb5-944" aria-hidden="true" tabindex="-1"></a>    mainPanel<span class="in">(</span></span>
<span id="cb5-945"><a href="#cb5-945" aria-hidden="true" tabindex="-1"></a>      width = 9<span class="op">,</span></span>
<span id="cb5-946"><a href="#cb5-946" aria-hidden="true" tabindex="-1"></a>      plotlyOutput<span class="in">(</span>"plot"<span class="in">)</span><span class="op">,</span></span>
<span id="cb5-947"><a href="#cb5-947" aria-hidden="true" tabindex="-1"></a>      uiOutput<span class="in">(</span>"instructions"<span class="in">)</span></span>
<span id="cb5-948"><a href="#cb5-948" aria-hidden="true" tabindex="-1"></a>    <span class="in">)</span></span>
<span id="cb5-949"><a href="#cb5-949" aria-hidden="true" tabindex="-1"></a>  <span class="in">)</span></span>
<span id="cb5-950"><a href="#cb5-950" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb5-951"><a href="#cb5-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-952"><a href="#cb5-952" aria-hidden="true" tabindex="-1"></a># Server-Logik</span>
<span id="cb5-953"><a href="#cb5-953" aria-hidden="true" tabindex="-1"></a>server &lt;- function<span class="in">(</span>input<span class="op">,</span> output<span class="op">,</span> session<span class="in">)</span> {</span>
<span id="cb5-954"><a href="#cb5-954" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-955"><a href="#cb5-955" aria-hidden="true" tabindex="-1"></a>  # Reaktiver Wert für hochgeladene Daten</span>
<span id="cb5-956"><a href="#cb5-956" aria-hidden="true" tabindex="-1"></a>  uploaded_data &lt;- reactiveVal<span class="in">(</span>NULL<span class="in">)</span></span>
<span id="cb5-957"><a href="#cb5-957" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-958"><a href="#cb5-958" aria-hidden="true" tabindex="-1"></a>  # Beobachter für CSV-Upload</span>
<span id="cb5-959"><a href="#cb5-959" aria-hidden="true" tabindex="-1"></a>  observeEvent<span class="in">(</span>input$file_upload<span class="op">,</span> <span class="er">{</span></span>
<span id="cb5-960"><a href="#cb5-960" aria-hidden="true" tabindex="-1"></a>    req(input$file_upload)</span>
<span id="cb5-961"><a href="#cb5-961" aria-hidden="true" tabindex="-1"></a>    df &lt;- read<span class="fu">.csv</span><span class="in">(</span>input$file_upload$datapath<span class="in">)</span></span>
<span id="cb5-962"><a href="#cb5-962" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-963"><a href="#cb5-963" aria-hidden="true" tabindex="-1"></a>    if <span class="in">(</span>"t_min" %in% names<span class="in">(</span>df<span class="in">)</span> <span class="op">&amp;&amp;</span> "BLC_t" %in% names<span class="in">(</span>df<span class="in">))</span> {</span>
<span id="cb5-964"><a href="#cb5-964" aria-hidden="true" tabindex="-1"></a>      if (df$t_min<span class="ex">[</span><span class="ss">1</span><span class="ex">]</span> != 0<span class="fu">.0</span>) {</span>
<span id="cb5-965"><a href="#cb5-965" aria-hidden="true" tabindex="-1"></a>        df$t_min &lt;- df$t_min - df$t_min<span class="ex">[</span><span class="ss">1</span><span class="ex">]</span></span>
<span id="cb5-966"><a href="#cb5-966" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb5-967"><a href="#cb5-967" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-968"><a href="#cb5-968" aria-hidden="true" tabindex="-1"></a>      uploaded_data(df)</span>
<span id="cb5-969"><a href="#cb5-969" aria-hidden="true" tabindex="-1"></a>    } else {</span>
<span id="cb5-970"><a href="#cb5-970" aria-hidden="true" tabindex="-1"></a>      showModal(modalDialog(</span>
<span id="cb5-971"><a href="#cb5-971" aria-hidden="true" tabindex="-1"></a>        title = "Ungültige CSV"<span class="op">,</span></span>
<span id="cb5-972"><a href="#cb5-972" aria-hidden="true" tabindex="-1"></a>        "Die CSV-Datei muss 't_min' und 'BLC_t' als Spaltennamen enthalten."<span class="op">,</span></span>
<span id="cb5-973"><a href="#cb5-973" aria-hidden="true" tabindex="-1"></a>        easyClose = TRUE<span class="op">,</span></span>
<span id="cb5-974"><a href="#cb5-974" aria-hidden="true" tabindex="-1"></a>        footer = NULL</span>
<span id="cb5-975"><a href="#cb5-975" aria-hidden="true" tabindex="-1"></a>      ))</span>
<span id="cb5-976"><a href="#cb5-976" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-977"><a href="#cb5-977" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb5-978"><a href="#cb5-978" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-979"><a href="#cb5-979" aria-hidden="true" tabindex="-1"></a>  observeEvent<span class="in">(</span>input$optimize<span class="op">,</span> <span class="er">{</span></span>
<span id="cb5-980"><a href="#cb5-980" aria-hidden="true" tabindex="-1"></a>    data &lt;- if (is<span class="fu">.null</span><span class="in">(</span>uploaded_data<span class="in">())</span>) {</span>
<span id="cb5-981"><a href="#cb5-981" aria-hidden="true" tabindex="-1"></a>      data<span class="fu">.frame</span><span class="in">(</span>t_min = t_min<span class="op">,</span> BLC_t = BLC_t<span class="in">)</span></span>
<span id="cb5-982"><a href="#cb5-982" aria-hidden="true" tabindex="-1"></a>    } else {</span>
<span id="cb5-983"><a href="#cb5-983" aria-hidden="true" tabindex="-1"></a>      uploaded_data()</span>
<span id="cb5-984"><a href="#cb5-984" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-985"><a href="#cb5-985" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-986"><a href="#cb5-986" aria-hidden="true" tabindex="-1"></a>    # Setze La0 Grenzen basierend auf dem ersten BLC_t Wert</span>
<span id="cb5-987"><a href="#cb5-987" aria-hidden="true" tabindex="-1"></a>    La0_lower &lt;- max<span class="in">(</span>0<span class="op">,</span> data$BLC_t<span class="ex">[</span><span class="ss">1</span><span class="ex">]</span> <span class="op">*</span> 0<span class="fu">.9</span><span class="in">)</span></span>
<span id="cb5-988"><a href="#cb5-988" aria-hidden="true" tabindex="-1"></a>    La0_upper &lt;- min<span class="in">(</span>5<span class="op">,</span> data$BLC_t<span class="ex">[</span><span class="ss">1</span><span class="ex">]</span> <span class="op">*</span> 1<span class="fu">.1</span><span class="in">)</span></span>
<span id="cb5-989"><a href="#cb5-989" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-990"><a href="#cb5-990" aria-hidden="true" tabindex="-1"></a>    best_fit &lt;- NULL</span>
<span id="cb5-991"><a href="#cb5-991" aria-hidden="true" tabindex="-1"></a>    best_rss &lt;- Inf</span>
<span id="cb5-992"><a href="#cb5-992" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-993"><a href="#cb5-993" aria-hidden="true" tabindex="-1"></a>    withProgress<span class="in">(</span>message = 'Fitting in progress'<span class="op">,</span> value = 0<span class="op">,</span> <span class="er">{</span></span>
<span id="cb5-994"><a href="#cb5-994" aria-hidden="true" tabindex="-1"></a>      for (i in 1<span class="ch">:</span><span class="dv">100</span>) {</span>
<span id="cb5-995"><a href="#cb5-995" aria-hidden="true" tabindex="-1"></a>        # <span class="dv">Randomisierte Startwerte</span></span>
<span id="cb5-996"><a href="#cb5-996" aria-hidden="true" tabindex="-1"></a>        <span class="dv">A1_start </span>&lt;<span class="dv">- </span>runif<span class="fu">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">100</span><span class="fu">)</span></span>
<span id="cb5-997"><a href="#cb5-997" aria-hidden="true" tabindex="-1"></a>        <span class="dv">A2_start </span>&lt;<span class="dv">- </span>runif<span class="fu">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">-100</span><span class="op">,</span> <span class="dv">0</span><span class="fu">)</span></span>
<span id="cb5-998"><a href="#cb5-998" aria-hidden="true" tabindex="-1"></a>        <span class="dv">gamma1_start </span>&lt;<span class="dv">- </span>runif<span class="fu">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">0.05</span><span class="op">,</span> <span class="dv">2</span><span class="fu">)</span></span>
<span id="cb5-999"><a href="#cb5-999" aria-hidden="true" tabindex="-1"></a>        <span class="dv">gamma2_start </span>&lt;<span class="dv">- </span>runif<span class="fu">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">0.01</span><span class="op">,</span> <span class="dv">0.5</span><span class="fu">)</span></span>
<span id="cb5-1000"><a href="#cb5-1000" aria-hidden="true" tabindex="-1"></a>        <span class="dv">La0_start </span>&lt;<span class="dv">- </span>runif<span class="fu">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">La0_lower</span><span class="op">,</span> <span class="dv">La0_upper</span><span class="fu">)</span></span>
<span id="cb5-1001"><a href="#cb5-1001" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-1002"><a href="#cb5-1002" aria-hidden="true" tabindex="-1"></a>        <span class="dv">start_values </span>&lt;<span class="dv">- </span>list<span class="fu">(</span><span class="dv">A1 </span>= <span class="dv">A1_start</span><span class="op">,</span> <span class="dv">A2 </span>= <span class="dv">A2_start</span><span class="op">,</span> <span class="dv">gamma1 </span>= <span class="dv">gamma1_start</span><span class="op">,</span> <span class="dv">gamma2 </span>= <span class="dv">gamma2_start</span><span class="op">,</span> <span class="dv">La0 </span>= <span class="dv">La0_start</span><span class="fu">)</span></span>
<span id="cb5-1003"><a href="#cb5-1003" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-1004"><a href="#cb5-1004" aria-hidden="true" tabindex="-1"></a>        <span class="dv">model_equation </span>&lt;<span class="dv">- BLC_t </span>~ <span class="dv">La0 </span>+ <span class="dv">A1 </span>* <span class="fu">(</span><span class="dv">1</span> <span class="dv">- </span><span class="fu">exp(</span><span class="dv">-gamma1 </span>* <span class="dv">t_min</span><span class="fu">))</span> + <span class="dv">A2 </span>* <span class="fu">(</span><span class="dv">1</span> <span class="dv">- </span><span class="fu">exp(</span><span class="dv">-gamma2 </span>* <span class="dv">t_min</span><span class="fu">))</span></span>
<span id="cb5-1005"><a href="#cb5-1005" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-1006"><a href="#cb5-1006" aria-hidden="true" tabindex="-1"></a>        <span class="dv">fit </span>&lt;<span class="dv">- </span>try<span class="fu">(</span>nlsLM<span class="fu">(</span><span class="dv">model_equation</span><span class="op">,</span></span>
<span id="cb5-1007"><a href="#cb5-1007" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">data </span>= <span class="dv">data</span><span class="op">,</span></span>
<span id="cb5-1008"><a href="#cb5-1008" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">start</span> = <span class="dv">start_values</span><span class="op">,</span></span>
<span id="cb5-1009"><a href="#cb5-1009" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">lower </span>= c<span class="fu">(</span><span class="dv">A1 </span>= <span class="dv">0.0</span><span class="op">,</span> <span class="dv">A2 </span>= <span class="dv">-100.0</span><span class="op">,</span> <span class="dv">gamma1 </span>= <span class="dv">0.05</span><span class="op">,</span> <span class="dv">gamma2 </span>= <span class="dv">0.01</span><span class="op">,</span> <span class="dv">La0 </span>= <span class="dv">La0_lower</span><span class="fu">)</span><span class="op">,</span></span>
<span id="cb5-1010"><a href="#cb5-1010" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">upper </span>= c<span class="fu">(</span><span class="dv">A1 </span>= <span class="dv">100.0</span><span class="op">,</span> <span class="dv">A2 </span>= <span class="dv">0.0</span><span class="op">,</span> <span class="dv">gamma1 </span>= <span class="dv">2.0</span><span class="op">,</span> <span class="dv">gamma2 </span>= <span class="dv">0.5</span><span class="op">,</span> <span class="dv">La0 </span>= <span class="dv">La0_upper</span><span class="fu">)</span><span class="op">,</span></span>
<span id="cb5-1011"><a href="#cb5-1011" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">control </span>= <span class="dv">nls</span>.control<span class="fu">(</span><span class="dv">maxiter </span>= <span class="dv">1024</span><span class="fu">))</span><span class="op">,</span> <span class="dv">silent </span>= <span class="dv">TRUE</span><span class="fu">)</span></span>
<span id="cb5-1012"><a href="#cb5-1012" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-1013"><a href="#cb5-1013" aria-hidden="true" tabindex="-1"></a>        <span class="dv">if </span><span class="fu">(</span><span class="at">!</span>inherits<span class="fu">(</span><span class="dv">fit</span><span class="op">,</span> <span class="st">"try-error"</span><span class="fu">))</span> {</span>
<span id="cb5-1014"><a href="#cb5-1014" aria-hidden="true" tabindex="-1"></a>          <span class="dv">rss </span>&lt;<span class="dv">- </span>sum<span class="fu">(</span>residuals<span class="fu">(</span><span class="dv">fit</span><span class="fu">)</span>^<span class="dv">2</span><span class="fu">)</span></span>
<span id="cb5-1015"><a href="#cb5-1015" aria-hidden="true" tabindex="-1"></a>          <span class="dv">if </span><span class="fu">(</span><span class="dv">rss </span>&lt; <span class="dv">best_rss</span><span class="fu">)</span> {</span>
<span id="cb5-1016"><a href="#cb5-1016" aria-hidden="true" tabindex="-1"></a>            <span class="dv">best_rss </span>&lt;<span class="dv">- rss</span></span>
<span id="cb5-1017"><a href="#cb5-1017" aria-hidden="true" tabindex="-1"></a>            <span class="dv">best_fit </span>&lt;<span class="dv">- fit</span></span>
<span id="cb5-1018"><a href="#cb5-1018" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb5-1019"><a href="#cb5-1019" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb5-1020"><a href="#cb5-1020" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-1021"><a href="#cb5-1021" aria-hidden="true" tabindex="-1"></a>        incProgress<span class="in">(</span>1/100<span class="op">,</span> detail = paste<span class="in">(</span>"Iteration"<span class="op">,</span> i<span class="in">))</span></span>
<span id="cb5-1022"><a href="#cb5-1022" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb5-1023"><a href="#cb5-1023" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb5-1024"><a href="#cb5-1024" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-1025"><a href="#cb5-1025" aria-hidden="true" tabindex="-1"></a>    if <span class="in">(</span>!is<span class="fu">.null</span><span class="in">(</span>best_fit<span class="in">))</span> {</span>
<span id="cb5-1026"><a href="#cb5-1026" aria-hidden="true" tabindex="-1"></a>      params &lt;- as<span class="fu">.list</span><span class="in">(</span>coef<span class="in">(</span>best_fit<span class="in">))</span></span>
<span id="cb5-1027"><a href="#cb5-1027" aria-hidden="true" tabindex="-1"></a>      updateSliderInput<span class="in">(</span>session<span class="op">,</span> "A1"<span class="op">,</span> value = params$A1<span class="in">)</span></span>
<span id="cb5-1028"><a href="#cb5-1028" aria-hidden="true" tabindex="-1"></a>      updateSliderInput<span class="in">(</span>session<span class="op">,</span> "A2"<span class="op">,</span> value = params$A2<span class="in">)</span></span>
<span id="cb5-1029"><a href="#cb5-1029" aria-hidden="true" tabindex="-1"></a>      updateSliderInput<span class="in">(</span>session<span class="op">,</span> "gamma1"<span class="op">,</span> value = params$gamma1<span class="in">)</span></span>
<span id="cb5-1030"><a href="#cb5-1030" aria-hidden="true" tabindex="-1"></a>      updateSliderInput<span class="in">(</span>session<span class="op">,</span> "gamma2"<span class="op">,</span> value = params$gamma2<span class="in">)</span></span>
<span id="cb5-1031"><a href="#cb5-1031" aria-hidden="true" tabindex="-1"></a>      updateSliderInput<span class="in">(</span>session<span class="op">,</span> "La0"<span class="op">,</span> value = params$La0<span class="in">)</span></span>
<span id="cb5-1032"><a href="#cb5-1032" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-1033"><a href="#cb5-1033" aria-hidden="true" tabindex="-1"></a>      showNotification<span class="in">(</span>"Fitting completed successfully!"<span class="op">,</span> type = "message"<span class="in">)</span></span>
<span id="cb5-1034"><a href="#cb5-1034" aria-hidden="true" tabindex="-1"></a>    } else {</span>
<span id="cb5-1035"><a href="#cb5-1035" aria-hidden="true" tabindex="-1"></a>      showModal(modalDialog(</span>
<span id="cb5-1036"><a href="#cb5-1036" aria-hidden="true" tabindex="-1"></a>        title = "nlsLM fehlgeschlagen"<span class="op">,</span></span>
<span id="cb5-1037"><a href="#cb5-1037" aria-hidden="true" tabindex="-1"></a>        "Die nicht-lineare Regression mit dem Levenberg-Marquardt-Algorithmus konnte nicht erfolgreich durchgeführt werden."<span class="op">,</span></span>
<span id="cb5-1038"><a href="#cb5-1038" aria-hidden="true" tabindex="-1"></a>        easyClose = TRUE<span class="op">,</span></span>
<span id="cb5-1039"><a href="#cb5-1039" aria-hidden="true" tabindex="-1"></a>        footer = NULL</span>
<span id="cb5-1040"><a href="#cb5-1040" aria-hidden="true" tabindex="-1"></a>      ))</span>
<span id="cb5-1041"><a href="#cb5-1041" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-1042"><a href="#cb5-1042" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb5-1043"><a href="#cb5-1043" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-1044"><a href="#cb5-1044" aria-hidden="true" tabindex="-1"></a>  output$plot &lt;- renderPlotly<span class="in">(</span><span class="er">{</span></span>
<span id="cb5-1045"><a href="#cb5-1045" aria-hidden="true" tabindex="-1"></a>    A1 &lt;- input$A1</span>
<span id="cb5-1046"><a href="#cb5-1046" aria-hidden="true" tabindex="-1"></a>    A2 &lt;- input$A2</span>
<span id="cb5-1047"><a href="#cb5-1047" aria-hidden="true" tabindex="-1"></a>    gamma1 &lt;- input$gamma1</span>
<span id="cb5-1048"><a href="#cb5-1048" aria-hidden="true" tabindex="-1"></a>    gamma2 &lt;- input$gamma2</span>
<span id="cb5-1049"><a href="#cb5-1049" aria-hidden="true" tabindex="-1"></a>    La0 &lt;- input$La0</span>
<span id="cb5-1050"><a href="#cb5-1050" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-1051"><a href="#cb5-1051" aria-hidden="true" tabindex="-1"></a>    data &lt;- if (is<span class="fu">.null</span><span class="in">(</span>uploaded_data<span class="in">())</span>) {</span>
<span id="cb5-1052"><a href="#cb5-1052" aria-hidden="true" tabindex="-1"></a>      data<span class="fu">.frame</span><span class="in">(</span>t_min = t_min<span class="op">,</span> BLC_t = BLC_t<span class="in">)</span></span>
<span id="cb5-1053"><a href="#cb5-1053" aria-hidden="true" tabindex="-1"></a>    } else {</span>
<span id="cb5-1054"><a href="#cb5-1054" aria-hidden="true" tabindex="-1"></a>      uploaded_data()</span>
<span id="cb5-1055"><a href="#cb5-1055" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-1056"><a href="#cb5-1056" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-1057"><a href="#cb5-1057" aria-hidden="true" tabindex="-1"></a>    max_x &lt;- max(data$t_min) <span class="op">*</span> 1<span class="fu">.66</span></span>
<span id="cb5-1058"><a href="#cb5-1058" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-1059"><a href="#cb5-1059" aria-hidden="true" tabindex="-1"></a>    t_min_modell &lt;- seq<span class="in">(</span>0<span class="op">,</span> max_x<span class="op">,</span> length<span class="fu">.out</span> = 1000<span class="in">)</span></span>
<span id="cb5-1060"><a href="#cb5-1060" aria-hidden="true" tabindex="-1"></a>    BLC_t_modell &lt;- freund_model<span class="in">(</span>t_min_modell<span class="op">,</span> A1<span class="op">,</span> A2<span class="op">,</span> gamma1<span class="op">,</span> gamma2<span class="op">,</span> La0<span class="in">)</span></span>
<span id="cb5-1061"><a href="#cb5-1061" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-1062"><a href="#cb5-1062" aria-hidden="true" tabindex="-1"></a>    max_y &lt;- max<span class="in">(</span>max<span class="in">(</span>BLC_t_modell<span class="in">)</span> <span class="op">*</span> 1<span class="fu">.2</span><span class="op">,</span> max<span class="in">(</span>data$BLC_t<span class="in">)</span> <span class="op">*</span> 1<span class="fu">.2</span><span class="in">)</span></span>
<span id="cb5-1063"><a href="#cb5-1063" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-1064"><a href="#cb5-1064" aria-hidden="true" tabindex="-1"></a>    # Berechne tmax und Lamax</span>
<span id="cb5-1065"><a href="#cb5-1065" aria-hidden="true" tabindex="-1"></a>    results &lt;- calculate_tmax_lamax<span class="in">(</span>A1<span class="op">,</span> A2<span class="op">,</span> gamma1<span class="op">,</span> gamma2<span class="op">,</span> La0<span class="in">)</span></span>
<span id="cb5-1066"><a href="#cb5-1066" aria-hidden="true" tabindex="-1"></a>    tmax &lt;- results$tmax</span>
<span id="cb5-1067"><a href="#cb5-1067" aria-hidden="true" tabindex="-1"></a>    Lamax &lt;- results$Lamax</span>
<span id="cb5-1068"><a href="#cb5-1068" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-1069"><a href="#cb5-1069" aria-hidden="true" tabindex="-1"></a>    # Erstelle Gleichungstext</span>
<span id="cb5-1070"><a href="#cb5-1070" aria-hidden="true" tabindex="-1"></a>    eq_text &lt;- sprintf<span class="in">(</span>"<span class="ex">[</span><span class="ss">La</span><span class="ex">]</span>&lt;sub<span class="op">&gt;</span>b&lt;/sub<span class="op">&gt;</span> <span class="in">(</span>t<span class="in">)</span> = %<span class="fu">.2f</span> <span class="op">+</span> %<span class="fu">.1f</span> <span class="op">*</span> <span class="in">(</span>1 - e&lt;sup<span class="op">&gt;</span>-%<span class="fu">.3f</span><span class="op">*</span>t&lt;/sup<span class="op">&gt;</span><span class="in">)</span> <span class="op">+</span> %<span class="fu">.1f</span> <span class="op">*</span> <span class="in">(</span>1 - e&lt;sup<span class="op">&gt;</span>-%<span class="fu">.3f</span><span class="op">*</span>t&lt;/sup<span class="op">&gt;</span><span class="in">)</span>"<span class="op">,</span> </span>
<span id="cb5-1071"><a href="#cb5-1071" aria-hidden="true" tabindex="-1"></a>                       La0<span class="op">,</span> A1<span class="op">,</span> gamma1<span class="op">,</span> A2<span class="op">,</span> gamma2<span class="in">)</span></span>
<span id="cb5-1072"><a href="#cb5-1072" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-1073"><a href="#cb5-1073" aria-hidden="true" tabindex="-1"></a>    # Berechne R²</span>
<span id="cb5-1074"><a href="#cb5-1074" aria-hidden="true" tabindex="-1"></a>    BLC_t_modell_at_data &lt;- freund_model<span class="in">(</span>data$t_min<span class="op">,</span> A1<span class="op">,</span> A2<span class="op">,</span> gamma1<span class="op">,</span> gamma2<span class="op">,</span> La0<span class="in">)</span></span>
<span id="cb5-1075"><a href="#cb5-1075" aria-hidden="true" tabindex="-1"></a>    ss_res &lt;- sum<span class="in">((</span>data$BLC_t - BLC_t_modell_at_data<span class="in">)</span>^2<span class="in">)</span></span>
<span id="cb5-1076"><a href="#cb5-1076" aria-hidden="true" tabindex="-1"></a>    ss_tot &lt;- sum<span class="in">((</span>data$BLC_t - mean<span class="in">(</span>data$BLC_t<span class="in">))</span>^2<span class="in">)</span></span>
<span id="cb5-1077"><a href="#cb5-1077" aria-hidden="true" tabindex="-1"></a>    r_squared &lt;- 1 - <span class="in">(</span>ss_res / ss_tot<span class="in">)</span></span>
<span id="cb5-1078"><a href="#cb5-1078" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-1079"><a href="#cb5-1079" aria-hidden="true" tabindex="-1"></a>    # Plotly-Plot</span>
<span id="cb5-1080"><a href="#cb5-1080" aria-hidden="true" tabindex="-1"></a>    p &lt;- plot_ly<span class="in">()</span> %<span class="op">&gt;</span>%</span>
<span id="cb5-1081"><a href="#cb5-1081" aria-hidden="true" tabindex="-1"></a>      add_trace<span class="in">(</span>x = t_min_modell<span class="op">,</span> y = BLC_t_modell<span class="op">,</span> type = 'scatter'<span class="op">,</span> mode = 'lines'<span class="op">,</span> </span>
<span id="cb5-1082"><a href="#cb5-1082" aria-hidden="true" tabindex="-1"></a>                name = 'Modellgleichung'<span class="op">,</span> line = list<span class="in">(</span>color = '<span class="pp">#EF5350</span>'<span class="in">))</span> %<span class="op">&gt;</span>%</span>
<span id="cb5-1083"><a href="#cb5-1083" aria-hidden="true" tabindex="-1"></a>      add_trace<span class="in">(</span>x = data$t_min<span class="op">,</span> y = data$BLC_t<span class="op">,</span> type = 'scatter'<span class="op">,</span> mode = 'markers'<span class="op">,</span> </span>
<span id="cb5-1084"><a href="#cb5-1084" aria-hidden="true" tabindex="-1"></a>                name = 'Gemessene BLC-Werte'<span class="op">,</span> marker = list<span class="in">(</span>color = "<span class="pp">#42BA97</span>"<span class="op">,</span> size = 9<span class="op">,</span> symbol = 'x'<span class="in">))</span> %<span class="op">&gt;</span>%</span>
<span id="cb5-1085"><a href="#cb5-1085" aria-hidden="true" tabindex="-1"></a>      add_segments<span class="in">(</span>x = tmax<span class="op">,</span> xend = tmax<span class="op">,</span> y = 0<span class="op">,</span> yend = max_y<span class="op">,</span> </span>
<span id="cb5-1086"><a href="#cb5-1086" aria-hidden="true" tabindex="-1"></a>                   line = list<span class="in">(</span>color = 'darkgrey'<span class="op">,</span> width = 1<span class="op">,</span> dash = 'dash'<span class="in">)</span><span class="op">,</span> </span>
<span id="cb5-1087"><a href="#cb5-1087" aria-hidden="true" tabindex="-1"></a>                   showlegend = FALSE<span class="op">,</span> opacity = 0<span class="fu">.5</span><span class="in">)</span> %<span class="op">&gt;</span>%</span>
<span id="cb5-1088"><a href="#cb5-1088" aria-hidden="true" tabindex="-1"></a>      add_segments<span class="in">(</span>x = 0<span class="op">,</span> xend = max_x<span class="op">,</span> y = Lamax<span class="op">,</span> yend = Lamax<span class="op">,</span> </span>
<span id="cb5-1089"><a href="#cb5-1089" aria-hidden="true" tabindex="-1"></a>                   line = list<span class="in">(</span>color = 'darkgrey'<span class="op">,</span> width = 1<span class="op">,</span> dash = 'dash'<span class="in">)</span><span class="op">,</span> </span>
<span id="cb5-1090"><a href="#cb5-1090" aria-hidden="true" tabindex="-1"></a>                   showlegend = FALSE<span class="op">,</span> opacity = 0<span class="fu">.5</span><span class="in">)</span> %<span class="op">&gt;</span>%</span>
<span id="cb5-1091"><a href="#cb5-1091" aria-hidden="true" tabindex="-1"></a>      layout<span class="in">(</span></span>
<span id="cb5-1092"><a href="#cb5-1092" aria-hidden="true" tabindex="-1"></a>        title = "Freund et al. Kompartmentmodell für Laktat-Modellierung"<span class="op">,</span></span>
<span id="cb5-1093"><a href="#cb5-1093" aria-hidden="true" tabindex="-1"></a>        margin = list<span class="in">(</span>t = 40<span class="in">)</span><span class="op">,</span></span>
<span id="cb5-1094"><a href="#cb5-1094" aria-hidden="true" tabindex="-1"></a>        xaxis = list<span class="in">(</span>title = "Zeit <span class="ex">[</span><span class="ss">min</span><span class="ex">]</span>"<span class="op">,</span> range = c<span class="in">(</span>0<span class="op">,</span> max_x<span class="in">))</span><span class="op">,</span></span>
<span id="cb5-1095"><a href="#cb5-1095" aria-hidden="true" tabindex="-1"></a>        yaxis = list<span class="in">(</span>title = "Laktat <span class="ex">[</span><span class="ss">mmol/l</span><span class="ex">]</span>"<span class="op">,</span> range = c<span class="in">(</span>0<span class="op">,</span> max_y<span class="in">))</span><span class="op">,</span></span>
<span id="cb5-1096"><a href="#cb5-1096" aria-hidden="true" tabindex="-1"></a>        legend = list<span class="in">(</span></span>
<span id="cb5-1097"><a href="#cb5-1097" aria-hidden="true" tabindex="-1"></a>          x = 0<span class="fu">.01</span><span class="op">,</span></span>
<span id="cb5-1098"><a href="#cb5-1098" aria-hidden="true" tabindex="-1"></a>          y = 0<span class="fu">.99</span><span class="op">,</span></span>
<span id="cb5-1099"><a href="#cb5-1099" aria-hidden="true" tabindex="-1"></a>          xanchor = "left"<span class="op">,</span></span>
<span id="cb5-1100"><a href="#cb5-1100" aria-hidden="true" tabindex="-1"></a>          yanchor = "top"<span class="op">,</span></span>
<span id="cb5-1101"><a href="#cb5-1101" aria-hidden="true" tabindex="-1"></a>          bgcolor = "rgba<span class="in">(</span>255<span class="op">,</span> 255<span class="op">,</span> 255<span class="op">,</span> 0<span class="fu">.8</span><span class="in">)</span>"<span class="op">,</span></span>
<span id="cb5-1102"><a href="#cb5-1102" aria-hidden="true" tabindex="-1"></a>          bordercolor = "rgba<span class="in">(</span>0<span class="op">,</span>0<span class="op">,</span>0<span class="op">,</span>0<span class="in">)</span>"<span class="op">,</span></span>
<span id="cb5-1103"><a href="#cb5-1103" aria-hidden="true" tabindex="-1"></a>          borderwidth = 0</span>
<span id="cb5-1104"><a href="#cb5-1104" aria-hidden="true" tabindex="-1"></a>        <span class="in">)</span><span class="op">,</span></span>
<span id="cb5-1105"><a href="#cb5-1105" aria-hidden="true" tabindex="-1"></a>        annotations = list<span class="in">(</span></span>
<span id="cb5-1106"><a href="#cb5-1106" aria-hidden="true" tabindex="-1"></a>          list<span class="in">(</span></span>
<span id="cb5-1107"><a href="#cb5-1107" aria-hidden="true" tabindex="-1"></a>            x = max_x <span class="op">*</span> 0<span class="fu">.45</span><span class="op">,</span> </span>
<span id="cb5-1108"><a href="#cb5-1108" aria-hidden="true" tabindex="-1"></a>            y = max_y <span class="op">*</span> 0<span class="fu">.92</span><span class="op">,</span></span>
<span id="cb5-1109"><a href="#cb5-1109" aria-hidden="true" tabindex="-1"></a>            text = eq_text<span class="op">,</span></span>
<span id="cb5-1110"><a href="#cb5-1110" aria-hidden="true" tabindex="-1"></a>            showarrow = FALSE<span class="op">,</span></span>
<span id="cb5-1111"><a href="#cb5-1111" aria-hidden="true" tabindex="-1"></a>            xanchor = 'left'<span class="op">,</span></span>
<span id="cb5-1112"><a href="#cb5-1112" aria-hidden="true" tabindex="-1"></a>            yanchor = 'bottom'<span class="op">,</span></span>
<span id="cb5-1113"><a href="#cb5-1113" aria-hidden="true" tabindex="-1"></a>            font = list<span class="in">(</span></span>
<span id="cb5-1114"><a href="#cb5-1114" aria-hidden="true" tabindex="-1"></a>              size = 12<span class="op">,</span></span>
<span id="cb5-1115"><a href="#cb5-1115" aria-hidden="true" tabindex="-1"></a>              color = "black"</span>
<span id="cb5-1116"><a href="#cb5-1116" aria-hidden="true" tabindex="-1"></a>            <span class="in">)</span></span>
<span id="cb5-1117"><a href="#cb5-1117" aria-hidden="true" tabindex="-1"></a>          <span class="in">)</span><span class="op">,</span></span>
<span id="cb5-1118"><a href="#cb5-1118" aria-hidden="true" tabindex="-1"></a>          list<span class="in">(</span></span>
<span id="cb5-1119"><a href="#cb5-1119" aria-hidden="true" tabindex="-1"></a>            x = max_x <span class="op">*</span> 0<span class="fu">.45</span><span class="op">,</span></span>
<span id="cb5-1120"><a href="#cb5-1120" aria-hidden="true" tabindex="-1"></a>            y = max_y <span class="op">*</span> 0<span class="fu">.87</span><span class="op">,</span></span>
<span id="cb5-1121"><a href="#cb5-1121" aria-hidden="true" tabindex="-1"></a>            text = sprintf<span class="in">(</span>"R²<span class="in">:</span> %<span class="fu">.4f</span>"<span class="op">,</span> r_squared<span class="in">)</span><span class="op">,</span></span>
<span id="cb5-1122"><a href="#cb5-1122" aria-hidden="true" tabindex="-1"></a>            showarrow = FALSE<span class="op">,</span></span>
<span id="cb5-1123"><a href="#cb5-1123" aria-hidden="true" tabindex="-1"></a>            xanchor = 'left'<span class="op">,</span></span>
<span id="cb5-1124"><a href="#cb5-1124" aria-hidden="true" tabindex="-1"></a>            yanchor = 'bottom'<span class="op">,</span></span>
<span id="cb5-1125"><a href="#cb5-1125" aria-hidden="true" tabindex="-1"></a>            font = list<span class="in">(</span></span>
<span id="cb5-1126"><a href="#cb5-1126" aria-hidden="true" tabindex="-1"></a>              size = 12<span class="op">,</span></span>
<span id="cb5-1127"><a href="#cb5-1127" aria-hidden="true" tabindex="-1"></a>              color = "black"</span>
<span id="cb5-1128"><a href="#cb5-1128" aria-hidden="true" tabindex="-1"></a>            <span class="in">)</span></span>
<span id="cb5-1129"><a href="#cb5-1129" aria-hidden="true" tabindex="-1"></a>          <span class="in">)</span><span class="op">,</span></span>
<span id="cb5-1130"><a href="#cb5-1130" aria-hidden="true" tabindex="-1"></a>          list<span class="in">(</span></span>
<span id="cb5-1131"><a href="#cb5-1131" aria-hidden="true" tabindex="-1"></a>            x = max_x <span class="op">*</span> 0<span class="fu">.45</span><span class="op">,</span></span>
<span id="cb5-1132"><a href="#cb5-1132" aria-hidden="true" tabindex="-1"></a>            y = max_y <span class="op">*</span> 0<span class="fu">.82</span><span class="op">,</span></span>
<span id="cb5-1133"><a href="#cb5-1133" aria-hidden="true" tabindex="-1"></a>            text = sprintf<span class="in">(</span>"BLC&lt;sub<span class="op">&gt;</span>max&lt;/sub<span class="op">&gt;</span><span class="in">:</span> %<span class="fu">.2f</span> mmol/l"<span class="op">,</span> Lamax<span class="in">)</span><span class="op">,</span></span>
<span id="cb5-1134"><a href="#cb5-1134" aria-hidden="true" tabindex="-1"></a>            showarrow = FALSE<span class="op">,</span></span>
<span id="cb5-1135"><a href="#cb5-1135" aria-hidden="true" tabindex="-1"></a>            xanchor = 'left'<span class="op">,</span></span>
<span id="cb5-1136"><a href="#cb5-1136" aria-hidden="true" tabindex="-1"></a>            yanchor = 'bottom'<span class="op">,</span></span>
<span id="cb5-1137"><a href="#cb5-1137" aria-hidden="true" tabindex="-1"></a>            font = list<span class="in">(</span></span>
<span id="cb5-1138"><a href="#cb5-1138" aria-hidden="true" tabindex="-1"></a>              size = 12<span class="op">,</span></span>
<span id="cb5-1139"><a href="#cb5-1139" aria-hidden="true" tabindex="-1"></a>              color = "black"</span>
<span id="cb5-1140"><a href="#cb5-1140" aria-hidden="true" tabindex="-1"></a>            <span class="in">)</span></span>
<span id="cb5-1141"><a href="#cb5-1141" aria-hidden="true" tabindex="-1"></a>          <span class="in">)</span><span class="op">,</span></span>
<span id="cb5-1142"><a href="#cb5-1142" aria-hidden="true" tabindex="-1"></a>          list<span class="in">(</span></span>
<span id="cb5-1143"><a href="#cb5-1143" aria-hidden="true" tabindex="-1"></a>            x = max_x <span class="op">*</span> 0<span class="fu">.45</span><span class="op">,</span></span>
<span id="cb5-1144"><a href="#cb5-1144" aria-hidden="true" tabindex="-1"></a>            y = max_y <span class="op">*</span> 0<span class="fu">.77</span><span class="op">,</span></span>
<span id="cb5-1145"><a href="#cb5-1145" aria-hidden="true" tabindex="-1"></a>            text = sprintf<span class="in">(</span>"TBLC&lt;sub<span class="op">&gt;</span>max&lt;/sub<span class="op">&gt;</span><span class="in">:</span> %<span class="fu">.2f</span> min"<span class="op">,</span>tmax<span class="in">)</span><span class="op">,</span></span>
<span id="cb5-1146"><a href="#cb5-1146" aria-hidden="true" tabindex="-1"></a>            showarrow = FALSE<span class="op">,</span></span>
<span id="cb5-1147"><a href="#cb5-1147" aria-hidden="true" tabindex="-1"></a>            xanchor = 'left'<span class="op">,</span></span>
<span id="cb5-1148"><a href="#cb5-1148" aria-hidden="true" tabindex="-1"></a>            yanchor = 'bottom'<span class="op">,</span></span>
<span id="cb5-1149"><a href="#cb5-1149" aria-hidden="true" tabindex="-1"></a>            font = list<span class="in">(</span></span>
<span id="cb5-1150"><a href="#cb5-1150" aria-hidden="true" tabindex="-1"></a>              size = 12<span class="op">,</span></span>
<span id="cb5-1151"><a href="#cb5-1151" aria-hidden="true" tabindex="-1"></a>              color = "black"</span>
<span id="cb5-1152"><a href="#cb5-1152" aria-hidden="true" tabindex="-1"></a>            <span class="in">)</span></span>
<span id="cb5-1153"><a href="#cb5-1153" aria-hidden="true" tabindex="-1"></a>          <span class="in">)</span></span>
<span id="cb5-1154"><a href="#cb5-1154" aria-hidden="true" tabindex="-1"></a>        <span class="in">)</span></span>
<span id="cb5-1155"><a href="#cb5-1155" aria-hidden="true" tabindex="-1"></a>      <span class="in">)</span></span>
<span id="cb5-1156"><a href="#cb5-1156" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-1157"><a href="#cb5-1157" aria-hidden="true" tabindex="-1"></a>    p</span>
<span id="cb5-1158"><a href="#cb5-1158" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb5-1159"><a href="#cb5-1159" aria-hidden="true" tabindex="-1"></a>  output$instructions &lt;- renderUI<span class="in">(</span><span class="er">{</span></span>
<span id="cb5-1160"><a href="#cb5-1160" aria-hidden="true" tabindex="-1"></a>    HTML(</span>
<span id="cb5-1161"><a href="#cb5-1161" aria-hidden="true" tabindex="-1"></a>      "&lt;div style='margin-top<span class="ch">:</span> <span class="dv">20</span><span class="dt">px</span><span class="op">;</span> <span class="kw">padding</span><span class="ch">:</span> <span class="dv">10</span><span class="dt">px</span><span class="op">;</span> <span class="kw">background-color</span><span class="ch">:</span> <span class="cn">#f0f0f0</span><span class="op">;</span> <span class="kw">border</span><span class="ch">:</span> <span class="dv">1</span><span class="dt">px</span> <span class="dv">solid</span> <span class="cn">#ddd</span><span class="op">;</span> <span class="kw">border-radius</span><span class="ch">:</span> <span class="dv">5</span><span class="dt">px</span><span class="op">;</span> <span class="kw">width</span><span class="ch">:</span> <span class="dv">fit-content</span><span class="op">;</span>'<span class="op">&gt;</span></span>
<span id="cb5-1162"><a href="#cb5-1162" aria-hidden="true" tabindex="-1"></a>        &lt;h4 style='color<span class="in">:</span> <span class="pp">#333</span>;'<span class="op">&gt;</span>&lt;strong<span class="op">&gt;</span>Anleitung - Modellanpassung<span class="in">:</span>&lt;/strong<span class="op">&gt;</span>&lt;/h4<span class="op">&gt;</span></span>
<span id="cb5-1163"><a href="#cb5-1163" aria-hidden="true" tabindex="-1"></a>        &lt;ol style='color<span class="in">:</span> <span class="pp">#555</span>; list-style-position<span class="in">:</span> outside; padding-left<span class="in">:</span> 20px;'<span class="op">&gt;</span></span>
<span id="cb5-1164"><a href="#cb5-1164" aria-hidden="true" tabindex="-1"></a>          &lt;li<span class="op">&gt;</span>Beispiel-Laktatdaten verwenden oder eigene Laktat-Daten als CSV-Datei einfügen.&lt;/li<span class="op">&gt;</span></span>
<span id="cb5-1165"><a href="#cb5-1165" aria-hidden="true" tabindex="-1"></a>          &lt;li<span class="op">&gt;</span>Modellanpassung 'Fit<span class="in">:</span> nlsLM' durchführen.&lt;/li<span class="op">&gt;</span></span>
<span id="cb5-1166"><a href="#cb5-1166" aria-hidden="true" tabindex="-1"></a>          &lt;li<span class="op">&gt;</span>Alternativ<span class="in">:</span> Manuelle Modellanpassung der Modellparameter mit den Schiebereglern.&lt;/li<span class="op">&gt;</span></span>
<span id="cb5-1167"><a href="#cb5-1167" aria-hidden="true" tabindex="-1"></a>        &lt;/ol<span class="op">&gt;</span></span>
<span id="cb5-1168"><a href="#cb5-1168" aria-hidden="true" tabindex="-1"></a>        &lt;div style='margin-top<span class="in">:</span> 20px;'<span class="op">&gt;</span>&lt;/div<span class="op">&gt;</span></span>
<span id="cb5-1169"><a href="#cb5-1169" aria-hidden="true" tabindex="-1"></a>        &lt;pre style='background-color<span class="in">:</span> <span class="pp">#f8f8f8</span>; padding<span class="in">:</span> 10px; border<span class="in">:</span> 1px solid <span class="pp">#ddd</span>; border-radius<span class="in">:</span> 5px; width<span class="in">:</span> fit-content;'<span class="op">&gt;</span></span>
<span id="cb5-1170"><a href="#cb5-1170" aria-hidden="true" tabindex="-1"></a>Laktat-Daten können als CSV-Datei im folgenden Format hochgeladen werden<span class="in">:</span></span>
<span id="cb5-1171"><a href="#cb5-1171" aria-hidden="true" tabindex="-1"></a>t_min<span class="op">,</span>BLC_t</span>
<span id="cb5-1172"><a href="#cb5-1172" aria-hidden="true" tabindex="-1"></a>0<span class="fu">.0</span><span class="op">,</span>2<span class="fu">.84</span></span>
<span id="cb5-1173"><a href="#cb5-1173" aria-hidden="true" tabindex="-1"></a>1<span class="fu">.5</span><span class="op">,</span>3<span class="fu">.60</span></span>
<span id="cb5-1174"><a href="#cb5-1174" aria-hidden="true" tabindex="-1"></a>3<span class="fu">.0</span><span class="op">,</span>5<span class="fu">.09</span></span>
<span id="cb5-1175"><a href="#cb5-1175" aria-hidden="true" tabindex="-1"></a>…</span>
<span id="cb5-1176"><a href="#cb5-1176" aria-hidden="true" tabindex="-1"></a>        &lt;/pre<span class="op">&gt;</span></span>
<span id="cb5-1177"><a href="#cb5-1177" aria-hidden="true" tabindex="-1"></a>      &lt;/div<span class="op">&gt;</span>"</span>
<span id="cb5-1178"><a href="#cb5-1178" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-1179"><a href="#cb5-1179" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb5-1180"><a href="#cb5-1180" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-1181"><a href="#cb5-1181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1182"><a href="#cb5-1182" aria-hidden="true" tabindex="-1"></a># App ausführen</span>
<span id="cb5-1183"><a href="#cb5-1183" aria-hidden="true" tabindex="-1"></a>shinyApp<span class="in">(</span>ui = ui<span class="op">,</span> server = server<span class="in">)</span></span>
<span id="cb5-1184"><a href="#cb5-1184" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb5-1185"><a href="#cb5-1185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1186"><a href="#cb5-1186" aria-hidden="true" tabindex="-1"></a><span class="in">:::</span> {<span class="fu">.callout-note</span> icon=false collapse=true appearance="simple"}</span>
<span id="cb5-1187"><a href="#cb5-1187" aria-hidden="true" tabindex="-1"></a>#### Modellanpassung - Details<span class="in">:</span> {<span class="fu">.unlisted</span>}</span>
<span id="cb5-1188"><a href="#cb5-1188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1189"><a href="#cb5-1189" aria-hidden="true" tabindex="-1"></a><span class="op">**</span>nlsLM - Fit<span class="in">:</span><span class="op">**</span></span>
<span id="cb5-1190"><a href="#cb5-1190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1191"><a href="#cb5-1191" aria-hidden="true" tabindex="-1"></a>- Verwendete Funktion<span class="in">:</span> nlsLM</span>
<span id="cb5-1192"><a href="#cb5-1192" aria-hidden="true" tabindex="-1"></a>- Parameter<span class="in">:</span> A1<span class="op">,</span> A2<span class="op">,</span> gamma1<span class="op">,</span> gamma2<span class="op">,</span> La0</span>
<span id="cb5-1193"><a href="#cb5-1193" aria-hidden="true" tabindex="-1"></a>- Modell<span class="in">:</span> BLC_t <span class="op">~</span> La0 <span class="op">+</span> A1 · <span class="in">(</span>1 - exp<span class="in">(</span>-gamma1 · t_min<span class="in">))</span> <span class="op">+</span> A2 · <span class="in">(</span>1 - exp<span class="in">(</span>-gamma2 · t_min<span class="in">))</span></span>
<span id="cb5-1194"><a href="#cb5-1194" aria-hidden="true" tabindex="-1"></a>- Grenzen<span class="in">:</span></span>
<span id="cb5-1195"><a href="#cb5-1195" aria-hidden="true" tabindex="-1"></a>  - A1<span class="in">:</span> <span class="op">*</span>0<span class="fu">.0</span> bis 100<span class="fu">.0</span> mmol/l<span class="op">*</span></span>
<span id="cb5-1196"><a href="#cb5-1196" aria-hidden="true" tabindex="-1"></a>  - A2<span class="in">:</span> <span class="op">*</span>-100<span class="fu">.0</span> bis 0<span class="fu">.0</span> mmol/l<span class="op">*</span></span>
<span id="cb5-1197"><a href="#cb5-1197" aria-hidden="true" tabindex="-1"></a>  - gamma1<span class="in">:</span> <span class="op">*</span>0<span class="fu">.05</span> bis 2<span class="fu">.0</span> min^-1<span class="op">*</span></span>
<span id="cb5-1198"><a href="#cb5-1198" aria-hidden="true" tabindex="-1"></a>  - gamma2<span class="in">:</span> <span class="op">*</span>0<span class="fu">.01</span> bis 0<span class="fu">.5</span> min^-1<span class="op">*</span></span>
<span id="cb5-1199"><a href="#cb5-1199" aria-hidden="true" tabindex="-1"></a>  - La0<span class="in">:</span> <span class="op">*</span>0<span class="fu">.90</span> · BLC_t<span class="ex">[</span><span class="ss">1</span><span class="ex">]</span> bis 1<span class="fu">.10</span> · BLC_t<span class="ex">[</span><span class="ss">1</span><span class="ex">]</span><span class="op">,</span> begrenzt auf 0 bis 5 mmol/l<span class="op">*</span></span>
<span id="cb5-1200"><a href="#cb5-1200" aria-hidden="true" tabindex="-1"></a>- Prozess<span class="in">:</span></span>
<span id="cb5-1201"><a href="#cb5-1201" aria-hidden="true" tabindex="-1"></a>  a) Bestimmung der La0-Grenzen<span class="in">:</span></span>
<span id="cb5-1202"><a href="#cb5-1202" aria-hidden="true" tabindex="-1"></a>     - Untere Grenze<span class="in">:</span> <span class="op">*</span>max<span class="in">(</span>0<span class="op">,</span> 0<span class="fu">.90</span> · erster BLC-Wert<span class="in">)</span><span class="op">*</span></span>
<span id="cb5-1203"><a href="#cb5-1203" aria-hidden="true" tabindex="-1"></a>     - Obere Grenze<span class="in">:</span> <span class="op">*</span>min<span class="in">(</span>5<span class="op">,</span> 1<span class="fu">.10</span> · erster BLC-Wert<span class="in">)</span><span class="op">*</span></span>
<span id="cb5-1204"><a href="#cb5-1204" aria-hidden="true" tabindex="-1"></a>  b) Iterative Optimierung <span class="in">(</span>100 Durchläufe<span class="in">):</span></span>
<span id="cb5-1205"><a href="#cb5-1205" aria-hidden="true" tabindex="-1"></a>     - Zufällige Startwertebestimmung für jeden Durchlauf<span class="in">:</span></span>
<span id="cb5-1206"><a href="#cb5-1206" aria-hidden="true" tabindex="-1"></a>       · A1<span class="in">:</span> Zufallswert zwischen 0 und 100</span>
<span id="cb5-1207"><a href="#cb5-1207" aria-hidden="true" tabindex="-1"></a>       · A2<span class="in">:</span> Zufallswert zwischen -100 und 0</span>
<span id="cb5-1208"><a href="#cb5-1208" aria-hidden="true" tabindex="-1"></a>       · gamma1<span class="in">:</span> Zufallswert zwischen 0<span class="fu">.05</span> und 2<span class="fu">.0</span></span>
<span id="cb5-1209"><a href="#cb5-1209" aria-hidden="true" tabindex="-1"></a>       · gamma2<span class="in">:</span> Zufallswert zwischen 0<span class="fu">.01</span> und 0<span class="fu">.5</span></span>
<span id="cb5-1210"><a href="#cb5-1210" aria-hidden="true" tabindex="-1"></a>       · La0<span class="in">:</span> Zufallswert zwischen der unteren und oberen La0-Grenze</span>
<span id="cb5-1211"><a href="#cb5-1211" aria-hidden="true" tabindex="-1"></a>     - Durchführung der nicht-linearen Regression<span class="in">:</span></span>
<span id="cb5-1212"><a href="#cb5-1212" aria-hidden="true" tabindex="-1"></a>       · Verwendung des Levenberg-Marquardt-Algorithmus</span>
<span id="cb5-1213"><a href="#cb5-1213" aria-hidden="true" tabindex="-1"></a>       · Maximale Iterationen<span class="in">:</span> <span class="op">*</span>1024<span class="op">*</span></span>
<span id="cb5-1214"><a href="#cb5-1214" aria-hidden="true" tabindex="-1"></a>     - Berechnung der Residuenquadratsumme <span class="in">(</span>RSS<span class="in">)</span> für jede Anpassung</span>
<span id="cb5-1215"><a href="#cb5-1215" aria-hidden="true" tabindex="-1"></a>     - Speicherung der besten Anpassung <span class="in">(</span>niedrigste RSS<span class="in">)</span></span>
<span id="cb5-1216"><a href="#cb5-1216" aria-hidden="true" tabindex="-1"></a>- Optimierung<span class="in">:</span> Minimierung der Residuenquadratsumme <span class="in">(</span>RSS<span class="in">)</span></span>
<span id="cb5-1217"><a href="#cb5-1217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1218"><a href="#cb5-1218" aria-hidden="true" tabindex="-1"></a><span class="in">:::</span></span>
<span id="cb5-1219"><a href="#cb5-1219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1220"><a href="#cb5-1220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1221"><a href="#cb5-1221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1222"><a href="#cb5-1222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1223"><a href="#cb5-1223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1224"><a href="#cb5-1224" aria-hidden="true" tabindex="-1"></a>## Quellenverzeichnis</span>
<span id="cb5-1225"><a href="#cb5-1225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1226"><a href="#cb5-1226" aria-hidden="true" tabindex="-1"></a><span class="in">:::</span> {<span class="pp">#refs</span>}</span>
<span id="cb5-1227"><a href="#cb5-1227" aria-hidden="true" tabindex="-1"></a><span class="in">:::</span></span>
</code><button title="In die Zwischenablage kopieren" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Johannes Will, 2024</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p><a href="https://quarto.org/">Quarto</a></p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>